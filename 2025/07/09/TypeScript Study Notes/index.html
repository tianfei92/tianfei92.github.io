<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#000" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#000">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"tianfei92.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":false,"codeblock":{"theme":{"light":"atom-one-dark","dark":"atom-one-dark"},"prism":{"light":"prism-okaidia","dark":"prism-okaidia"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false,"highlight_theme":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="ä¸€ã€TypeScript åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ1.1 ç±»å‹ç³»ç»Ÿæ·±å…¥1.1.1 åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶åŸºæœ¬ç±»å‹ï¼ˆPrimitive Typesï¼‰    ç±»å‹ æè¿° ç¤ºä¾‹    string å­—ç¬¦ä¸²ç±»å‹ let name: string &#x3D; â€œAliceâ€   number æ•°å€¼ç±»å‹ï¼ˆå«æ•´æ•°&#x2F;æµ®ç‚¹æ•°ï¼‰ let age: number &#x3D; 30   boolean å¸ƒå°”ç±»å‹ le">
<meta property="og:type" content="article">
<meta property="og:title" content="ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šTypeScript">
<meta property="og:url" content="https://tianfei92.github.io/2025/07/09/TypeScript%20Study%20Notes/index.html">
<meta property="og:site_name" content="Ariel&#39;s Blog">
<meta property="og:description" content="ä¸€ã€TypeScript åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ1.1 ç±»å‹ç³»ç»Ÿæ·±å…¥1.1.1 åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶åŸºæœ¬ç±»å‹ï¼ˆPrimitive Typesï¼‰    ç±»å‹ æè¿° ç¤ºä¾‹    string å­—ç¬¦ä¸²ç±»å‹ let name: string &#x3D; â€œAliceâ€   number æ•°å€¼ç±»å‹ï¼ˆå«æ•´æ•°&#x2F;æµ®ç‚¹æ•°ï¼‰ let age: number &#x3D; 30   boolean å¸ƒå°”ç±»å‹ le">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-07-09T09:15:51.000Z">
<meta property="article:modified_time" content="2025-07-11T01:39:13.068Z">
<meta property="article:author" content="Ariel">
<meta property="article:tag" content="TypeScript">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://tianfei92.github.io/2025/07/09/TypeScript%20Study%20Notes/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://tianfei92.github.io/2025/07/09/TypeScript%20Study%20Notes/","path":"2025/07/09/TypeScript Study Notes/","title":"ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šTypeScript"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šTypeScript | Ariel's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.7.0/mermaid.min.js","integrity":"sha256-4+IKDqhZ/sXjc8Wtl2/MsxI4e0s1KpEVdbEP7V/Lz8U="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Ariel's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">æˆ‘æœ¬åœ°æ²¡é—®é¢˜å•Š</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="æœç´¢..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81TypeScript-%E5%9F%BA%E7%A1%80%E4%B8%8E%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="nav-text">ä¸€ã€TypeScript åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E6%B7%B1%E5%85%A5"><span class="nav-text">1.1 ç±»å‹ç³»ç»Ÿæ·±å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD%E6%9C%BA%E5%88%B6"><span class="nav-text">1.1.1 åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B%E4%B8%8E%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B%E5%AE%9E%E6%88%98"><span class="nav-text">1.1.2 å­—é¢é‡ç±»å‹ä¸è”åˆç±»å‹å®æˆ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-any-unknown-never-%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">1.1.3 any&#x2F;unknown&#x2F;never çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-4-%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80%E4%B8%8E%E7%B1%BB%E5%9E%8B%E5%AE%88%E5%8D%AB%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="nav-text">1.1.4 ç±»å‹æ–­è¨€ä¸ç±»å‹å®ˆå«å®ç°åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-5-%E7%BB%93%E6%9E%84%E5%8C%96%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E4%B8%8E%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B"><span class="nav-text">1.1.5 ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸é¸­å­ç±»å‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E6%8E%A5%E5%8F%A3%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="nav-text">1.2 æ¥å£ä¸é¢å‘å¯¹è±¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-%E6%8E%A5%E5%8F%A3%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%EF%BC%88%E5%8F%AF%E9%80%89%E5%B1%9E%E6%80%A7%E3%80%81%E5%8F%AA%E8%AF%BB%E5%B1%9E%E6%80%A7%E3%80%81%E7%B4%A2%E5%BC%95%E7%AD%BE%E5%90%8D%EF%BC%89"><span class="nav-text">1.2.1 æ¥å£é«˜çº§ç‰¹æ€§ï¼ˆå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-%E7%B1%BB%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB%E4%B8%8E%E8%AE%BF%E9%97%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="nav-text">1.2.2 ç±»ç»§æ‰¿ä½“ç³»ä¸è®¿é—®ä¿®é¥°ç¬¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E4%B8%8E%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E8%A7%84%E8%8C%83"><span class="nav-text">1.2.3 æŠ½è±¡ç±»ä¸æ¥å£å®ç°è§„èŒƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-4-%E7%B1%BB%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E4%B8%8E%E6%9E%84%E9%80%A0%E7%AD%BE%E5%90%8D"><span class="nav-text">1.2.4 ç±»é™æ€æˆå‘˜ä¸æ„é€ ç­¾å</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E5%87%BD%E6%95%B0%E4%B8%8E%E6%B3%9B%E5%9E%8B%E7%BC%96%E7%A8%8B"><span class="nav-text">1.3 å‡½æ•°ä¸æ³›å‹ç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E5%87%BD%E6%95%B0%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%B8%8A%E4%B8%8B%E6%96%87%E6%8E%A8%E6%96%AD"><span class="nav-text">1.3.1 å‡½æ•°ç±»å‹å®šä¹‰ä¸ä¸Šä¸‹æ–‡æ¨æ–­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5"><span class="nav-text">1.3.2 å‡½æ•°é‡è½½çš„å·¥ç¨‹å®è·µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-3-%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F%E4%B8%8E%E9%BB%98%E8%AE%A4%E7%B1%BB%E5%9E%8B"><span class="nav-text">1.3.3 æ³›å‹çº¦æŸä¸é»˜è®¤ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-4-%E6%B3%9B%E5%9E%8B%E5%9C%A8%E6%8E%A5%E5%8F%A3-%E7%B1%BB%E4%B8%AD%E7%9A%84%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8"><span class="nav-text">1.3.4 æ³›å‹åœ¨æ¥å£&#x2F;ç±»ä¸­çš„é«˜çº§åº”ç”¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F"><span class="nav-text">1.4 æ¨¡å—ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-ES-Module-%E4%B8%8E-CommonJS-%E4%BA%92%E6%93%8D%E4%BD%9C"><span class="nav-text">1.4.1 ES Module ä¸ CommonJS äº’æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-2-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E4%B8%8E%E7%8E%B0%E4%BB%A3%E6%A8%A1%E5%9D%97%E5%AF%B9%E6%AF%94"><span class="nav-text">1.4.2 å‘½åç©ºé—´ä¸ç°ä»£æ¨¡å—å¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-3-%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90%E7%AD%96%E7%95%A5%E4%B8%8E%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84"><span class="nav-text">1.4.3 æ¨¡å—è§£æç­–ç•¥ä¸è·¯å¾„æ˜ å°„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-4-%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">1.4.4 åŠ¨æ€å¯¼å…¥ä¸ä»£ç åˆ†å‰²ç±»å‹å®‰å…¨</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%AB%98%E7%BA%A7%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F"><span class="nav-text">äºŒã€é«˜çº§ç±»å‹ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E5%8E%9F%E7%90%86"><span class="nav-text">2.1 å·¥å…·ç±»å‹åŸç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="nav-text">2.1.1 å†…ç½®å·¥å…·ç±»å‹æºç è§£æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-%E7%B1%BB%E5%9E%8B%E6%98%A0%E5%B0%84%E4%BF%AE%E9%A5%B0%E7%AC%A6%EF%BC%88-%EF%BC%89%E5%8E%9F%E7%90%86"><span class="nav-text">2.1.2 ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ï¼ˆ+&#x2F;-ï¼‰åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E5%88%86%E5%B8%83%E5%BC%8F%E7%89%B9%E6%80%A7"><span class="nav-text">2.1.3 æ¡ä»¶ç±»å‹åˆ†å¸ƒå¼ç‰¹æ€§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-4-infer-%E5%85%B3%E9%94%AE%E5%AD%97%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%8F%90%E5%8F%96"><span class="nav-text">2.1.4 infer å…³é”®å­—ä¸ç±»å‹æå–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E5%AE%9E%E6%88%98"><span class="nav-text">2.2 ç±»å‹ä½“æ“å®æˆ˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="nav-text">2.2.1 å‡½æ•°æŸ¯é‡ŒåŒ–ç±»å‹å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-Promise-%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="nav-text">2.2.2 Promise é“¾å¼è°ƒç”¨ç±»å‹æ¨å¯¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-3-Redux-reducer-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E5%AE%9E%E7%8E%B0"><span class="nav-text">2.2.3 Redux reducer ç±»å‹å®‰å…¨å®ç°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-4-%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0%E8%87%AA%E5%8A%A8%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="nav-text">2.2.4 è·¯ç”±å‚æ•°è‡ªåŠ¨ç±»å‹æ¨å¯¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E6%A8%A1%E6%9D%BF%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.3 æ¨¡æ¿å­—é¢é‡ç±»å‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A8%A1%E6%9D%BF%E7%B1%BB%E5%9E%8B%E6%93%8D%E4%BD%9C"><span class="nav-text">2.3.1 å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-Uppercase-Lowercase-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-text">2.3.2 Uppercase&#x2F;Lowercase ç±»å‹è½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-3-%E8%B7%AF%E7%94%B1%E8%B7%AF%E5%BE%84%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D"><span class="nav-text">2.3.3 è·¯ç”±è·¯å¾„æ¨¡å¼åŒ¹é…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-4-%E5%9B%BD%E9%99%85%E5%8C%96%E9%94%AE%E5%90%8D%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8"><span class="nav-text">2.3.4 å›½é™…åŒ–é”®åè‡ªåŠ¨è¡¥å…¨</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E4%BC%98%E5%8C%96"><span class="nav-text">2.4 ç±»å‹ç¼–ç¨‹ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-1-%E7%B1%BB%E5%9E%8B%E9%80%92%E5%BD%92%E4%B8%8E%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96"><span class="nav-text">2.4.1 ç±»å‹é€’å½’ä¸å°¾é€’å½’ä¼˜åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-2-%E7%B1%BB%E5%9E%8B%E5%AE%9E%E4%BE%8B%E5%8C%96%E6%B7%B1%E5%BA%A6%E6%8E%A7%E5%88%B6"><span class="nav-text">2.4.2 ç±»å‹å®ä¾‹åŒ–æ·±åº¦æ§åˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-3-%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E7%9F%AD%E8%B7%AF%E6%8A%80%E5%B7%A7"><span class="nav-text">2.4.3 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-4-%E7%B1%BB%E5%9E%8B%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="nav-text">2.4.4 ç±»å‹æ€§èƒ½åˆ†æå·¥å…·</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%B7%A5%E7%A8%8B%E5%8C%96%E5%AE%9E%E8%B7%B5"><span class="nav-text">ä¸‰ã€å·¥ç¨‹åŒ–å®è·µ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-TSConfig-%E6%B7%B1%E5%BA%A6%E9%85%8D%E7%BD%AE"><span class="nav-text">3.1 TSConfig æ·±åº¦é…ç½®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E5%85%A8%E5%AE%B6%E6%A1%B6%E9%85%8D%E7%BD%AE"><span class="nav-text">3.1.1 ä¸¥æ ¼æ¨¡å¼å…¨å®¶æ¡¶é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90%E7%AD%96%E7%95%A5%E5%AE%9E%E6%88%98"><span class="nav-text">3.1.2 æ¨¡å—è§£æç­–ç•¥å®æˆ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-3-%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE"><span class="nav-text">3.1.3 å£°æ˜æ–‡ä»¶ç”Ÿæˆé…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-4-%E7%BC%96%E8%AF%91%E5%99%A8%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5"><span class="nav-text">3.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6-d-ts"><span class="nav-text">3.2 å£°æ˜æ–‡ä»¶(.d.ts)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E7%B1%BB%E5%9E%8B%E6%89%A9%E5%B1%95%E6%8A%80%E5%B7%A7"><span class="nav-text">3.2.1 ç¬¬ä¸‰æ–¹åº“ç±»å‹æ‰©å±•æŠ€å·§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2-%E6%A8%A1%E5%9D%97%E5%A3%B0%E6%98%8E%E5%90%88%E5%B9%B6%E7%AD%96%E7%95%A5"><span class="nav-text">3.2.2 æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-3-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="nav-text">3.2.3 å…¨å±€å˜é‡ç±»å‹å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-4-%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">3.2.4 å¤æ‚ç±»å‹å£°æ˜æœ€ä½³å®è·µ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E4%BB%A3%E7%A0%81%E8%B4%A8%E9%87%8F%E4%BF%9D%E9%9A%9C"><span class="nav-text">3.3 ä»£ç è´¨é‡ä¿éšœ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1-ESLint-%E7%B1%BB%E5%9E%8B%E8%A7%84%E5%88%99%E9%85%8D%E7%BD%AE"><span class="nav-text">3.3.1 ESLint ç±»å‹è§„åˆ™é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-2-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5%E6%96%B9%E6%A1%88"><span class="nav-text">3.3.2 å•å…ƒæµ‹è¯•ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E8%A7%84%E5%88%99%E5%BC%80%E5%8F%91"><span class="nav-text">3.3.3 è‡ªå®šä¹‰ç±»å‹è§„åˆ™å¼€å‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-4-CI-CD-%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5"><span class="nav-text">3.3.4 CI&#x2F;CD ä¸­çš„ç±»å‹æ£€æŸ¥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="nav-text">3.4 æ„å»ºä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1-Webpack-%E6%9E%84%E5%BB%BA%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE"><span class="nav-text">3.4.1 Webpack æ„å»ºç¼“å­˜é…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2-Babel-%E4%B8%8E-tsc-%E7%BC%96%E8%AF%91%E5%AF%B9%E6%AF%94"><span class="nav-text">3.4.2 Babel ä¸ tsc ç¼–è¯‘å¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3-%E5%A2%9E%E9%87%8F%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E8%B7%B5"><span class="nav-text">3.4.3 å¢é‡ç¼–è¯‘åŸç†ä¸å®è·µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-4-Monorepo-%E7%B1%BB%E5%9E%8B%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5"><span class="nav-text">3.4.4 Monorepo ç±»å‹ç®¡ç†ç­–ç•¥</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90%E5%AE%9E%E8%B7%B5"><span class="nav-text">å››ã€æ¡†æ¶é›†æˆå®è·µ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-React-%E7%94%9F%E6%80%81%E9%9B%86%E6%88%90"><span class="nav-text">4.1 React ç”Ÿæ€é›†æˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-%E7%BB%84%E4%BB%B6-Props-%E9%AB%98%E7%BA%A7%E7%B1%BB%E5%9E%8B%E8%AE%BE%E8%AE%A1"><span class="nav-text">4.1.1 ç»„ä»¶ Props é«˜çº§ç±»å‹è®¾è®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2-Hooks-%E6%B3%9B%E5%9E%8B%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><span class="nav-text">4.1.2 Hooks æ³›å‹ç±»å‹å®šä¹‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-Redux-Toolkit-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">4.1.3 Redux Toolkit ç±»å‹å®‰å…¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4-React-Router-%E7%B1%BB%E5%9E%8B%E5%AE%88%E5%8D%AB"><span class="nav-text">4.1.4 React Router ç±»å‹å®ˆå«</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-Vue-3-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F"><span class="nav-text">4.2 Vue 3 ç±»å‹ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-Composition-API-%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="nav-text">4.2.1 Composition API ç±»å‹æ¨å¯¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-%E7%BB%84%E4%BB%B6%E6%B3%9B%E5%9E%8B-Props-%E5%AE%9E%E7%8E%B0"><span class="nav-text">4.2.2 ç»„ä»¶æ³›å‹ Props å®ç°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-Pinia-%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">4.2.3 Pinia çŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4-Volar-%E7%B1%BB%E5%9E%8B%E5%A2%9E%E5%BC%BA%E5%AE%9E%E8%B7%B5"><span class="nav-text">4.2.4 Volar ç±»å‹å¢å¼ºå®è·µ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-Node-js-%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91"><span class="nav-text">4.3 Node.js åç«¯å¼€å‘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-Express-Koa-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">4.3.1 Express&#x2F;Koa ä¸­é—´ä»¶ç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-ORM-%E6%A1%86%E6%9E%B6%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E6%9F%A5%E8%AF%A2"><span class="nav-text">4.3.2 ORM æ¡†æ¶ç±»å‹å®‰å…¨æŸ¥è¯¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-3-RPC-%E9%80%9A%E4%BF%A1%E7%B1%BB%E5%9E%8B%E5%A5%91%E7%BA%A6"><span class="nav-text">4.3.3 RPC é€šä¿¡ç±»å‹å¥‘çº¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-4-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%B1%BB%E5%9E%8B%E4%BF%9D%E9%9A%9C"><span class="nav-text">4.3.4 åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ä¿éšœ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-text">äº”ã€æ€§èƒ½ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-%E7%BC%96%E8%AF%91%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-text">5.1 ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-1-%E9%A1%B9%E7%9B%AE%E5%BC%95%E7%94%A8-Project-References"><span class="nav-text">5.1.1 é¡¹ç›®å¼•ç”¨(Project References)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-2-%E5%A2%9E%E9%87%8F%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%89%96%E6%9E%90"><span class="nav-text">5.1.2 å¢é‡ç¼–è¯‘åŸç†å‰–æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-3-%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%96%E8%AF%91%E6%96%B9%E6%A1%88"><span class="nav-text">5.1.3 åˆ†å¸ƒå¼ç¼–è¯‘æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-4-%E7%BC%96%E8%AF%91%E5%99%A8%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5"><span class="nav-text">5.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-%E7%B1%BB%E5%9E%8B%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-text">5.2 ç±»å‹æ€§èƒ½ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-1-%E9%81%BF%E5%85%8D%E8%BF%87%E5%BA%A6%E7%B1%BB%E5%9E%8B%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="nav-text">5.2.1 é¿å…è¿‡åº¦ç±»å‹å®ä¾‹åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-2-%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E7%9F%AD%E8%B7%AF%E6%8A%80%E5%B7%A7"><span class="nav-text">5.2.2 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-3-%E7%B1%BB%E5%9E%8B%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5%E5%AE%9E%E7%8E%B0"><span class="nav-text">5.2.3 ç±»å‹ç¼“å­˜ç­–ç•¥å®ç°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-4-%E7%B1%BB%E5%9E%8B%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="nav-text">5.2.4 ç±»å‹å¤æ‚åº¦åˆ†æ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-%E4%BA%A7%E7%89%A9%E4%BC%98%E5%8C%96"><span class="nav-text">5.3 äº§ç‰©ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-1-Tree-Shaking-%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0"><span class="nav-text">5.3.1 Tree Shaking åŸç†ä¸å®ç°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-2-%E4%BB%A3%E7%A0%81%E5%88%86%E5%89%B2%E7%B1%BB%E5%9E%8B%E4%BF%9D%E9%9A%9C"><span class="nav-text">5.3.2 ä»£ç åˆ†å‰²ç±»å‹ä¿éšœ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-3-%E8%BF%90%E8%A1%8C%E6%97%B6%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5%E6%96%B9%E6%A1%88"><span class="nav-text">5.3.3 è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-4-%E7%B1%BB%E5%9E%8B%E6%93%A6%E9%99%A4%E4%B8%8E%E4%BD%93%E7%A7%AF%E6%8E%A7%E5%88%B6"><span class="nav-text">5.3.4 ç±»å‹æ“¦é™¤ä¸ä½“ç§¯æ§åˆ¶</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E7%BB%BC%E5%90%88%E8%83%BD%E5%8A%9B"><span class="nav-text">å…­ã€ç»¼åˆèƒ½åŠ›</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%B1%BB%E5%9E%8B%E5%AE%9E%E7%8E%B0"><span class="nav-text">6.1 è®¾è®¡æ¨¡å¼ç±»å‹å®ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-1-%E8%A3%85%E9%A5%B0%E5%99%A8%E5%85%83%E7%BC%96%E7%A8%8B%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">6.1.1 è£…é¥°å™¨å…ƒç¼–ç¨‹ç±»å‹å®‰å…¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-2-%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC"><span class="nav-text">6.1.2 ä¾èµ–æ³¨å…¥ç±»å‹æ¨å¯¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-3-%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E7%B1%BB%E5%9E%8B%E6%98%A0%E5%B0%84"><span class="nav-text">6.1.3 ç­–ç•¥æ¨¡å¼ç±»å‹æ˜ å°„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-%E7%8A%B6%E6%80%81%E6%9C%BA%E7%B1%BB%E5%9E%8B%E5%AE%9E%E7%8E%B0"><span class="nav-text">6.1.4 çŠ¶æ€æœºç±»å‹å®ç°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-%E8%B0%83%E8%AF%95%E4%B8%8E%E9%87%8D%E6%9E%84"><span class="nav-text">6.2 è°ƒè¯•ä¸é‡æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-1-%E5%A4%8D%E6%9D%82%E7%B1%BB%E5%9E%8B%E9%94%99%E8%AF%AF%E8%BF%BD%E8%B8%AA%E6%8A%80%E5%B7%A7"><span class="nav-text">6.2.1 å¤æ‚ç±»å‹é”™è¯¯è¿½è¸ªæŠ€å·§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-2-%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95%E8%AE%BA"><span class="nav-text">6.2.2 å£°æ˜æ–‡ä»¶è°ƒè¯•æ–¹æ³•è®º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-3-%E9%81%97%E7%95%99%E7%B3%BB%E7%BB%9F%E6%B8%90%E8%BF%9B%E5%BC%8F%E8%BF%81%E7%A7%BB"><span class="nav-text">6.2.3 é—ç•™ç³»ç»Ÿæ¸è¿›å¼è¿ç§»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-4-%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8%E7%9A%84%E9%87%8D%E6%9E%84%E4%BF%9D%E9%9A%9C"><span class="nav-text">6.2.4 ç±»å‹å®‰å…¨çš„é‡æ„ä¿éšœ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-%E5%89%8D%E6%B2%BF%E6%9E%B6%E6%9E%84"><span class="nav-text">6.3 å‰æ²¿æ¶æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-1-%E5%BE%AE%E5%89%8D%E7%AB%AF%E7%B1%BB%E5%9E%8B%E9%80%9A%E4%BF%A1%E6%96%B9%E6%A1%88"><span class="nav-text">6.3.1 å¾®å‰ç«¯ç±»å‹é€šä¿¡æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-2-Serverless-%E5%87%BD%E6%95%B0%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8"><span class="nav-text">6.3.2 Serverless å‡½æ•°ç±»å‹å®‰å…¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-3-WebAssembly-%E7%B1%BB%E5%9E%8B%E9%9B%86%E6%88%90"><span class="nav-text">6.3.3 WebAssembly ç±»å‹é›†æˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-4-Web-Workers-%E7%B1%BB%E5%9E%8B%E9%80%9A%E4%BF%A1"><span class="nav-text">6.3.4 Web Workers ç±»å‹é€šä¿¡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-4-%E9%9D%A2%E8%AF%95%E4%B8%93%E9%A1%B9"><span class="nav-text">6.4 é¢è¯•ä¸“é¡¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-1-%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="nav-text">6.4.1 ç±»å‹ä½“æ“è§£é¢˜æ€è·¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-2-%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98"><span class="nav-text">6.4.2 ç¼–è¯‘åŸç†ç›¸å…³é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-3-%E6%A1%86%E6%9E%B6%E9%9B%86%E6%88%90%E8%AE%BE%E8%AE%A1%E9%97%AE%E9%A2%98"><span class="nav-text">6.4.3 æ¡†æ¶é›†æˆè®¾è®¡é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-4-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%8C%87%E6%A0%87%E5%88%86%E6%9E%90"><span class="nav-text">6.4.4 æ€§èƒ½ä¼˜åŒ–æŒ‡æ ‡åˆ†æ</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ariel"
      src="/uploads/avatar.JPG">
  <p class="site-author-name" itemprop="name">Ariel</p>
  <div class="site-description" itemprop="description">ç¥æ¸¸åœ¨åˆè§çš„åˆå</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/tianfei92" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;tianfei92" rel="noopener me" target="_blank">GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:tian.fi@outlook.com" title="E-Mail â†’ mailto:tian.fi@outlook.com" rel="noopener me" target="_blank">E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.cn/user/3913917124325127" title="Juejin â†’ https:&#x2F;&#x2F;juejin.cn&#x2F;user&#x2F;3913917124325127" rel="noopener me" target="_blank">Juejin</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://tianfei92.github.io/2025/07/09/TypeScript%20Study%20Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.JPG">
      <meta itemprop="name" content="Ariel">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ariel's Blog">
      <meta itemprop="description" content="ç¥æ¸¸åœ¨åˆè§çš„åˆå">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šTypeScript | Ariel's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šTypeScript
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-07-09 17:15:51" itemprop="dateCreated datePublished" datetime="2025-07-09T17:15:51+08:00">2025-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-11 09:39:13" itemprop="dateModified" datetime="2025-07-11T09:39:13+08:00">2025-07-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>26k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>1:36</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="ä¸€ã€TypeScript-åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ"><a href="#ä¸€ã€TypeScript-åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="ä¸€ã€TypeScript åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ"></a>ä¸€ã€TypeScript åŸºç¡€ä¸æ ¸å¿ƒæ¦‚å¿µ</h1><h2 id="1-1-ç±»å‹ç³»ç»Ÿæ·±å…¥"><a href="#1-1-ç±»å‹ç³»ç»Ÿæ·±å…¥" class="headerlink" title="1.1 ç±»å‹ç³»ç»Ÿæ·±å…¥"></a>1.1 ç±»å‹ç³»ç»Ÿæ·±å…¥</h2><h3 id="1-1-1-åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶"><a href="#1-1-1-åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶" class="headerlink" title="1.1.1 åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶"></a>1.1.1 åŸºæœ¬ç±»å‹ä¸ç±»å‹æ¨æ–­æœºåˆ¶</h3><p><strong>åŸºæœ¬ç±»å‹ï¼ˆPrimitive Typesï¼‰</strong></p>
<table>
<thead>
<tr>
<th align="left">ç±»å‹</th>
<th align="left">æè¿°</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td align="left">å­—ç¬¦ä¸²ç±»å‹</td>
<td align="left">let name: string &#x3D; â€œAliceâ€</td>
</tr>
<tr>
<td align="left">number</td>
<td align="left">æ•°å€¼ç±»å‹ï¼ˆå«æ•´æ•°&#x2F;æµ®ç‚¹æ•°ï¼‰</td>
<td align="left">let age: number &#x3D; 30</td>
</tr>
<tr>
<td align="left">boolean</td>
<td align="left">å¸ƒå°”ç±»å‹</td>
<td align="left">let isDone: boolean &#x3D; true</td>
</tr>
<tr>
<td align="left">null</td>
<td align="left">ç©ºå€¼ï¼ˆéœ€å¼€å¯ strictNullChecksï¼‰</td>
<td align="left">let n: null &#x3D; null</td>
</tr>
<tr>
<td align="left">undefined	æœªå®šä¹‰å€¼</td>
<td align="left">let u: undefined &#x3D; undefined</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">symbol</td>
<td align="left">å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆES6ï¼‰</td>
<td align="left">const sym: symbol &#x3D; Symbol()</td>
</tr>
<tr>
<td align="left">bigint</td>
<td align="left">å¤§æ•´æ•°ï¼ˆES2020ï¼‰</td>
<td align="left">let big: bigint &#x3D; 100n</td>
</tr>
<tr>
<td align="left">void</td>
<td align="left">æ— è¿”å›å€¼ï¼ˆå‡½æ•°ï¼‰</td>
<td align="left">function warn(): void { console.log() }</td>
</tr>
</tbody></table>
<span id="more"></span>

<p><strong>ç±»å‹æ¨æ–­æœºåˆ¶ï¼ˆType Inferenceï¼‰</strong></p>
<p>(1) å˜é‡åˆå§‹åŒ–æ¨æ–­</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>          <span class="token comment">// æ¨æ–­ä¸º number</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token string">"text"</span><span class="token punctuation">;</span>    <span class="token comment">// æ¨æ–­ä¸º "text"ï¼ˆå­—é¢é‡ç±»å‹ï¼‰</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token punctuation">&#123;</span> x<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// æ¨æ–­ä¸º &#123; x: number &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>(2) å‡½æ•°è¿”å›å€¼æ¨æ–­</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>      <span class="token comment">// è‡ªåŠ¨æ¨æ–­è¿”å› number</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// æ¨æ–­è¿”å› boolean</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>(3) ä¸Šä¸‹æ–‡æ¨æ–­ï¼ˆContextual Typingï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å›è°ƒå‡½æ•°å‚æ•°æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ç±»å‹</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>v <span class="token operator">=></span> v <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// v æ¨æ–­ä¸º number</span>

<span class="token comment">// äº‹ä»¶å¤„ç†å‡½æ•°å‚æ•°æ¨æ–­</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> e <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// e æ¨æ–­ä¸º MouseEvent</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç‰¹æ®Šæ¨æ–­åœºæ™¯</strong></p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">æ¨æ–­è¡Œä¸º</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æœªåˆå§‹åŒ–å˜é‡</td>
<td align="left">æ¨æ–­ä¸º anyï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</td>
<td align="left">let x; â†’ x: any</td>
</tr>
<tr>
<td align="left">è”åˆç±»å‹åˆå§‹åŒ–</td>
<td align="left">æ¨æ–­æ‰€æœ‰å¯èƒ½ç±»å‹çš„è”åˆ</td>
<td align="left">let arr &#x3D; [0, â€œaâ€] â†’ <code>(number	string)[]</code></td>
</tr>
<tr>
<td align="left">const å¸¸é‡æ–­è¨€</td>
<td align="left">æ¨æ–­ä¸ºå­—é¢é‡ç±»å‹</td>
<td align="left">const size &#x3D; 100 as const â†’ 100</td>
</tr>
</tbody></table>
<p><strong>ç±»å‹æ¨æ–­ä¸æ˜¾ç¤ºæ³¨è§£å¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">æ¨èæ–¹å¼</th>
<th align="left">åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td align="left">å‡½æ•°å‚æ•°</td>
<td align="left">æ˜¾ç¤ºæ³¨è§£</td>
<td align="left">é¿å… any ä¼ æ’­é£é™©</td>
</tr>
<tr>
<td align="left">å¤æ‚å¯¹è±¡å­—é¢é‡</td>
<td align="left">æ˜¾ç¤ºæ³¨è§£æˆ–æ¥å£</td>
<td align="left">ç¡®ä¿ç»“æ„ç¬¦åˆé¢„æœŸ</td>
</tr>
<tr>
<td align="left">ç®€å•å˜é‡åˆå§‹åŒ–</td>
<td align="left">ä¾èµ–ç±»å‹æ¨æ–­</td>
<td align="left">å‡å°‘å†—ä½™ä»£ç </td>
</tr>
<tr>
<td align="left">å‡½æ•°è¿”å›å€¼</td>
<td align="left">ä¾èµ–ç±»å‹æ¨æ–­</td>
<td align="left">ä¿æŒä¸å®ç°åŒæ­¥ï¼ˆé™¤å…¬å¼€APIæ–‡æ¡£å¤–ï¼‰</td>
</tr>
</tbody></table>
<h3 id="1-1-2-å­—é¢é‡ç±»å‹ä¸è”åˆç±»å‹å®æˆ˜"><a href="#1-1-2-å­—é¢é‡ç±»å‹ä¸è”åˆç±»å‹å®æˆ˜" class="headerlink" title="1.1.2 å­—é¢é‡ç±»å‹ä¸è”åˆç±»å‹å®æˆ˜"></a>1.1.2 å­—é¢é‡ç±»å‹ä¸è”åˆç±»å‹å®æˆ˜</h3><p><strong>å­—é¢é‡ç±»å‹ï¼ˆLiteral Typesï¼‰</strong></p>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šå°†å€¼ä½œä¸ºç±»å‹ä½¿ç”¨ï¼Œé™åˆ¶å˜é‡åªèƒ½å–ç‰¹å®šå€¼ã€‚</p>
<table>
<thead>
<tr>
<th align="left">åˆ†ç±»</th>
<th align="left">è¯­æ³•ç¤ºä¾‹</th>
<th align="left">ç±»å‹è¡¨ç¤º</th>
</tr>
</thead>
<tbody><tr>
<td align="left">å­—ç¬¦ä¸²å­—é¢é‡</td>
<td align="left">let dir: â€œUPâ€ &#x3D; â€œUPâ€</td>
<td align="left">â€œUPâ€</td>
</tr>
<tr>
<td align="left">æ•°å­—å­—é¢é‡</td>
<td align="left">let size: 100 &#x3D; 100</td>
<td align="left">100</td>
</tr>
<tr>
<td align="left">å¸ƒå°”å­—é¢é‡</td>
<td align="left">let flag: true &#x3D; true</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">æ¨¡æ¿å­—é¢é‡</td>
<td align="left">type T &#x3D; prefix_${string}&#96;&#96;</td>
<td align="left">æ¨¡å¼åŒ¹é…ç±»å‹</td>
</tr>
</tbody></table>
<p>å·¥ç¨‹ä»·å€¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ›¿ä»£æšä¸¾ï¼ˆæ›´è½»é‡ï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">HttpMethod</span> <span class="token operator">=</span> <span class="token string">"GET"</span> <span class="token operator">|</span> <span class="token string">"POST"</span> <span class="token operator">|</span> <span class="token string">"PUT"</span> <span class="token operator">|</span> <span class="token string">"DELETE"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span>method<span class="token operator">:</span> HttpMethod<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span>

<span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// âœ…</span>
<span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token string">"COPY"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç¼–è¯‘é”™è¯¯ï¼šéå…è®¸å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è”åˆç±»å‹ï¼ˆUnion Typesï¼‰</strong></p>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šç»„åˆå¤šä¸ªç±»å‹ï¼Œè¡¨ç¤ºå€¼å¯ä»¥æ˜¯å…¶ä¸­ä»»æ„ä¸€ç§ç±»å‹ã€‚</p>
<p>è¯­æ³•ä¸ç‰¹æ€§ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">ID</span></span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>         <span class="token comment">// åŸºç¡€è”åˆ</span>
<span class="token keyword">type</span> <span class="token class-name">Status</span> <span class="token operator">=</span> <span class="token string">"idle"</span> <span class="token operator">|</span> <span class="token string">"loading"</span><span class="token punctuation">;</span>  <span class="token comment">// å­—é¢é‡è”åˆ</span>
<span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span> Circle <span class="token operator">|</span> Square<span class="token punctuation">;</span>      <span class="token comment">// å¯¹è±¡è”åˆ</span>

<span class="token comment">// è”åˆç±»å‹ç‰¹æ€§ï¼š</span>
<span class="token keyword">let</span> id<span class="token operator">:</span> <span class="token constant">ID</span> <span class="token operator">=</span> <span class="token string">"abc123"</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å…è®¸å­—ç¬¦ä¸²</span>
id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>              <span class="token comment">// âœ… å…è®¸æ•°å­—</span>
id <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>             <span class="token comment">// ğŸš« ä¸å…è®¸å¸ƒå°”å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹æ”¶çª„å®æˆ˜ï¼ˆType Narrowingï¼‰</strong></p>
<p>æ ¸å¿ƒæ–¹æ³•ï¼šåœ¨ä»£ç åˆ†æ”¯ä¸­ç¼©å°è”åˆç±»å‹èŒƒå›´</p>
<table>
<thead>
<tr>
<th align="left">æŠ€æœ¯</th>
<th align="left">ç¤ºä¾‹</th>
<th align="left">é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td align="left">typeof å®ˆå«</td>
<td align="left"><code>if (typeof val === &quot;string&quot;) &#123; val.toUpperCase() &#125;</code></td>
<td align="left">åŸºæœ¬ç±»å‹è”åˆ</td>
</tr>
<tr>
<td align="left">instanceof å®ˆå«</td>
<td align="left"><code>if (err instanceof Error) &#123; console.log(err.message) &#125;</code></td>
<td align="left">ç±»å®ä¾‹è”åˆ</td>
</tr>
<tr>
<td align="left">ç›¸ç­‰æ€§æ£€æŸ¥</td>
<td align="left"><code>if (status === &quot;loading&quot;) &#123; showSpinner() &#125;</code></td>
<td align="left">å­—é¢é‡è”åˆ</td>
</tr>
<tr>
<td align="left">è‡ªå®šä¹‰å®ˆå«</td>
<td align="left"><code>function isFish(pet: Fish Bird): pet is Fish &#123; return &quot;swim&quot; in pet &#125;</code></td>
<td align="left">å¤æ‚å¯¹è±¡è”åˆ</td>
</tr>
<tr>
<td align="left">å¯è¾¨è¯†è”åˆ</td>
<td align="left">é€šè¿‡å…±åŒå­—æ®µåŒºåˆ†ç±»å‹ï¼ˆè§ä¸‹ä¾‹ï¼‰</td>
<td align="left">å¯¹è±¡è”åˆï¼ˆè®¾è®¡æ¨¡å¼ï¼‰</td>
</tr>
</tbody></table>
<p>å¯è¾¨è¯†è”åˆå®æˆ˜ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Step 1: å®šä¹‰å…·æœ‰kindå­—æ®µçš„è”åˆç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span> 
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> kind<span class="token operator">:</span> <span class="token string">"circle"</span><span class="token punctuation">;</span> radius<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span> 
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> kind<span class="token operator">:</span> <span class="token string">"square"</span><span class="token punctuation">;</span> size<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// Step 2: ä½¿ç”¨kindå­—æ®µæ”¶çª„ç±»å‹</span>
<span class="token keyword">function</span> <span class="token function">getArea</span><span class="token punctuation">(</span>shape<span class="token operator">:</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>shape<span class="token punctuation">.</span>kind<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">"circle"</span><span class="token operator">:</span>
      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> shape<span class="token punctuation">.</span>radius <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment">// æ­¤åˆ†æ”¯shapeè¢«æ”¶çª„ä¸ºåœ†å½¢</span>
    <span class="token keyword">case</span> <span class="token string">"square"</span><span class="token operator">:</span>
      <span class="token keyword">return</span> shape<span class="token punctuation">.</span>size <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>              <span class="token comment">// æ­¤åˆ†æ”¯shapeè¢«æ”¶çª„ä¸ºæ–¹å½¢</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹æœ€ä½³å®è·µ</strong></p>
<p>(1) é¿å…è¿‡åº¦ä½¿ç”¨å­—é¢é‡è”åˆ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸æ¨èï¼šç›´æ¥ä½¿ç”¨å­—é¢é‡</span>
<span class="token keyword">function</span> <span class="token function">setColor</span><span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token string">"red"</span> <span class="token operator">|</span> <span class="token string">"green"</span> <span class="token operator">|</span> <span class="token string">"blue"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span>

<span class="token comment">// æ¨èï¼šä½¿ç”¨å‘½åç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">PrimaryColor</span> <span class="token operator">=</span> <span class="token string">"red"</span> <span class="token operator">|</span> <span class="token string">"green"</span> <span class="token operator">|</span> <span class="token string">"blue"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">setColor</span><span class="token punctuation">(</span>color<span class="token operator">:</span> PrimaryColor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(2) è”åˆç±»å‹ä¸å‡½æ•°é‡è½½é…åˆ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ¹æ®å‚æ•°ç±»å‹è¿”å›ä¸åŒç»“æœ</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>  <span class="token comment">// æ•°å­—å¤„ç†</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> padding <span class="token operator">+</span> value<span class="token punctuation">;</span>                <span class="token comment">// å­—ç¬¦ä¸²å¤„ç†</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-1-3-any-unknown-never-çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯"><a href="#1-1-3-any-unknown-never-çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯" class="headerlink" title="1.1.3 any&#x2F;unknown&#x2F;never çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯"></a>1.1.3 any&#x2F;unknown&#x2F;never çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯</h3><p><strong>æ ¸å¿ƒç±»å‹å¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th align="left">ç‰¹æ€§</th>
<th align="left">any</th>
<th align="left">unknown</th>
<th align="left">never</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç±»å‹å®‰å…¨æ€§</td>
<td align="left">âŒ å®Œå…¨ç¦ç”¨ç±»å‹æ£€æŸ¥</td>
<td align="left">âœ… å®‰å…¨å®¹å™¨ï¼ˆéœ€æ˜¾å¼ç±»å‹æ–­è¨€ï¼‰</td>
<td align="left">âœ… è¡¨ç¤ºä¸å¯èƒ½å­˜åœ¨çš„å€¼</td>
</tr>
<tr>
<td align="left">å¯èµ‹å€¼ç»™</td>
<td align="left">ä»»æ„ç±»å‹</td>
<td align="left">ä»… any å’Œ unknown</td>
<td align="left">ä»»æ„ç±»å‹ï¼ˆåº•éƒ¨ç±»å‹ï¼‰</td>
</tr>
<tr>
<td align="left">å¯æ¥å—èµ‹å€¼</td>
<td align="left">ä»»æ„ç±»å‹</td>
<td align="left">ä»»æ„ç±»å‹</td>
<td align="left">ä¸å¯èµ‹å€¼ï¼ˆé™¤ never æœ¬èº«ï¼‰</td>
</tr>
<tr>
<td align="left">æ“ä½œè‡ªç”±åº¦</td>
<td align="left">ç›´æ¥è®¿é—®å±æ€§&#x2F;æ–¹æ³•</td>
<td align="left">å¿…é¡»å…ˆæ–­è¨€å…·ä½“ç±»å‹	æ— æ³•å®ä¾‹åŒ–</td>
<td align="left"></td>
</tr>
</tbody></table>
<p><strong>any ç±»å‹è¯¦è§£</strong></p>
<p>è®¾è®¡ç›®çš„ï¼šç”¨äºå…¼å®¹ JavaScript æ— ç±»å‹ä»£ç æˆ–ç¬¬ä¸‰æ–¹åº“ç¼ºå¤±ç±»å‹å£°æ˜ã€‚</p>
<p>å…¸å‹åœºæ™¯ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åœºæ™¯1ï¼šè¿ç§»é—ç•™JSä»£ç </span>
<span class="token keyword">const</span> legacyData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">getUntypedData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
legacyData<span class="token punctuation">.</span><span class="token function">invalidMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¯èƒ½æŠ¥é”™</span>

<span class="token comment">// åœºæ™¯2ï¼šåŠ¨æ€å±æ€§è®¿é—®</span>
<span class="token keyword">const</span> obj<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>arbitraryProperty <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">// å…è®¸ä»»æ„å±æ€§èµ‹å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é£é™©è­¦ç¤ºï¼šä½¿ç”¨ any ä¼šç ´åç±»å‹ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œåº”é€šè¿‡ tsconfig.json å¼€å¯ noImplicitAny ä¸¥æ ¼æ£€æŸ¥ã€‚</p>
<p><strong>unknown ç±»å‹è¯¦è§£</strong></p>
<p>è®¾è®¡ç›®çš„ï¼šæä¾›ç±»å‹å®‰å…¨çš„é¡¶å±‚å®¹å™¨ï¼Œæ›¿ä»£ any å¤„ç†ä¸ç¡®å®šç±»å‹ã€‚</p>
<p>æ ‡å‡†ä½¿ç”¨æ¨¡å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 1. æ¥æ”¶ä¸ç¡®å®šç±»å‹å€¼</span>
<span class="token keyword">const</span> userInput<span class="token operator">:</span> <span class="token builtin">unknown</span> <span class="token operator">=</span> <span class="token function">fetchUserInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. ä½¿ç”¨æ—¶æ˜¾å¼æ–­è¨€</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> userInput <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userInput<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ”¶çª„ä¸ºstring</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 3. æˆ–ä½¿ç”¨ç±»å‹æ–­è¨€</span>
<span class="token keyword">const</span> parsed <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨å®¹å™¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å·¥ç¨‹å®è·µï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®‰å…¨ååºåˆ—åŒ–å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">safeParse</span><span class="token punctuation">(</span>json<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">unknown</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token string">'&#123;"name":"Alice"&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">"object"</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"name"</span> <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡ç±»å‹å®ˆå«å®‰å…¨è®¿é—®</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>never ç±»å‹è¯¦è§£</strong></p>
<p>è®¾è®¡ç›®çš„ï¼šè¡¨ç¤ºæ°¸è¿œä¸ä¼šå‘ç”Ÿçš„å€¼æˆ–ä¸å¯è¾¾çš„ä»£ç åˆ†æ”¯ã€‚</p>
<p>æ ¸å¿ƒåº”ç”¨åœºæ™¯ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åœºæ™¯1ï¼šæŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åœºæ™¯2ï¼šæ­»å¾ªç¯å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">infiniteLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">never</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åœºæ™¯3ï¼šç©·å°½æ£€æŸ¥ï¼ˆExhaustiveness checkingï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">Shape</span> <span class="token operator">=</span> <span class="token string">"circle"</span> <span class="token operator">|</span> <span class="token string">"square"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getArea</span><span class="token punctuation">(</span>shape<span class="token operator">:</span> Shape<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>shape<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">"circle"</span><span class="token operator">:</span> <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> r<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"square"</span><span class="token operator">:</span> <span class="token keyword">return</span> s<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span> 
      <span class="token keyword">const</span> _exhaustiveCheck<span class="token operator">:</span> <span class="token builtin">never</span> <span class="token operator">=</span> shape<span class="token punctuation">;</span> <span class="token comment">// è‹¥æ–°å¢shapeç±»å‹ä¼šæŠ¥é”™</span>
      <span class="token keyword">return</span> _exhaustiveCheck<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹ç³»ç»Ÿç‰¹æ€§ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// never æ˜¯ä»»æ„ç±»å‹çš„å­ç±»å‹</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> n<span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> n<span class="token punctuation">;</span> <span class="token comment">// âœ… ç¼–è¯‘é€šè¿‡</span>

<span class="token comment">// ç©ºæ•°ç»„ç±»å‹æ¨æ–­</span>
<span class="token keyword">const</span> emptyArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// æ¨æ–­ä¸º never[]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹é€‰æ‹©æŒ‡å—</strong></p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">æ¨èç±»å‹</th>
<th align="left">åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç¬¬ä¸‰æ–¹JSåº“è¿ç§»</td>
<td align="left">any</td>
<td align="left">å¿«é€Ÿè¿‡æ¸¡æœŸæ–¹æ¡ˆ</td>
</tr>
<tr>
<td align="left">APIå“åº”è§£æ</td>
<td align="left">unknown</td>
<td align="left">å®‰å…¨å¤„ç†åŠ¨æ€æ•°æ®ç»“æ„</td>
</tr>
<tr>
<td align="left">é”™è¯¯å¤„ç†å‡½æ•°</td>
<td align="left">never</td>
<td align="left">æ˜ç¡®è¡¨ç¤ºå‡½æ•°ä¸ä¼šæ­£å¸¸è¿”å›</td>
</tr>
<tr>
<td align="left">ç±»å‹å®ˆå«ä¸­ä¸å¯è¾¾åˆ†æ”¯</td>
<td align="left">never</td>
<td align="left">è§¦å‘ç©·å°½æ£€æŸ¥</td>
</tr>
<tr>
<td align="left">æ³›å‹ç¼–ç¨‹ä¸­çš„ç©ºé›†åˆ</td>
<td align="left">never</td>
<td align="left">è¡¨ç¤ºä¸å¯èƒ½å­˜åœ¨çš„ç±»å‹ï¼ˆå¦‚ keyof never &#x3D; neverï¼‰</td>
</tr>
</tbody></table>
<h3 id="1-1-4-ç±»å‹æ–­è¨€ä¸ç±»å‹å®ˆå«å®ç°åŸç†"><a href="#1-1-4-ç±»å‹æ–­è¨€ä¸ç±»å‹å®ˆå«å®ç°åŸç†" class="headerlink" title="1.1.4 ç±»å‹æ–­è¨€ä¸ç±»å‹å®ˆå«å®ç°åŸç†"></a>1.1.4 ç±»å‹æ–­è¨€ä¸ç±»å‹å®ˆå«å®ç°åŸç†</h3><p><strong>ç±»å‹æ–­è¨€ï¼ˆType Assertionsï¼‰</strong></p>
<p>æœ¬è´¨ï¼šå¼€å‘è€…å‘ç¼–è¯‘å™¨æä¾›æ›´å…·ä½“çš„ç±»å‹ä¿¡æ¯ï¼ˆä¸æ”¹å˜è¿è¡Œæ—¶å€¼ï¼‰</p>
<p>ä¸¤ç§è¯­æ³•å½¢å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å°–æ‹¬å·è¯­æ³•ï¼ˆJSXä¸­ä¸å¯ç”¨ï¼‰</span>
<span class="token keyword">const</span> strLength<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span>someValue<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

<span class="token comment">// as è¯­æ³•ï¼ˆæ¨èï¼‰</span>
<span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLDivElement<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<p>(1) DOM å…ƒç´ ç±»å‹ç»†åŒ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input[type="text"]'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> HTMLInputElement<span class="token punctuation">;</span>
input<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'new value'</span><span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨è®¿é—®valueå±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>(2) è”åˆç±»å‹æ”¶çª„</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>padding <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// æ–­è¨€ä¸ºnumber</span>
    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>padding <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>padding <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(3) å¤„ç†anyç±»å‹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> unknownData<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> validData <span class="token operator">=</span> unknownData <span class="token keyword">as</span> UserData<span class="token punctuation">;</span> <span class="token comment">// æ–­è¨€ä¸ºå…·ä½“ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>æ–­è¨€å¿…é¡»æ»¡è¶³â€ç»“æ„å…¼å®¹â€ï¼ˆå¦‚ä¸èƒ½å°† string æ–­è¨€ä¸º numberï¼‰</li>
<li>åŒé‡æ–­è¨€è§„é¿é™åˆ¶ï¼ˆæ…ç”¨ï¼‰ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> num <span class="token operator">=</span> str <span class="token keyword">as</span> <span class="token builtin">any</span> <span class="token keyword">as</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// ç»•è¿‡ç±»å‹æ£€æŸ¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹å®ˆå«ï¼ˆType Guardsï¼‰</strong></p>
<p>åŸç†ï¼šé€šè¿‡è¿è¡Œæ—¶æ£€æŸ¥è§¦å‘ç¼–è¯‘æ—¶ç±»å‹æ”¶çª„</p>
<p>å†…ç½®å®ˆå«æœºåˆ¶ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç±»å‹å®ˆå«</th>
<th align="left">è¯­æ³•ç¤ºä¾‹</th>
<th align="left">æ”¶çª„æ•ˆæœ</th>
</tr>
</thead>
<tbody><tr>
<td align="left">typeof</td>
<td align="left">typeof val &#x3D;&#x3D;&#x3D; â€œstringâ€</td>
<td align="left">åŸºæœ¬ç±»å‹ â†’ å…·ä½“ç±»å‹</td>
</tr>
<tr>
<td align="left">instanceof</td>
<td align="left">obj instanceof Date</td>
<td align="left">ç±»å®ä¾‹ â†’ å…·ä½“ç±»</td>
</tr>
<tr>
<td align="left">in æ“ä½œç¬¦</td>
<td align="left">â€œpropâ€ in obj</td>
<td align="left">å¯¹è±¡ â†’ åŒ…å«è¯¥å±æ€§ç±»å‹</td>
</tr>
<tr>
<td align="left">å­—é¢é‡ç›¸ç­‰æ£€æŸ¥</td>
<td align="left">status &#x3D;&#x3D;&#x3D; â€œsuccessâ€</td>
<td align="left">è”åˆ â†’ å…·ä½“å­—é¢é‡ç±»å‹</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">printValue</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// valæ”¶çª„ä¸ºstring</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// valæ”¶çª„ä¸ºnumber</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è‡ªå®šä¹‰ç±»å‹å®ˆå«</strong></p>
<p>å®ç°åŸç†ï¼šè¿”å›ç±»å‹è°“è¯ï¼ˆarg is Tï¼‰</p>
<p>æ ‡å‡†æ¨¡å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">isString</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span><span class="token operator">:</span> val <span class="token keyword">is</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    input<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// inputè¢«æ”¶çª„ä¸ºstring</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤æ‚å¯¹è±¡å®ˆå«å®æˆ˜ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Cat</span> <span class="token punctuation">&#123;</span> <span class="token function">meow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">interface</span> <span class="token class-name">Dog</span> <span class="token punctuation">&#123;</span> <span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">isCat</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">)</span><span class="token operator">:</span> animal <span class="token keyword">is</span> Cat <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>animal <span class="token keyword">as</span> Cat<span class="token punctuation">)</span><span class="token punctuation">.</span>meow <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">handleAnimal</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Cat <span class="token operator">|</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCat</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    animal<span class="token punctuation">.</span><span class="token function">meow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ”¶çª„ä¸ºCat</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    animal<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ”¶çª„ä¸ºDog</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¯è¾¨è¯†è”åˆï¼ˆDiscriminated Unionsï¼‰</strong></p>
<p>ç‰¹æ®Šç±»å‹å®ˆå«ï¼šé€šè¿‡å…±åŒå­—æ®µè‡ªåŠ¨æ”¶çª„</p>
<p>å®ç°åŸç†ï¼š</p>
<ul>
<li>å®šä¹‰å…·æœ‰ç›¸åŒåˆ¤åˆ«å­—æ®µçš„è”åˆç±»å‹</li>
<li>é€šè¿‡åˆ¤åˆ«å­—æ®µå€¼æ”¶çª„ç±»å‹</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NetworkState</span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> state<span class="token operator">:</span> <span class="token string">"loading"</span> <span class="token punctuation">&#125;</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> state<span class="token operator">:</span> <span class="token string">"success"</span><span class="token punctuation">,</span> response<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> state<span class="token operator">:</span> <span class="token string">"error"</span><span class="token punctuation">,</span> message<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">logState</span><span class="token punctuation">(</span>state<span class="token operator">:</span> NetworkState<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">"loading"</span><span class="token operator">:</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Loading..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state: &#123; state: "loading" &#125;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"success"</span><span class="token operator">:</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state: &#123; state: "success", response: string &#125;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"error"</span><span class="token operator">:</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// state: &#123; state: "error", message: string &#125;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨ç±»å‹å®ˆå«ï¼šæ¯”ç±»å‹æ–­è¨€æ›´å®‰å…¨ï¼ˆè¿è¡Œæ—¶éªŒè¯ï¼‰</li>
<li>é¿å…è¿‡åº¦æ–­è¨€ï¼šè¿‡åº¦ä½¿ç”¨ as ä¼šå¼±åŒ–ç±»å‹æ£€æŸ¥</li>
<li>å®ˆå«å‡½æ•°å¤ç”¨ï¼šæå–å¤æ‚åˆ¤æ–­é€»è¾‘ä¸ºå¯å¤ç”¨å®ˆå«</li>
<li>å¯è¾¨è¯†è”åˆè®¾è®¡ï¼šé€‚åˆç®¡ç†å¤æ‚çŠ¶æ€æœºç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// çŠ¶æ€æœºç±»å‹å®ˆå«ç¤ºä¾‹</span>
<span class="token keyword">type</span> <span class="token class-name">State</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> status<span class="token operator">:</span> <span class="token string">'idle'</span> <span class="token punctuation">&#125;</span> <span class="token operator">|</span> <span class="token punctuation">&#123;</span> status<span class="token operator">:</span> <span class="token string">'fetching'</span><span class="token punctuation">;</span> startTime<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleState</span><span class="token punctuation">(</span>state<span class="token operator">:</span> State<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token string">'fetching'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> duration <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> state<span class="token punctuation">.</span>startTime<span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨è®¿é—®startTime</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-1-5-ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸é¸­å­ç±»å‹"><a href="#1-1-5-ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸é¸­å­ç±»å‹" class="headerlink" title="1.1.5 ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸é¸­å­ç±»å‹"></a>1.1.5 ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿä¸é¸­å­ç±»å‹</h3><p><strong>æ ¸å¿ƒæ¦‚å¿µè§£æ</strong></p>
<table>
<thead>
<tr>
<th align="left">æœ¯è¯­</th>
<th align="left">å®šä¹‰</th>
<th align="left">å¯¹æ¯”æ¨¡å‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç»“æ„åŒ–ç±»å‹ç³»ç»Ÿ</td>
<td align="left">ç±»å‹å…¼å®¹æ€§åŸºäºç±»å‹çš„ç»“æ„å±æ€§ï¼ˆè€Œéåç§°ï¼‰</td>
<td align="left">TypeScript, Go</td>
</tr>
<tr>
<td align="left">åä¹‰ç±»å‹ç³»ç»Ÿ</td>
<td align="left">ç±»å‹å…¼å®¹æ€§åŸºäºç±»å‹å£°æ˜åç§°ï¼ˆéœ€æ˜¾å¼ç»§æ‰¿ï¼‰</td>
<td align="left">Java, C#</td>
</tr>
<tr>
<td align="left">é¸­å­ç±»å‹</td>
<td align="left">â€œå¦‚æœå®ƒèµ°èµ·æ¥åƒé¸­å­ã€å«èµ·æ¥åƒé¸­å­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­â€ï¼ˆå…³æ³¨è¡Œä¸ºè€Œéå…·ä½“ç±»å‹ï¼‰</td>
<td align="left">åŠ¨æ€è¯­è¨€å“²å­¦</td>
</tr>
</tbody></table>
<p><strong>ç»“æ„åŒ–ç±»å‹ç³»ç»ŸåŸç†</strong></p>
<p>åŸºæœ¬è§„åˆ™ï¼š</p>
<ul>
<li>ç±»å‹ A å…¼å®¹ç±»å‹ B å½“ä¸”ä»…å½“ A æ‹¥æœ‰ B çš„æ‰€æœ‰å¿…éœ€æˆå‘˜ï¼ˆæˆå‘˜åå’Œç±»å‹åŒ¹é…ï¼‰</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Vector2D</span> <span class="token punctuation">&#123;</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç±»æ— éœ€æ˜¾å¼å®ç°æ¥å£ï¼ˆç»“æ„åŒ¹é…å³å¯ï¼‰</span>
<span class="token keyword">class</span> <span class="token class-name">Point2D</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token keyword">public</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> v<span class="token operator">:</span> Vector2D <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point2D</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å…¼å®¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å±æ€§æ£€æŸ¥è§„åˆ™ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç›´æ¥èµ‹å€¼å­—é¢é‡æ—¶è§¦å‘ä¸¥æ ¼æ£€æŸ¥</span>
<span class="token keyword">const</span> p<span class="token operator">:</span> Person <span class="token operator">=</span> <span class="token punctuation">&#123;</span> 
  name<span class="token operator">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
  gender<span class="token operator">:</span> <span class="token string">"female"</span>  <span class="token comment">// ğŸš« é”™è¯¯ï¼å¤šä½™å±æ€§</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// é€šè¿‡ä¸­é—´å˜é‡èµ‹å€¼ï¼ˆç»•è¿‡é¢å¤–å±æ€§æ£€æŸ¥ï¼‰</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> gender<span class="token operator">:</span> <span class="token string">"male"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> p2<span class="token operator">:</span> Person <span class="token operator">=</span> obj<span class="token punctuation">;</span> <span class="token comment">// âœ… å…¼å®¹ï¼ˆç»“æ„æ»¡è¶³æ ¸å¿ƒå±æ€§ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¸­å­ç±»å‹å®æˆ˜åœºæ™¯</strong></p>
<p>åœºæ™¯1ï¼šå‡½æ•°å‚æ•°å…¼å®¹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Loggable</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">log</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">ConsoleLogger</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Logging..."</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">FileLogger</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">"log.txt"</span><span class="token punctuation">,</span> <span class="token string">"..."</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ¥å—ä»»ä½•å…·æœ‰logæ–¹æ³•çš„å¯¹è±¡</span>
<span class="token keyword">function</span> <span class="token function">logOutput</span><span class="token punctuation">(</span>logger<span class="token operator">:</span> Loggable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">logOutput</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ConsoleLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
<span class="token function">logOutput</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šAPIå“åº”å¤„ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ApiResponse</span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
  status<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ— éœ€å¼ºåˆ¶è½¬æ¢ï¼Œåªè¦ç»“æ„åŒ¹é…</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">processResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">function</span> <span class="token function">processResponse</span><span class="token punctuation">(</span>res<span class="token operator">:</span> ApiResponse<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">parseData</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»“æ„åŒ–ç±»å‹çš„è¾¹ç•Œæ§åˆ¶</strong></p>
<p>(1) ç²¾ç¡®ç±»å‹æ§åˆ¶ï¼ˆé¿å…æ„å¤–åŒ¹é…ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨ç‹¬ç‰¹æ ‡è¯†é˜²æ­¢ç»“æ„è¯¯åŒ¹é…</span>
<span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  _type<span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">;</span> <span class="token comment">// å”¯ä¸€æ ‡è¯†</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">Admin</span> <span class="token punctuation">&#123;</span>
  _type<span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">;</span> <span class="token comment">// å”¯ä¸€æ ‡è¯†</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  privileges<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">handleEntity</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> User <span class="token operator">|</span> Admin<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>entity<span class="token punctuation">.</span>_type <span class="token operator">===</span> <span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// å®‰å…¨æ”¶çª„åˆ°Userç±»å‹</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(2) å¯é€‰å±æ€§ä¸æœªçŸ¥å±æ€§å¤„ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  debug<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// å¯é€‰å±æ€§</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span> <span class="token comment">// å…è®¸æœªçŸ¥å±æ€§</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> Config <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  color<span class="token operator">:</span> <span class="token string">"blue"</span> <span class="token comment">// âœ… å…è®¸é¢å¤–å±æ€§ï¼ˆå› ç´¢å¼•ç­¾åå­˜åœ¨ï¼‰</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¸åä¹‰ç±»å‹ç³»ç»Ÿçš„äº’æ“ä½œ</strong></p>
<p>æ¨¡æ‹Ÿåä¹‰ç±»å‹ï¼ˆé€šè¿‡äº¤å‰ç±»å‹ï¼‰ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ›å»ºåä¹‰ç±»å‹æ ‡è®°</span>
<span class="token keyword">type</span> <span class="token class-name">UserID</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> __brand<span class="token operator">:</span> <span class="token string">"UserID"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">OrderID</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> __brand<span class="token operator">:</span> <span class="token string">"OrderID"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ç±»å‹åˆ›å»ºå‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">createUserID</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> UserID <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> id <span class="token keyword">as</span> UserID<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">const</span> userId<span class="token operator">:</span> UserID <span class="token operator">=</span> <span class="token function">createUserID</span><span class="token punctuation">(</span><span class="token string">"user-123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orderId<span class="token operator">:</span> OrderID <span class="token operator">=</span> <span class="token string">"order-456"</span> <span class="token keyword">as</span> OrderID<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">getUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> UserID<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token operator">...</span><span class="token punctuation">&#125;</span>

<span class="token function">getUser</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
<span class="token function">getUser</span><span class="token punctuation">(</span>orderId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç¼–è¯‘é”™è¯¯ï¼šç±»å‹ä¸å…¼å®¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨æ¥å£è€Œéç±»ï¼šæ¥å£æ›´ç¬¦åˆç»“æ„åŒ–ç±»å‹å“²å­¦ï¼ˆè½»é‡çº§å¥‘çº¦ï¼‰</li>
<li>é¿å…è¿‡åº¦åŒ¹é…é—®é¢˜ï¼šé€šè¿‡æœ€å°åŒ–æ¥å£å±æ€§å‡å°‘æ„å¤–å…¼å®¹</li>
<li>åˆ©ç”¨ç±»å‹æ¨å¯¼ä¼˜åŠ¿ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è‡ªåŠ¨æ¨å¯¼è¿”å›ç±»å‹ç¬¦åˆç»“æ„</span>
<span class="token keyword">function</span> <span class="token function">createPoint</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªåŠ¨å…¼å®¹ Vector2D</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>é¸­å­ç±»å‹æµ‹è¯•ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¿è¡Œæ—¶éªŒè¯å¯¹è±¡æ˜¯å¦æ»¡è¶³ç»“æ„</span>
<span class="token keyword">function</span> <span class="token function">isVector2D</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> obj <span class="token keyword">is</span> Vector2D <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token string">"x"</span> <span class="token keyword">in</span> obj <span class="token operator">&amp;&amp;</span> <span class="token string">"y"</span> <span class="token keyword">in</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="1-2-æ¥å£ä¸é¢å‘å¯¹è±¡"><a href="#1-2-æ¥å£ä¸é¢å‘å¯¹è±¡" class="headerlink" title="1.2 æ¥å£ä¸é¢å‘å¯¹è±¡"></a>1.2 æ¥å£ä¸é¢å‘å¯¹è±¡</h2><h3 id="1-2-1-æ¥å£é«˜çº§ç‰¹æ€§ï¼ˆå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åï¼‰"><a href="#1-2-1-æ¥å£é«˜çº§ç‰¹æ€§ï¼ˆå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åï¼‰" class="headerlink" title="1.2.1 æ¥å£é«˜çº§ç‰¹æ€§ï¼ˆå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åï¼‰"></a>1.2.1 æ¥å£é«˜çº§ç‰¹æ€§ï¼ˆå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åï¼‰</h3><p><strong>å¯é€‰å±æ€§ï¼ˆOptional Propertiesï¼‰</strong></p>
<p>è¯­æ³•ï¼šåœ¨å±æ€§ååæ·»åŠ  ?</p>
<p>ä½œç”¨ï¼šå…è®¸å¯¹è±¡ç¼ºå°‘è¯¥å±æ€§</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">UserProfile</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>  <span class="token comment">// å¯é€‰å±æ€§</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> user1<span class="token operator">:</span> UserProfile <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>          <span class="token comment">// âœ… age å¯çœç•¥</span>
<span class="token keyword">const</span> user2<span class="token operator">:</span> UserProfile <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Bob"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œæ—¶æ£€æŸ¥ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"age"</span> <span class="token keyword">in</span> user1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user1<span class="token punctuation">.</span>age<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨è®¿é—®</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>åªè¯»å±æ€§ï¼ˆReadonly Propertiesï¼‰</strong></p>
<p>è¯­æ³•ï¼šä½¿ç”¨ readonly ä¿®é¥°ç¬¦</p>
<p>ä½œç”¨ï¼šåˆå§‹åŒ–åç¦æ­¢ä¿®æ”¹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> apiKey<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  endpoint<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> Config <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  apiKey<span class="token operator">:</span> <span class="token string">"abc123"</span><span class="token punctuation">,</span>
  endpoint<span class="token operator">:</span> <span class="token string">"/api"</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

config<span class="token punctuation">.</span>endpoint <span class="token operator">=</span> <span class="token string">"/new"</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å…è®¸ä¿®æ”¹</span>
config<span class="token punctuation">.</span>apiKey <span class="token operator">=</span> <span class="token string">"xyz"</span><span class="token punctuation">;</span>    <span class="token comment">// ğŸš« ç¼–è¯‘é”™è¯¯ï¼šåªè¯»å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç‰¹æ®Šåœºæ™¯ - åªè¯»æ•°ç»„ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ImmutableData</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> tags<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> data<span class="token operator">:</span> ImmutableData <span class="token operator">=</span> <span class="token punctuation">&#123;</span> tags<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"frontend"</span><span class="token punctuation">,</span> <span class="token string">"react"</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span>tags<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"typescript"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å…è®¸ï¼ˆæ•°ç»„å¼•ç”¨æœªå˜ï¼‰</span>
data<span class="token punctuation">.</span>tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"new"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token comment">// ğŸš« ç¦æ­¢é‡æ–°èµ‹å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç´¢å¼•ç­¾åï¼ˆIndex Signaturesï¼‰</strong></p>
<p>è¯­æ³•ï¼š[key: KeyType]: ValueType</p>
<p>ä½œç”¨ï¼šå®šä¹‰åŠ¨æ€å±æ€§å</p>
<p>åŸºç¡€ç”¨æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">StringMap</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// å…è®¸ä»»æ„å­—ç¬¦ä¸²å±æ€§å</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> scores<span class="token operator">:</span> StringMap <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  math<span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span>
  science<span class="token operator">:</span> <span class="token number">90</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
scores<span class="token punctuation">[</span><span class="token string">"english"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span> <span class="token comment">// âœ… åŠ¨æ€æ·»åŠ </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ··åˆä½¿ç”¨ï¼ˆå›ºå®šå±æ€§ + ç´¢å¼•ç­¾åï¼‰ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">HybridInterface</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>          <span class="token comment">// å›ºå®šå±æ€§</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>  <span class="token comment">// åŠ¨æ€å±æ€§</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> obj<span class="token operator">:</span> HybridInterface <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span>
  tempData<span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token comment">// âœ… åŠ¨æ€å±æ€§</span>
  count<span class="token operator">:</span> <span class="token number">10</span>             <span class="token comment">// âœ…</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">"456"</span><span class="token punctuation">;</span>         <span class="token comment">// âœ… å›ºå®šå±æ€§å¯ä¿®æ”¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç´¢å¼•ç±»å‹é™åˆ¶ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç´¢å¼•ç±»å‹</th>
<th align="left">ç¤ºä¾‹</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td align="left">[key: string]: T</td>
<td align="left">æ”¯æŒæ‰€æœ‰å­—ç¬¦ä¸²é”®</td>
</tr>
<tr>
<td align="left">number</td>
<td align="left">[index: number]: T</td>
<td align="left">æ•°ç»„å¼è®¿é—®ï¼ˆå®é™…é”®ä»ä¸ºå­—ç¬¦ä¸²ï¼‰</td>
</tr>
<tr>
<td align="left">symbol</td>
<td align="left">[sym: symbol]: T</td>
<td align="left">ES6 Symbol é”®</td>
</tr>
<tr>
<td align="left">æ¨¡æ¿å­—é¢é‡</td>
<td align="left">[key: test_${string}]: T</td>
<td align="left">TS 4.4+ æ¨¡å¼åŒ¹é…</td>
</tr>
</tbody></table>
<p><strong>é«˜çº§ç»„åˆåº”ç”¨</strong></p>
<p>åœºæ™¯ï¼šé…ç½®å¯¹è±¡</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>   <span class="token comment">// åªè¯»ç‰ˆæœ¬å·</span>
  env<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">"dev"</span> <span class="token operator">|</span> <span class="token string">"prod"</span><span class="token punctuation">;</span>       <span class="token comment">// å¯é€‰ç¯å¢ƒ</span>
  <span class="token punctuation">[</span>option<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>  <span class="token comment">// å…¶ä»–åŠ¨æ€é…ç½®</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> config<span class="token operator">:</span> AppConfig <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  version<span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  debug<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// âœ… åŠ¨æ€å±æ€§</span>
  maxRetries<span class="token operator">:</span> <span class="token number">3</span>      <span class="token comment">// âœ…</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

config<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token string">"2.0"</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç¦æ­¢ä¿®æ”¹åªè¯»å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç´¢å¼•ç­¾åç±»å‹çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚æ‰€æœ‰å±æ€§å€¼ç±»å‹å…¼å®¹</span>
<span class="token keyword">interface</span> <span class="token class-name">ConsistentValues</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>      <span class="token comment">// âœ… å…¼å®¹ string | number</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// é”™è¯¯ç¤ºä¾‹ï¼ˆç±»å‹å†²çªï¼‰</span>
<span class="token keyword">interface</span> <span class="token class-name">Invalid</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>       <span class="token comment">// ğŸš« ä¸ç´¢å¼•ç­¾åç±»å‹ä¸å…¼å®¹</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>ä¼˜å…ˆæ˜¾å¼å£°æ˜é‡è¦å±æ€§ï¼šé¿å…è¿‡åº¦ä¾èµ–ç´¢å¼•ç­¾å</li>
<li>åªè¯»å±æ€§ç”¨äºä¸å˜æ•°æ®ï¼šå¦‚é…ç½®IDã€ç‰ˆæœ¬å·ç­‰</li>
<li>å¯é€‰å±æ€§æ›¿ä»£ç©ºå€¼ï¼šæ¯” property: null æ›´è¯­ä¹‰åŒ–</li>
<li>ç´¢å¼•ç­¾åè¾¹ç•Œæ§åˆ¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç²¾ç¡®æ§åˆ¶åŠ¨æ€å±æ€§ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">SafeDynamic</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»æ˜¾å¼æ£€æŸ¥</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> SafeDynamic<span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Missing property"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token comment">// æ­¤æ—¶ç±»å‹æ”¶çª„ä¸º string</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-2-2-ç±»ç»§æ‰¿ä½“ç³»ä¸è®¿é—®ä¿®é¥°ç¬¦"><a href="#1-2-2-ç±»ç»§æ‰¿ä½“ç³»ä¸è®¿é—®ä¿®é¥°ç¬¦" class="headerlink" title="1.2.2 ç±»ç»§æ‰¿ä½“ç³»ä¸è®¿é—®ä¿®é¥°ç¬¦"></a>1.2.2 ç±»ç»§æ‰¿ä½“ç³»ä¸è®¿é—®ä¿®é¥°ç¬¦</h3><p><strong>è®¿é—®ä¿®é¥°ç¬¦ï¼ˆAccess Modifiersï¼‰</strong></p>
<p>æ§åˆ¶ç±»æˆå‘˜çš„å¯è®¿é—®æ€§ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ä¿®é¥°ç¬¦</th>
<th align="left">ç±»å†…éƒ¨</th>
<th align="left">å­ç±»</th>
<th align="left">ç±»å®ä¾‹</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">public</td>
<td align="left">âœ…</td>
<td align="left">âœ…</td>
<td align="left">âœ…</td>
<td align="left">é»˜è®¤ä¿®é¥°ç¬¦ï¼ˆå¯çœç•¥ï¼‰</td>
</tr>
<tr>
<td align="left">protected</td>
<td align="left">âœ…</td>
<td align="left">âœ…</td>
<td align="left">âŒ</td>
<td align="left">ä»…ç±»å†…éƒ¨å’Œå­ç±»è®¿é—®</td>
</tr>
<tr>
<td align="left">private</td>
<td align="left">âœ…</td>
<td align="left">âŒ</td>
<td align="left">âŒ</td>
<td align="left">ä»…ç±»å†…éƒ¨è®¿é—®</td>
</tr>
<tr>
<td align="left">#field</td>
<td align="left">âœ…</td>
<td align="left">âŒ</td>
<td align="left">âŒ</td>
<td align="left">ES2022 ç§æœ‰å­—æ®µï¼ˆè¿è¡Œæ—¶ç§æœ‰ï¼‰</td>
</tr>
</tbody></table>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>          <span class="token comment">// å…¬å…±å±æ€§ï¼ˆé»˜è®¤ï¼‰</span>
  <span class="token keyword">protected</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>         <span class="token comment">// å—ä¿æŠ¤å±æ€§</span>
  <span class="token keyword">private</span> secret<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>       <span class="token comment">// ç§æœ‰å±æ€§</span>
  #internalCode<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>        <span class="token comment">// ESç§æœ‰å­—æ®µï¼ˆTypeScript 3.8+ï¼‰</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">"P1001"</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>secret <span class="token operator">=</span> <span class="token string">"confidential"</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>#internalCode <span class="token operator">=</span> <span class="token number">12345</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">viewDetails</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// âœ… å…¬å…±å±æ€§</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// âœ… å—ä¿æŠ¤å±æ€§ï¼ˆå­ç±»å¯è®¿é—®ï¼‰</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸš« é”™è¯¯ï¼ç§æœ‰å±æ€§ä¸å¯è®¿é—®</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>#internalCode<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼ESç§æœ‰å­—æ®µä¸å¯è®¿é—®</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> emp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// âœ…</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// ğŸš« é”™è¯¯ï¼å—ä¿æŠ¤å±æ€§</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>emp<span class="token punctuation">.</span>secret<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ğŸš« é”™è¯¯ï¼ç§æœ‰å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»ç»§æ‰¿ä½“ç³»</strong></p>
<p>(1) åŸºæœ¬ç»§æ‰¿è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">&#123;</span>
  <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Moving..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">&#123;</span>
  <span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Woof!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> dog <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dog<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… ç»§æ‰¿è‡ªAnimal</span>
dog<span class="token punctuation">.</span><span class="token function">bark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… è‡ªèº«æ–¹æ³•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>(2) æ„é€ å‡½æ•°ç»§æ‰¿ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Vehicle</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token keyword">extends</span> <span class="token class-name">Vehicle</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">public</span> brand<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»è°ƒç”¨super</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> myCar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token string">"Sedan"</span><span class="token punctuation">,</span> <span class="token string">"Toyota"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCar<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// "Sedan"</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myCar<span class="token punctuation">.</span>brand<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Toyota"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰</strong></p>
<p>è§„åˆ™ï¼š</p>
<ul>
<li>ä½¿ç”¨ override å…³é”®å­—ï¼ˆTS 4.3+ï¼‰</li>
<li>å­ç±»æ–¹æ³•å¿…é¡»å…¼å®¹çˆ¶ç±»æ–¹æ³•ç­¾å</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span>
  <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span>
  override <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨çˆ¶ç±»æ–¹æ³•</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// "Hello!" (è°ƒç”¨çˆ¶ç±»æ–¹æ³•)</span>
d<span class="token punctuation">.</span><span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "Hello, Alice!"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯é‡å†™ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">InvalidDerived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">&#123;</span>
  override <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token comment">// ğŸš« é”™è¯¯ï¼ç¼ºå°‘å¯é€‰å‚æ•°çš„æ— å‚è°ƒç”¨æ–¹å¼</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è®¿é—®å™¨ä¿®é¥°ç¬¦ï¼ˆGetter&#x2F;Setterï¼‰</strong></p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Temperature</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> _celsius <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token comment">// å¸¦è®¿é—®ä¿®é¥°ç¬¦çš„getter/setter</span>
  <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">celsius</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_celsius<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">public</span> <span class="token keyword">set</span> <span class="token function">celsius</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">273.15</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Invalid temperature"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_celsius <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// åªè¯»å±æ€§ï¼ˆæ— setterï¼‰</span>
  <span class="token keyword">public</span> <span class="token keyword">get</span> <span class="token function">fahrenheit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_celsius <span class="token operator">*</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">32</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> temp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Temperature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
temp<span class="token punctuation">.</span>celsius <span class="token operator">=</span> <span class="token number">25</span><span class="token punctuation">;</span>      <span class="token comment">// âœ… è°ƒç”¨setter</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>temp<span class="token punctuation">.</span>fahrenheit<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 77 âœ… è°ƒç”¨getter</span>
temp<span class="token punctuation">.</span>fahrenheit <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>  <span class="token comment">// ğŸš« é”™è¯¯ï¼æ— setter</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é™æ€æˆå‘˜ï¼ˆStatic Membersï¼‰</strong></p>
<p>ç‰¹æ€§ï¼š</p>
<ol>
<li>é€šè¿‡ç±»åç›´æ¥è®¿é—®</li>
<li>ä¸å¯é€šè¿‡å®ä¾‹è®¿é—®</li>
<li>å¯ç»§æ‰¿</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Database</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> instance<span class="token operator">:</span> Database<span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Database <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Database<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      Database<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> Database<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">public</span> <span class="token keyword">static</span> version <span class="token operator">=</span> <span class="token string">"1.0"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// è®¿é—®é™æ€æˆå‘˜</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> Database<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Database<span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "1.0"</span>

<span class="token keyword">class</span> <span class="token class-name">MyDB</span> <span class="token keyword">extends</span> <span class="token class-name">Database</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> <span class="token function">logVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"DB Version:"</span><span class="token punctuation">,</span> <span class="token keyword">super</span><span class="token punctuation">.</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¿é—®çˆ¶ç±»é™æ€å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

MyDB<span class="token punctuation">.</span><span class="token function">logVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "DB Version: 1.0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>æœ€å°åŒ–å…¬å¼€æ¥å£ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">SafeContainer</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> internalData<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token keyword">public</span> <span class="token function">addItem</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>internalData<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">private</span> <span class="token function">validate</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ä½¿ç”¨protectedæ‰©å±•ç‚¹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">PluginBase</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">protected</span> <span class="token function">coreLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">PluginBase</span> <span class="token punctuation">&#123;</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">coreLogic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å­ç±»å¯è®¿é—®</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é¿å…è¿‡åº¦ç»§æ‰¿ï¼ˆç»„åˆä¼˜äºç»§æ‰¿ï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨ç»„åˆæ›¿ä»£æ·±å±‚ç»§æ‰¿</span>
<span class="token keyword">class</span> <span class="token class-name">Engine</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name">Wheels</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> engine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Engine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> wheels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Wheels</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-2-3-æŠ½è±¡ç±»ä¸æ¥å£å®ç°è§„èŒƒ"><a href="#1-2-3-æŠ½è±¡ç±»ä¸æ¥å£å®ç°è§„èŒƒ" class="headerlink" title="1.2.3 æŠ½è±¡ç±»ä¸æ¥å£å®ç°è§„èŒƒ"></a>1.2.3 æŠ½è±¡ç±»ä¸æ¥å£å®ç°è§„èŒƒ</h3><p><strong>æŠ½è±¡ç±»ï¼ˆAbstract Classesï¼‰</strong></p>
<p>æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–</li>
<li>åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ˆæ— å®ç°ï¼‰</li>
<li>å¯åŒ…å«å…·ä½“å®ç°æ–¹æ³•</li>
<li>é€šè¿‡ extends ç»§æ‰¿</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æŠ½è±¡å±æ€§ï¼ˆå¿…é¡»è¢«å­ç±»å®ç°ï¼‰</span>
  <span class="token keyword">abstract</span> habitat<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token comment">// æŠ½è±¡æ–¹æ³•ï¼ˆæ— å®ç°ï¼‰</span>
  <span class="token keyword">abstract</span> <span class="token function">makeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  
  <span class="token comment">// å…·ä½“æ–¹æ³•</span>
  <span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Moving..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Bird</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">&#123;</span>
  habitat <span class="token operator">=</span> <span class="token string">"sky"</span><span class="token punctuation">;</span>  <span class="token comment">// å®ç°æŠ½è±¡å±æ€§</span>
  
  <span class="token comment">// å®ç°æŠ½è±¡æ–¹æ³•</span>
  <span class="token function">makeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Chirp!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token comment">// æ‰©å±•æ–°æ–¹æ³•</span>
  <span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Flying"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> bird <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Bird</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bird<span class="token punctuation">.</span><span class="token function">makeSound</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Chirp!"</span>
bird<span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// "Moving..."</span>
bird<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// "Flying"</span>

<span class="token keyword">const</span> animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¥å£å®ç°ï¼ˆInterface Implementationï¼‰</strong></p>
<p>æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>ä½¿ç”¨ implements å…³é”®å­—</li>
<li>å¿…é¡»å®ç°æ‰€æœ‰æ¥å£æˆå‘˜</li>
<li>ç±»å¯åŒæ—¶å®ç°å¤šä¸ªæ¥å£</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Loggable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å®ç°å¤šä¸ªæ¥å£</span>
<span class="token keyword">class</span> <span class="token class-name">Logger</span> <span class="token keyword">implements</span> <span class="token class-name">Loggable</span><span class="token punctuation">,</span> Serializable <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[LOG] </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>message<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æŠ½è±¡ç±» vs æ¥å£</strong></p>
<p>| ç‰¹æ€§ | æŠ½è±¡ç±» | æ¥å£ |<br>| å®ä¾‹åŒ– | âŒ ä¸èƒ½ç›´æ¥å®ä¾‹åŒ– | âŒ ä¸èƒ½å®ä¾‹åŒ– |<br>| æ–¹æ³•å®ç° | âœ… å¯åŒ…å«å…·ä½“å®ç°æ–¹æ³• | âŒ åªèƒ½å£°æ˜æ–¹æ³•ç­¾å |<br>| æˆå‘˜ç±»å‹ | å¯åŒ…å«å­—æ®µ&#x2F;æ„é€ å™¨&#x2F;è®¿é—®å™¨ç­‰ | åªèƒ½åŒ…å«æ–¹æ³•å’ŒæŠ½è±¡å±æ€§ |<br>| ç»§æ‰¿æœºåˆ¶ | å•ç»§æ‰¿ï¼ˆextendsï¼‰ | å¤šå®ç°ï¼ˆimplementsï¼‰ |<br>| è®¿é—®ä¿®é¥°ç¬¦ | âœ… æ”¯æŒ | âŒ æ‰€æœ‰æˆå‘˜é»˜è®¤ä¸º public |<br>| ç‰ˆæœ¬å…¼å®¹ | ä¿®æ”¹å¯èƒ½ç ´åå­ç±» | æ–°å¢æˆå‘˜ä¸å½±å“ç°æœ‰å®ç° |</p>
<p><strong>æ··åˆä½¿ç”¨æ¨¡å¼</strong></p>
<p>åœºæ™¯ï¼šæŠ½è±¡ç±»å®ç°éƒ¨åˆ†æ¥å£</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Shape</span> <span class="token punctuation">&#123;</span>
  <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token function">perimeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Polygon</span> <span class="token keyword">implements</span> <span class="token class-name">Shape</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// å®ç°éƒ¨åˆ†æ¥å£æ–¹æ³•</span>
  <span class="token keyword">abstract</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>  <span class="token comment">// ä»éœ€å­ç±»å®ç°</span>
  
  <span class="token comment">// æä¾›é»˜è®¤å®ç°</span>
  <span class="token function">perimeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSides</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>sum<span class="token punctuation">,</span> side<span class="token punctuation">)</span> <span class="token operator">=></span> sum <span class="token operator">+</span> side<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token comment">// æŠ½è±¡æ–¹æ³•ï¼ˆéæ¥å£è¦æ±‚ï¼‰</span>
  <span class="token keyword">abstract</span> <span class="token function">getSides</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token keyword">extends</span> <span class="token class-name">Polygon</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> width<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token keyword">private</span> height<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">area</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">getSides</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>width<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å®ç°è§„èŒƒä¸æœ€ä½³å®è·µ</strong></p>
<ol>
<li>æ¥å£éš”ç¦»åŸåˆ™ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ‹†åˆ†å¤§æ¥å£</span>
<span class="token keyword">interface</span> <span class="token class-name">Printer</span> <span class="token punctuation">&#123;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>document<span class="token operator">:</span> Document<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">Scanner</span> <span class="token punctuation">&#123;</span>
  <span class="token function">scan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Document<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">AllInOnePrinter</span> <span class="token keyword">implements</span> <span class="token class-name">Printer</span><span class="token punctuation">,</span> Scanner <span class="token punctuation">&#123;</span>
  <span class="token comment">// åˆ†åˆ«å®ç°å°æ¥å£</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æŠ½è±¡ç±»ä½œä¸ºæ¨¡æ¿ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">DataProcessor</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æ¨¡æ¿æ–¹æ³•ï¼ˆå›ºå®šæµç¨‹ï¼‰</span>
  <span class="token function">process</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cleaned <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clean</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>cleaned<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token function">clean</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token function">transform</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
  
  <span class="token keyword">private</span> <span class="token function">validate</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Invalid data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ¥å£æ‰©å±•æŠ½è±¡ç±»ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">abstract</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">Stateful</span> <span class="token punctuation">&#123;</span>
  <span class="token function">setState</span><span class="token punctuation">(</span>state<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Button</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token keyword">implements</span> <span class="token class-name">Stateful</span> <span class="token punctuation">&#123;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
  <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>é¿å…ç©ºå®ç°ï¼ˆè¿åæ¥å£å¥‘çº¦ï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åæ¨¡å¼ï¼šç©ºå®ç°</span>
<span class="token keyword">class</span> <span class="token class-name">EmptyLogger</span> <span class="token keyword">implements</span> <span class="token class-name">Loggable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// ğŸš« è¿åæ¥å£è¯­ä¹‰</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ­£ç¡®ï¼šæŠ›å‡ºæ˜ç¡®é”™è¯¯</span>
<span class="token keyword">class</span> <span class="token class-name">NotImplementedLogger</span> <span class="token keyword">implements</span> <span class="token class-name">Loggable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Method not implemented"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹æ£€æŸ¥è¦ç‚¹</strong></p>
<ol>
<li>å®ç°å…¼å®¹æ€§ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">&#123;</span>
  currentTime<span class="token operator">:</span> Date<span class="token punctuation">;</span>
  <span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">&#123;</span>
  currentTime<span class="token operator">:</span> Date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// âœ… å‚æ•°ç±»å‹å…¼å®¹ï¼ˆDate â†’ Dateï¼‰</span>
  <span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token operator">:</span> Date<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>currentTime <span class="token operator">=</span> d<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¯é€‰æ¥å£æˆå‘˜ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  required<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  optional<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// å¯é€‰å±æ€§</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token keyword">implements</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  required <span class="token operator">=</span> <span class="token string">"default"</span><span class="token punctuation">;</span>
  <span class="token comment">// æ— éœ€å®ç° optional</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>åªè¯»æ¥å£å±æ€§ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ImmutablePoint</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">readonly</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token keyword">implements</span> <span class="token class-name">ImmutablePoint</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> <span class="token keyword">readonly</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token keyword">readonly</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-2-4-ç±»é™æ€æˆå‘˜ä¸æ„é€ ç­¾å"><a href="#1-2-4-ç±»é™æ€æˆå‘˜ä¸æ„é€ ç­¾å" class="headerlink" title="1.2.4 ç±»é™æ€æˆå‘˜ä¸æ„é€ ç­¾å"></a>1.2.4 ç±»é™æ€æˆå‘˜ä¸æ„é€ ç­¾å</h3><p><strong>é™æ€æˆå‘˜ï¼ˆStatic Membersï¼‰</strong></p>
<p>æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>ä½¿ç”¨ static å…³é”®å­—å£°æ˜</li>
<li>é€šè¿‡ç±»åç›´æ¥è®¿é—®ï¼ˆè€Œéå®ä¾‹ï¼‰</li>
<li>ä¸å¯è®¿é—®å®ä¾‹æˆå‘˜</li>
<li>å¯ç»§æ‰¿ï¼ˆå­ç±»å¯é€šè¿‡ super æˆ–ç±»åè®¿é—®ï¼‰</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">MathUtils</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// é™æ€å±æ€§</span>
  <span class="token keyword">static</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14159</span><span class="token punctuation">;</span>
  
  <span class="token comment">// é™æ€æ–¹æ³•</span>
  <span class="token keyword">static</span> <span class="token function">calculateCircleArea</span><span class="token punctuation">(</span>radius<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span> <span class="token comment">// æ³¨æ„ï¼šthisæŒ‡å‘ç±»æœ¬èº«</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token comment">// é”™è¯¯ç¤ºä¾‹ï¼šè®¿é—®å®ä¾‹æˆå‘˜</span>
  <span class="token keyword">static</span> <span class="token function">invalidMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼æ— æ³•è®¿é—®å®ä¾‹å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// è®¿é—®é™æ€æˆå‘˜</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>MathUtils<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3.14159</span>
<span class="token keyword">const</span> area <span class="token operator">=</span> MathUtils<span class="token punctuation">.</span><span class="token function">calculateCircleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 78.53975</span>

<span class="token keyword">class</span> <span class="token class-name">AdvancedMath</span> <span class="token keyword">extends</span> <span class="token class-name">MathUtils</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> <span class="token function">logPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"PI value:"</span><span class="token punctuation">,</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡superè®¿é—®</span>
    <span class="token comment">// æˆ– console.log(MathUtils.PI);</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é™æ€å—ï¼ˆStatic Blocksï¼‰</strong></p>
<p>TS 4.4+ ç‰¹æ€§ï¼šç”¨äºåˆå§‹åŒ–å¤æ‚é™æ€å±æ€§</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">ConfigLoader</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> config<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>
  
  <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// æ‰§è¡Œå¤æ‚åˆå§‹åŒ–</span>
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"config.json"</span><span class="token punctuation">,</span> <span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">"value"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ„é€ ç­¾åï¼ˆConstructor Signaturesï¼‰</strong></p>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šæè¿°ç±»çš„æ„é€ å‡½æ•°ç±»å‹</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ„é€ ç­¾åè¡¨ç¤ºæ³•</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> minute<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> ClockInterface<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">&#123;</span>
  <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å®ç°æ„é€ ç­¾å</span>
<span class="token keyword">class</span> <span class="token class-name">DigitalClock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>h<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> m<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// å®ç°æ„é€ å‡½æ•°</span>
  <span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"beep beep"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å·¥å‚å‡½æ•°ä½¿ç”¨æ„é€ ç­¾å</span>
<span class="token keyword">function</span> <span class="token function">createClock</span><span class="token punctuation">(</span>
  ctor<span class="token operator">:</span> ClockConstructor<span class="token punctuation">,</span>
  hour<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  minute<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ClockInterface <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span>hour<span class="token punctuation">,</span> minute<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> digital <span class="token operator">=</span> <span class="token function">createClock</span><span class="token punctuation">(</span>DigitalClock<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
digital<span class="token punctuation">.</span><span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "beep beep"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é™æ€æˆå‘˜ä¸æ„é€ ç­¾åå®æˆ˜</strong></p>
<p>åœºæ™¯1ï¼šå•ä¾‹æ¨¡å¼</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> instance<span class="token operator">:</span> AppConfig<span class="token punctuation">;</span>
  
  <span class="token comment">// ç§æœ‰æ„é€ å™¨é˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–</span>
  <span class="token keyword">private</span> <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> env<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  
  <span class="token comment">// é™æ€è®¿é—®ç‚¹</span>
  <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AppConfig <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>AppConfig<span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      AppConfig<span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppConfig</span><span class="token punctuation">(</span><span class="token string">"production"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> AppConfig<span class="token punctuation">.</span>instance<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> AppConfig<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "production"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šç±»æ³¨å†Œç³»ç»Ÿ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ„é€ ç­¾åå®šä¹‰</span>
<span class="token keyword">interface</span> <span class="token class-name">PluginConstructor</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Plugin<span class="token punctuation">;</span>
  pluginName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// é™æ€å±æ€§è¦æ±‚</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Plugin</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">abstract</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ³¨å†Œè¡¨</span>
<span class="token keyword">class</span> <span class="token class-name">PluginRegistry</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> plugins<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> PluginConstructor<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
  <span class="token keyword">static</span> <span class="token function">register</span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> PluginConstructor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>plugins<span class="token punctuation">[</span>ctor<span class="token punctuation">.</span>pluginName<span class="token punctuation">]</span> <span class="token operator">=</span> ctor<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">static</span> <span class="token function">create</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Plugin <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> Ctor <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plugins<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Ctor <span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">Ctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ’ä»¶å®ç°</span>
<span class="token keyword">class</span> <span class="token class-name">LoggerPlugin</span> <span class="token keyword">implements</span> <span class="token class-name">Plugin</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> pluginName <span class="token operator">=</span> <span class="token string">"Logger"</span><span class="token punctuation">;</span> <span class="token comment">// æ»¡è¶³é™æ€å±æ€§è¦æ±‚</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Logging..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ³¨å†Œå¹¶ä½¿ç”¨</span>
PluginRegistry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>LoggerPlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> plugin <span class="token operator">=</span> PluginRegistry<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"Logger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plugin<span class="token operator">?.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "Logging..."</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§æ„é€ ç­¾åæ¨¡å¼</strong></p>
<ol>
<li>æ³›å‹æ„é€ ç­¾å</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Factory<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createInstance</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>Clazz<span class="token operator">:</span> Factory<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Clazz</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>Product<span class="token punctuation">,</span> <span class="token string">"P1001"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "P1001"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ„é€ å‡½æ•°ç±»å‹åˆ«å</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ„é€ å‡½æ•°ç±»å‹å®šä¹‰</span>
<span class="token keyword">type</span> <span class="token class-name">StringInitializable</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> object<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">StringWrapper</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">wrapString</span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> StringInitializable<span class="token punctuation">,</span> s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> wrapped <span class="token operator">=</span> <span class="token function">wrapString</span><span class="token punctuation">(</span>StringWrapper<span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>wrapped <span class="token keyword">as</span> StringWrapper<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "test"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>é¿å…è¿‡åº¦ä½¿ç”¨é™æ€æˆå‘˜ï¼šé™æ€æˆå‘˜æœ¬è´¨æ˜¯å…¨å±€çŠ¶æ€ï¼Œä¸åˆ©äºæµ‹è¯•å’Œæ‰©å±•</li>
<li>æ„é€ ç­¾åç”¨äºä¾èµ–æ³¨å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¾èµ–æ³¨å…¥å®¹å™¨</span>
<span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> instances <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token generic-function"><span class="token function">register</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> ctor<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>instances<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token generic-function"><span class="token function">resolve</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
container<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"logger"</span><span class="token punctuation">,</span> ConsoleLogger<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">resolve</span><span class="token generic class-name"><span class="token operator">&lt;</span>ConsoleLogger<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">"logger"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é™æ€æˆå‘˜ç±»å‹å®‰å…¨ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Validator</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> patterns <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    email<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[^\s@]+@[^\s@]+\.[^\s@]+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
    phone<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\d&#123;10&#125;$</span><span class="token regex-delimiter">/</span></span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
  <span class="token keyword">static</span> <span class="token function">validate</span><span class="token punctuation">(</span>type<span class="token operator">:</span> <span class="token keyword">keyof</span> <span class="token keyword">typeof</span> Validator<span class="token punctuation">.</span>patterns<span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>patterns<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

Validator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">,</span> <span class="token string">"test@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
Validator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span><span class="token string">"postal"</span><span class="token punctuation">,</span> <span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼æ— æ­¤ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æ„é€ ç­¾åçº¦æŸï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚æ„é€ å‡½æ•°å…·æœ‰ç‰¹å®šé™æ€å±æ€§</span>
<span class="token keyword">interface</span> <span class="token class-name">PluginCtor</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Plugin<span class="token punctuation">;</span>
  version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  dependencies<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">loadPlugin</span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> PluginCtor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Loading </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>ctor<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> v</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>ctor<span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="1-3-å‡½æ•°ä¸æ³›å‹ç¼–ç¨‹"><a href="#1-3-å‡½æ•°ä¸æ³›å‹ç¼–ç¨‹" class="headerlink" title="1.3 å‡½æ•°ä¸æ³›å‹ç¼–ç¨‹"></a>1.3 å‡½æ•°ä¸æ³›å‹ç¼–ç¨‹</h2><h3 id="1-3-1-å‡½æ•°ç±»å‹å®šä¹‰ä¸ä¸Šä¸‹æ–‡æ¨æ–­"><a href="#1-3-1-å‡½æ•°ç±»å‹å®šä¹‰ä¸ä¸Šä¸‹æ–‡æ¨æ–­" class="headerlink" title="1.3.1 å‡½æ•°ç±»å‹å®šä¹‰ä¸ä¸Šä¸‹æ–‡æ¨æ–­"></a>1.3.1 å‡½æ•°ç±»å‹å®šä¹‰ä¸ä¸Šä¸‹æ–‡æ¨æ–­</h3><p><strong>å‡½æ•°ç±»å‹å®šä¹‰æ–¹å¼</strong></p>
<ol>
<li>å‡½æ•°å£°æ˜å¼</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®Œæ•´ç±»å‹æ³¨è§£</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å‡½æ•°è¡¨è¾¾å¼</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å˜é‡ç±»å‹æ³¨è§£</span>
<span class="token keyword">const</span> <span class="token function-variable function">multiply</span><span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function-variable function">number</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> y<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç®­å¤´å‡½æ•°</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç±»å‹æ³¨è§£åœ¨å˜é‡ä¸Š</span>
<span class="token keyword">const</span> <span class="token function-variable function">divide</span><span class="token operator">:</span> <span class="token punctuation">(</span>dividend<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> divisor<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function-variable function">number</span> <span class="token operator">=</span> 
  <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">/</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>å¯¹è±¡æ–¹æ³•</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> calculator <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  sum<span class="token operator">:</span> <span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=></span> x <span class="token operator">+</span> y<span class="token punctuation">,</span>
  <span class="token function">subtract</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> x <span class="token operator">-</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å‡½æ•°ç±»å‹ç­¾åè¯¦è§£</strong></p>
<p>åŸºæœ¬ç»“æ„ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">AddFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">number</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯é€‰å‚æ•°ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">GreetFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> prefix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> greet<span class="token operator">:</span> <span class="token function-variable function">GreetFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>p <span class="token operator">||</span> <span class="token string">"Hello"</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>n<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å…è®¸çœç•¥å¯é€‰å‚æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>é»˜è®¤å‚æ•°ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">CreateUser</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> 
  role<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">"user"</span> <span class="token comment">// é»˜è®¤å€¼</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‰©ä½™å‚æ•°ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">SumFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>numbers<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">number</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> sum<span class="token operator">:</span> <span class="token function-variable function">SumFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>nums<span class="token punctuation">)</span> <span class="token operator">=></span> nums<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¸Šä¸‹æ–‡ç±»å‹æ¨æ–­ï¼ˆContextual Typingï¼‰</strong></p>
<p>æ ¸å¿ƒåŸç†ï¼šTypeScript æ ¹æ®å‡½æ•°è¢«ä½¿ç”¨çš„ä½ç½®è‡ªåŠ¨æ¨æ–­å‚æ•°ç±»å‹</p>
<p>å…¸å‹åœºæ™¯ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åœºæ™¯1ï¼šå›è°ƒå‡½æ•°å‚æ•°æ¨æ–­</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>num <span class="token operator">=></span> num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// num æ¨æ–­ä¸º number</span>

<span class="token comment">// åœºæ™¯2ï¼šäº‹ä»¶å¤„ç†å‡½æ•°</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> event <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// event æ¨æ–­ä¸º MouseEvent</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åœºæ™¯3ï¼šå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</span>
<span class="token keyword">function</span> <span class="token function">runCallback</span><span class="token punctuation">(</span><span class="token function-variable function">cb</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">cb</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">runCallback</span><span class="token punctuation">(</span>str <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// str æ¨æ–­ä¸º string</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ˜¾å¼è¦†ç›–ä¸Šä¸‹æ–‡ç±»å‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨ç±»å‹æ–­è¨€è¦†ç›–æ¨æ–­</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"keydown"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event <span class="token keyword">as</span> KeyboardEvent<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¼ºåˆ¶æŒ‡å®šä¸º KeyboardEvent</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å‡½æ•°ç±»å‹å…¼å®¹æ€§</strong></p>
<p>å‚æ•°å…¼å®¹è§„åˆ™ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// âœ… å…¼å®¹ï¼šå‚æ•°ç±»å‹æ›´å…·ä½“</span>
<span class="token keyword">const</span> h1<span class="token operator">:</span> <span class="token function-variable function">Handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// âœ… å…¼å®¹ï¼šå‚æ•°æ•°é‡æ›´å°‘</span>
<span class="token keyword">const</span> h2<span class="token operator">:</span> <span class="token function-variable function">Handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">// ğŸš« ä¸å…¼å®¹ï¼šå‚æ•°ç±»å‹å†²çª</span>
<span class="token keyword">const</span> h3<span class="token operator">:</span> <span class="token function-variable function">Handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// é”™è¯¯ï¼</span>

<span class="token comment">// è¿”å›å€¼å…¼å®¹è§„åˆ™</span>
<span class="token keyword">type</span> <span class="token class-name">Factory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token comment">// âœ… å…¼å®¹ï¼šè¿”å›å€¼æ›´å…·ä½“</span>
<span class="token keyword">const</span> f1<span class="token operator">:</span> <span class="token function-variable function">Factory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
<span class="token comment">// ğŸš« ä¸å…¼å®¹ï¼šè¿”å›å€¼ç±»å‹å†²çª</span>
<span class="token keyword">const</span> f2<span class="token operator">:</span> <span class="token function-variable function">Factory</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">123</span><span class="token punctuation">;</span> <span class="token comment">// é”™è¯¯ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹è±¡æ–¹æ³•å…¼å®¹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Component</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">onEvent</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// âœ… å…¼å®¹ï¼šå‚æ•°æ•°é‡æ›´å°‘</span>
<span class="token keyword">const</span> comp<span class="token operator">:</span> Component <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">onEvent</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Event fired"</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>void è¿”å›ç±»å‹çš„ç‰¹æ®Šè¡Œä¸º</strong></p>
<p>å…³é”®ç‰¹æ€§ï¼šå…è®¸è¿”å›ä»»æ„å€¼ï¼ˆä½†è¿”å›å€¼ä¼šè¢«å¿½ç•¥ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">VoidFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// åˆæ³•å®ç°ï¼ˆè™½ç„¶è¿”å›äº†å€¼ï¼‰</span>
<span class="token keyword">const</span> fn<span class="token operator">:</span> <span class="token function-variable function">VoidFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"hello"</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨åœºæ™¯</span>
<span class="token keyword">const</span> strings <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> results<span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>s <span class="token operator">=></span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…è®¸è¿”å›void</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸undefinedçš„åŒºåˆ«ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¿…é¡»æ˜¾å¼è¿”å›undefined</span>
<span class="token keyword">type</span> <span class="token class-name">StrictVoid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> strictFn<span class="token operator">:</span> <span class="token function-variable function">StrictVoid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
<span class="token keyword">const</span> invalidFn<span class="token operator">:</span> <span class="token function-variable function">StrictVoid</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"test"</span><span class="token punctuation">;</span>   <span class="token comment">// ğŸš« é”™è¯¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨ä¸Šä¸‹æ–‡æ¨æ–­ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨èï¼šè®©TSè‡ªåŠ¨æ¨æ–­</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>num <span class="token operator">=></span> num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸æ¨èï¼šå†—ä½™æ³¨è§£</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=></span> num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å›è°ƒå‡½æ•°å‚æ•°å‘½åçº¦å®šï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨æè¿°æ€§å‚æ•°åå¢å¼ºå¯è¯»æ€§</span>
<span class="token function">fetchUser</span><span class="token punctuation">(</span>userId <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¯” `id` æ›´æ˜ç¡®</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é¿å…anyæ±¡æŸ“å‡½æ•°é“¾ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å±é™©ï¼šanyç±»å‹ä¼ æ’­</span>
<span class="token keyword">const</span> <span class="token function-variable function">dangerous</span><span class="token operator">:</span> <span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function-variable function">number</span> <span class="token operator">=</span> input <span class="token operator">=></span> input<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

<span class="token comment">// å®‰å…¨ï¼šæ˜ç¡®ç±»å‹çº¦æŸ</span>
<span class="token keyword">const</span> <span class="token function-variable function">safe</span><span class="token operator">:</span> <span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function-variable function">number</span> <span class="token operator">=</span> input <span class="token operator">=></span> input<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>å‡½æ•°é‡è½½ä¼˜å…ˆäºè”åˆå‚æ•°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸æ¨èï¼šè”åˆç±»å‹å‚æ•°</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/*...*/</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ¨èï¼šå‡½æ•°é‡è½½ï¼ˆä¸‹ä¸€èŠ‚å†…å®¹ï¼‰</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">/*...*/</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å‡½æ•°ç±»å‹é«˜çº§æŠ€å·§</strong></p>
<p>å‡½æ•°å±æ€§æ‰©å±•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">SearchFunction</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">(</span>source<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> subString<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">// é™„åŠ å±æ€§</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> mySearch<span class="token operator">:</span> <span class="token function-variable function">SearchFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">,</span> sub<span class="token punctuation">)</span> <span class="token operator">=></span> src<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
mySearch<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">"String search function"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„é€ ç­¾åå‡½æ•°ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ClockConstructor</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> minute<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> ClockInterface<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">createClock</span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> ClockConstructor<span class="token punctuation">,</span> h<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> m<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-3-2-å‡½æ•°é‡è½½çš„å·¥ç¨‹å®è·µ"><a href="#1-3-2-å‡½æ•°é‡è½½çš„å·¥ç¨‹å®è·µ" class="headerlink" title="1.3.2 å‡½æ•°é‡è½½çš„å·¥ç¨‹å®è·µ"></a>1.3.2 å‡½æ•°é‡è½½çš„å·¥ç¨‹å®è·µ</h3><p><strong>å‡½æ•°é‡è½½åŸºç¡€æ¦‚å¿µ</strong></p>
<p>æ ¸å¿ƒç›®çš„ï¼šä¸ºåŒä¸€å‡½æ•°æä¾›å¤šä¸ªç±»å‹ç­¾åï¼Œå¤„ç†ä¸åŒå‚æ•°ç»„åˆæˆ–è¿”å›ç±»å‹</p>
<p>åŸºæœ¬ç»“æ„ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é‡è½½ç­¾åï¼ˆç±»å‹å£°æ˜ï¼‰</span>
<span class="token keyword">function</span> <span class="token function">parseInput</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">parseInput</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token comment">// å®ç°ç­¾åï¼ˆå®é™…å‡½æ•°ä½“ï¼‰</span>
<span class="token keyword">function</span> <span class="token function">parseInput</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> input <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å› number</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> input<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å› string</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">parseInput</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">parseInput</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é‡è½½è§„åˆ™ä¸ç‰¹æ€§</strong></p>
<ol>
<li>ä¼˜å…ˆçº§è§„åˆ™ï¼š<ul>
<li>ä»ä¸Šåˆ°ä¸‹åŒ¹é…ç¬¬ä¸€ä¸ªç¬¦åˆçš„é‡è½½ç­¾å</li>
<li>å®ç°ç­¾åä¸å¯ç›´æ¥è°ƒç”¨ï¼ˆå¯¹å¤–ä¸å¯è§ï¼‰</li>
</ul>
</li>
<li>å‚æ•°ç±»å‹å…¼å®¹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ­£ç¡®ï¼šå®ç°ç­¾åå¿…é¡»å…¼å®¹æ‰€æœ‰é‡è½½</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>    <span class="token comment">// âœ…</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// âœ…</span>

<span class="token comment">// é”™è¯¯ï¼šå®ç°ç­¾åä¸å…¼å®¹é‡è½½</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>    <span class="token comment">// ğŸš«</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  <span class="token comment">// é”™è¯¯ï¼šç¼ºå°‘numberå‚æ•°å¤„ç†</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è¿”å›å€¼ç±»å‹çº¦æŸï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¿”å›å€¼å¿…é¡»è¦†ç›–æ‰€æœ‰é‡è½½</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span>format<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> format <span class="token operator">?</span> <span class="token number">123</span> <span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µæ¨¡å¼</strong></p>
<p>æ¨¡å¼1ï¼šå‚æ•°ç±»å‹è½¬æ¢</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å­—ç¬¦ä¸²å’Œæ—¥æœŸäº’è½¬</span>
<span class="token keyword">function</span> <span class="token function">convert</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Date<span class="token punctuation">;</span>       <span class="token comment">// string â†’ Date</span>
<span class="token keyword">function</span> <span class="token function">convert</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>       <span class="token comment">// Date â†’ string</span>
<span class="token keyword">function</span> <span class="token function">convert</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> Date <span class="token operator">|</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> date <span class="token operator">=</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">"2023-01-01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Date</span>
<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å¼2ï¼šé…ç½®å¯¹è±¡é‡è½½</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç®€å•æ¨¡å¼</span>
<span class="token keyword">interface</span> <span class="token class-name">SimpleConfig</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// é«˜çº§æ¨¡å¼</span>
<span class="token keyword">interface</span> <span class="token class-name">AdvancedConfig</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  debug<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  retries<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token operator">:</span> SimpleConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token operator">:</span> AdvancedConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token operator">:</span> SimpleConfig <span class="token operator">|</span> AdvancedConfig<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// å…¬å…±åˆå§‹åŒ–é€»è¾‘</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Initializing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>config<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// ç±»å‹å®ˆå«å¤„ç†é«˜çº§é…ç½®</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">"debug"</span> <span class="token keyword">in</span> config<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Debug mode:"</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>debug<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å¼3ï¼šDOM æ“ä½œé‡è½½</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">getElement</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getElement</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> HTMLElement<span class="token operator">></span></span></span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> type<span class="token operator">:</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getElement</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> type<span class="token operator">?</span><span class="token operator">:</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> HTMLElement<span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>el <span class="token operator">&amp;&amp;</span> type <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>el <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token keyword">type</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Element type mismatch</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> el<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">"header"</span><span class="token punctuation">,</span> HTMLDivElement<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTMLDivElement | null</span>
<span class="token keyword">const</span> generic <span class="token operator">=</span> <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// HTMLElement | null</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è”åˆç±»å‹ vs å‡½æ•°é‡è½½</strong></p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">æ¨èæ–¹æ¡ˆ</th>
<th align="left">åŸå› </th>
</tr>
</thead>
<tbody><tr>
<td align="left">å‚æ•°ç±»å‹å†³å®šè¿”å›å€¼ç±»å‹</td>
<td align="left">å‡½æ•°é‡è½½</td>
<td align="left">æä¾›ç²¾ç¡®çš„è¿”å›ç±»å‹</td>
</tr>
<tr>
<td align="left">å‚æ•°æ•°é‡å˜åŒ–</td>
<td align="left">å‡½æ•°é‡è½½</td>
<td align="left">æ˜ç¡®ä¸åŒå‚æ•°ç»„åˆ</td>
</tr>
<tr>
<td align="left">å‚æ•°ç±»å‹ç›¸åŒä½†å¤„ç†é€»è¾‘ä¸åŒ</td>
<td align="left">è”åˆç±»å‹ + ç±»å‹å®ˆå«</td>
<td align="left">é¿å…é‡è½½ç­¾åè†¨èƒ€</td>
</tr>
<tr>
<td align="left">å¤æ‚é…ç½®å¯¹è±¡</td>
<td align="left">å‡½æ•°é‡è½½</td>
<td align="left">åŒºåˆ†ä¸åŒé…ç½®ç»“æ„</td>
</tr>
<tr>
<td align="left">ç®€å•ç±»å‹å˜æ¢</td>
<td align="left">è”åˆç±»å‹</td>
<td align="left">å‡å°‘æ ·æ¿ä»£ç </td>
</tr>
</tbody></table>
<p>è”åˆç±»å‹ç¤ºä¾‹ï¼ˆé€‚åˆç®€å•åœºæ™¯ï¼‰ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨è”åˆç±»å‹æ›¿ä»£é‡è½½</span>
<span class="token keyword">function</span> <span class="token function">padLeft</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> padding<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> padding <span class="token operator">===</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token string">" "</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>padding<span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> padding <span class="token operator">+</span> value<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>æ§åˆ¶é‡è½½æ•°é‡ï¼š<ul>
<li>å»ºè®®ä¸è¶…è¿‡ 5 ä¸ªé‡è½½ç­¾å</li>
<li>è¿‡å¤šé‡è½½ä¼šå¯¼è‡´ç±»å‹ç³»ç»Ÿè´Ÿæ‹…å¢åŠ </li>
</ul>
</li>
<li>å…¬å…±å‰ç½®å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> ResultA<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> Buffer<span class="token punctuation">)</span><span class="token operator">:</span> ResultB<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> Buffer<span class="token punctuation">)</span><span class="token operator">:</span> ResultA <span class="token operator">|</span> ResultB <span class="token punctuation">&#123;</span>
  <span class="token comment">// å…¬å…±éªŒè¯é€»è¾‘</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Empty data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* ç‰¹å®šå¤„ç† */</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/* ç‰¹å®šå¤„ç† */</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ä½¿ç”¨ç±»å‹å‚æ•°å‡å°‘é‡è½½ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨æ³›å‹æ›¿ä»£å¤šä¸ªé‡è½½</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ¯”ä»¥ä¸‹é‡è½½æ›´ç®€æ´ï¼š</span>
<span class="token comment">// function identity(arg: string): string;</span>
<span class="token comment">// function identity(arg: number): number;</span>
<span class="token comment">// ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æ–‡æ¡£æ³¨é‡Šè§„èŒƒï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">/**
 * åˆ›å»ºç”¨æˆ·
 * @param name - ç”¨æˆ·å
 * @returns ç”¨æˆ·ID
 */</span>
<span class="token keyword">function</span> <span class="token function">createUser</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * åˆ›å»ºç”¨æˆ·ï¼ˆå¸¦é…ç½®ï¼‰
 * @param options - ç”¨æˆ·é…ç½®
 * @returns ç”¨æˆ·ID
 */</span>
<span class="token keyword">function</span> <span class="token function">createUser</span><span class="token punctuation">(</span>options<span class="token operator">:</span> UserOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createUser</span><span class="token punctuation">(</span>param<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> UserOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é”™è¯¯1ï¼šå¿½ç•¥å®ç°ç­¾åå…¼å®¹æ€§</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é”™è¯¯å®ç°</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// âœ… æ­£ç¡®</span>

<span class="token comment">// æ­£ç¡®ï¼šæ·»åŠ å¿…è¦çš„å‚æ•°æ£€æŸ¥</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">===</span> <span class="token string">"number"</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Missing second argument"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯2ï¼šè¿”å›å€¼ç±»å‹ä¸å®Œæ•´</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é”™è¯¯ï¼šç¼ºå°‘booleanè¿”å›ç±»å‹</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>flag<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>flag<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span> 
  <span class="token keyword">return</span> flag <span class="token operator">?</span> <span class="token number">123</span> <span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// number âœ…</span>
<span class="token keyword">const</span> result2 <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// string âœ…</span>
<span class="token keyword">const</span> result3 <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼æœªå£°æ˜è¿”å›boolean</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¿®æ­£ï¼šæ·»åŠ å®Œæ•´é‡è½½</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>flag<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>flag<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span>flag<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> flag <span class="token operator">?</span> <span class="token number">123</span> <span class="token operator">:</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§å·¥ç¨‹æ¡ˆä¾‹</strong></p>
<p>API è¯·æ±‚é‡è½½ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç®€å•GETè¯·æ±‚</span>
<span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Response<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// å¸¦å‚æ•°çš„GETè¯·æ±‚</span>
<span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> params<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Response<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// POSTè¯·æ±‚</span>
<span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> method<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span> body<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Response<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// å®ç°</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span>
  url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  paramsOrMethod<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  body<span class="token operator">?</span><span class="token operator">:</span> object
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Response<span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>paramsOrMethod <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> paramsOrMethod <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>paramsOrMethod<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>url<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>query<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span>paramsOrMethod <span class="token operator">===</span> <span class="token string">"POST"</span> <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
      method<span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Invalid arguments"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-3-3-æ³›å‹çº¦æŸä¸é»˜è®¤ç±»å‹"><a href="#1-3-3-æ³›å‹çº¦æŸä¸é»˜è®¤ç±»å‹" class="headerlink" title="1.3.3 æ³›å‹çº¦æŸä¸é»˜è®¤ç±»å‹"></a>1.3.3 æ³›å‹çº¦æŸä¸é»˜è®¤ç±»å‹</h3><p><strong>æ³›å‹çº¦æŸï¼ˆGeneric Constraintsï¼‰</strong></p>
<p>æ ¸å¿ƒç›®çš„ï¼šé™åˆ¶æ³›å‹å‚æ•°å¿…é¡»æ»¡è¶³ç‰¹å®šæ¡ä»¶</p>
<p>åŸºç¡€è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">identity</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ConstraintType<span class="token operator">></span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>åŸºæœ¬çº¦æŸç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Lengthwise</span> <span class="token punctuation">&#123;</span>
  length<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// T å¿…é¡»åŒ…å« length å±æ€§</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">logLength</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Lengthwise<span class="token operator">></span></span></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">logLength</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å­—ç¬¦ä¸²æœ‰ length</span>
<span class="token function">logLength</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… æ•°ç»„æœ‰ length</span>
<span class="token function">logLength</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼æ•°å­—æ²¡æœ‰ length</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¤šçº¦æŸæ¡ä»¶</strong></p>
<p>ä½¿ç”¨ &amp; è¿ç®—ç¬¦ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Printable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">Loggable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// T å¿…é¡»åŒæ—¶æ»¡è¶³ Printable å’Œ Loggable</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">processItem</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Printable <span class="token operator">&amp;</span> Loggable<span class="token operator">></span></span></span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  item<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  item<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Document</span> <span class="token keyword">implements</span> <span class="token class-name">Printable</span><span class="token punctuation">,</span> Loggable <span class="token punctuation">&#123;</span>
  <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Printing document"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
  <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Logging document"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">processItem</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹å‚æ•°çº¦æŸ</strong></p>
<p>çº¦æŸæ³›å‹å‚æ•°ä¹‹é—´çš„å…³ç³»ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¡®ä¿ K æ˜¯ T çš„é”®å</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getProperty</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">getProperty</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span>
<span class="token function">getProperty</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼ä¸å­˜åœ¨è¯¥å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„é€ å‡½æ•°çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚æ³›å‹ T å¿…é¡»å¯æ„é€ </span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createInstance</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> InstanceType <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token function">createInstance</span><span class="token punctuation">(</span>MyClass<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ³›å‹é»˜è®¤ç±»å‹ï¼ˆDefault Typesï¼‰</strong></p>
<p>æ ¸å¿ƒç›®çš„ï¼šä¸ºæ³›å‹å‚æ•°æä¾›é»˜è®¤å€¼ï¼Œç®€åŒ–ä½¿ç”¨</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ApiResponse<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  status<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨é»˜è®¤ç±»å‹</span>
<span class="token keyword">const</span> response<span class="token operator">:</span> ApiResponse <span class="token operator">=</span> <span class="token punctuation">&#123;</span> 
  data<span class="token operator">:</span> <span class="token string">"untyped data"</span><span class="token punctuation">,</span> <span class="token comment">// any ç±»å‹</span>
  status<span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// æ˜¾å¼æŒ‡å®šç±»å‹</span>
<span class="token keyword">const</span> userResponse<span class="token operator">:</span> ApiResponse<span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>çº¦æŸä¸é»˜è®¤ç±»å‹ç»„åˆ</strong></p>
<p>å¤æ‚åœºæ™¯åº”ç”¨ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 1. çº¦æŸ + é»˜è®¤ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">PaginatedResult<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> object<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  items<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 2. å‡½æ•°ä¸­ä½¿ç”¨</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">fetchData</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
  url<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>PaginatedResult<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨é»˜è®¤çº¦æŸ</span>
<span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token string">"/users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise&lt;PaginatedResult&lt;&#123; id: string &#125;>></span>

<span class="token comment">// æŒ‡å®šå…·ä½“ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token generic-function"><span class="token function">fetchData</span><span class="token generic class-name"><span class="token operator">&lt;</span>Product<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">"/products"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise&lt;PaginatedResult&lt;Product>></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µæ¨¡å¼</strong></p>
<p>æ¨¡å¼1ï¼šéƒ¨åˆ†å±æ€§è¦æ±‚</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚å¯¹è±¡è‡³å°‘åŒ…å«ç‰¹å®šå±æ€§</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">updateRecord</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>record<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  db<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>record<span class="token punctuation">.</span>id<span class="token punctuation">,</span> record<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å…è®¸é¢å¤–å±æ€§</span>
<span class="token function">updateRecord</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å¼2ï¼šå·¥å‚å‡½æ•°çº¦æŸ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚ç±»æ„é€ å‡½æ•°</span>
<span class="token keyword">function</span> create<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">new</span></span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">(</span>
  Ctor<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>args<span class="token operator">:</span> ConstructorParameters<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span>
<span class="token punctuation">)</span><span class="token operator">:</span> InstanceType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Ctor</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Widget</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span>Widget<span class="token punctuation">,</span> <span class="token string">"MyWidget"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Widget å®ä¾‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å¼3ï¼šAPI å“åº”æ ‡å‡†åŒ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ApiResponse<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">unknown</span><span class="token punctuation">,</span> <span class="token constant">E</span> <span class="token operator">=</span> Error<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  success<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  data<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  error<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">E</span><span class="token punctuation">;</span>
  timestamp<span class="token operator">:</span> Date<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createResponse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> ApiResponse<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
    success<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    data<span class="token punctuation">,</span>
    timestamp<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> userResponse <span class="token operator">=</span> <span class="token function">createResponse</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ApiResponse&lt;&#123; name: string &#125;></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>é¿å…è¿‡åº¦çº¦æŸï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¿‡åº¦çº¦æŸï¼šé™åˆ¶ä¸ºç‰¹å®šç±»å‹</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">process</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span>

<span class="token comment">// æ¨èï¼šæ›´çµæ´»çš„çº¦æŸ</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">process</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>åˆç†ä½¿ç”¨é»˜è®¤ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸ºå¸¸ç”¨ç±»å‹æä¾›é»˜è®¤å€¼</span>
<span class="token keyword">type</span> <span class="token class-name">Formatter<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> dateFormatter<span class="token operator">:</span> Formatter<span class="token operator">&lt;</span>Date<span class="token operator">></span> <span class="token operator">=</span> date <span class="token operator">=></span> date<span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> defaultFormatter<span class="token operator">:</span> <span class="token function-variable function">Formatter</span> <span class="token operator">=</span> str <span class="token operator">=></span> str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é»˜è®¤ string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>çº¦æŸæ–‡æ¡£åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">/**
 * åˆå¹¶ä¸¤ä¸ªå¯¹è±¡
 * @template T - ç¬¬ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹
 * @template U - ç¬¬äºŒä¸ªå¯¹è±¡çš„ç±»å‹ï¼ˆå¿…é¡»ä¸Tå…¼å®¹ï¼‰
 */</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">merge</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span> <span class="token keyword">extends</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>obj1<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> obj2<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token constant">U</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>obj1<span class="token punctuation">,</span> <span class="token operator">...</span>obj2 <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>ç±»å‹å‚æ•°å‘½åçº¦å®šï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨èï¼šä½¿ç”¨æœ‰æ„ä¹‰çš„ç±»å‹å‚æ•°å</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getValue</span><span class="token generic class-name"><span class="token operator">&lt;</span>TObject<span class="token punctuation">,</span> TKey <span class="token keyword">extends</span> <span class="token keyword">keyof</span> TObject<span class="token operator">></span></span></span><span class="token punctuation">(</span>
  obj<span class="token operator">:</span> TObject<span class="token punctuation">,</span> 
  key<span class="token operator">:</span> TKey
<span class="token punctuation">)</span><span class="token operator">:</span> TObject<span class="token punctuation">[</span>TKey<span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¤æ‚çº¦æŸæ¡ˆä¾‹</strong></p>
<p>é€’å½’çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ‘èŠ‚ç‚¹ç»“æ„çº¦æŸ</span>
<span class="token keyword">interface</span> <span class="token class-name">TreeNode</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  children<span class="token operator">?</span><span class="token operator">:</span> TreeNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">walkTree</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> TreeNode<span class="token operator">></span></span></span><span class="token punctuation">(</span>node<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  node<span class="token punctuation">.</span>children<span class="token operator">?.</span><span class="token function">forEach</span><span class="token punctuation">(</span>child <span class="token operator">=></span> <span class="token function">walkTree</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> tree <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"child1"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"child2"</span><span class="token punctuation">,</span> children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token string">"grandchild"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token function">walkTree</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¡ä»¶ç±»å‹çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¡®ä¿æ³›å‹æ˜¯å‡½æ•°ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ReturnTypeOrNever<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> getReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">(</span>
  fn<span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">)</span><span class="token operator">:</span> ReturnTypeOrNever<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ReturnTypeOrNever<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é”™è¯¯è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é”™è¯¯ï¼šçº¦æŸä¸æ»¡è¶³</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getSize</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> length<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> size<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼šç¼ºå°‘ length å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ–¹æ³•1ï¼šæä¾›æ­£ç¡®ç±»å‹</span>
<span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> length<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ–¹æ³•2ï¼šæ‰©å±•çº¦æŸ</span>
<span class="token keyword">interface</span> <span class="token class-name">Sizeable</span> <span class="token punctuation">&#123;</span>
  length<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  size<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">getSize</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Sizeable<span class="token operator">></span></span></span><span class="token punctuation">(</span>obj<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> obj<span class="token punctuation">.</span>length <span class="token operator">??</span> obj<span class="token punctuation">.</span>size <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é”™è¯¯ï¼šé»˜è®¤ç±»å‹ä¸çº¦æŸå†²çª</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Config<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token builtin">number</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span> <span class="token comment">// ğŸš« é”™è¯¯ï¼é»˜è®¤ç±»å‹å¿…é¡»æ»¡è¶³çº¦æŸ</span>
  value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// çº¦æŸå’Œé»˜è®¤ç±»å‹éœ€å…¼å®¹</span>
<span class="token keyword">interface</span> <span class="token class-name">Config<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token builtin">number</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-3-4-æ³›å‹åœ¨æ¥å£-ç±»ä¸­çš„é«˜çº§åº”ç”¨"><a href="#1-3-4-æ³›å‹åœ¨æ¥å£-ç±»ä¸­çš„é«˜çº§åº”ç”¨" class="headerlink" title="1.3.4 æ³›å‹åœ¨æ¥å£&#x2F;ç±»ä¸­çš„é«˜çº§åº”ç”¨"></a>1.3.4 æ³›å‹åœ¨æ¥å£&#x2F;ç±»ä¸­çš„é«˜çº§åº”ç”¨</h3><p><strong>æ³›å‹æ¥å£ï¼ˆGeneric Interfacesï¼‰</strong></p>
<p>åŸºç¡€æ¨¡å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç®€å•æ³›å‹æ¥å£</span>
<span class="token keyword">interface</span> <span class="token class-name">KeyValuePair<span class="token operator">&lt;</span><span class="token constant">K</span><span class="token punctuation">,</span> <span class="token constant">V</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">;</span>
  value<span class="token operator">:</span> <span class="token constant">V</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> stringPair<span class="token operator">:</span> KeyValuePair<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  key<span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> <span class="token string">"Alice"</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> numberPair<span class="token operator">:</span> KeyValuePair<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token builtin">boolean</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  key<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‡½æ•°ç­¾åæ³›å‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¸¦è°ƒç”¨ç­¾åçš„æ³›å‹æ¥å£</span>
<span class="token keyword">interface</span> <span class="token class-name">Transformer<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> toUpperCase<span class="token operator">:</span> Transformer<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span> <span class="token operator">=</span> 
  str <span class="token operator">=></span> str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
<span class="token keyword">const</span> toNumber<span class="token operator">:</span> Transformer<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">></span> <span class="token operator">=</span> 
  str <span class="token operator">=></span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ³›å‹ç±»ï¼ˆGeneric Classesï¼‰</strong></p>
<p>åŸºæœ¬ç»“æ„ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Box<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> content<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  
  <span class="token function">constructor</span><span class="token punctuation">(</span>initialValue<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> initialValue<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">setValue</span><span class="token punctuation">(</span>newValue<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> stringBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Box<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token string">"Initial"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stringBox<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">"New value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> numberBox <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Box<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>numberBox<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 200</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™æ€æˆå‘˜é™åˆ¶ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Factory<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ğŸš« é”™è¯¯ï¼é™æ€æˆå‘˜ä¸èƒ½å¼•ç”¨ç±»å‹å‚æ•°</span>
  <span class="token keyword">static</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  
  <span class="token comment">// âœ… æ­£ç¡®ï¼šé™æ€æˆå‘˜ä½¿ç”¨ç‹¬ç«‹æ³›å‹</span>
  <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> Factory<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Factory</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ³›å‹çº¦æŸçš„é«˜çº§åº”ç”¨</strong></p>
<p>ç±»å‹å‚æ•°çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¡®ä¿ç±»å‹Tæœ‰idå±æ€§</span>
<span class="token keyword">interface</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Repository<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Identifiable<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> items<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token function">add</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>item <span class="token operator">=></span> item<span class="token punctuation">.</span>id <span class="token operator">===</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> userRepo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Repository<span class="token operator">&lt;</span>User<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
userRepo<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> userRepo<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„é€ å‡½æ•°çº¦æŸï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¦æ±‚æ³›å‹Tå¿…é¡»æ˜¯ç±»ç±»å‹</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createInstance</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>ctor<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// é«˜çº§ï¼šå¸¦å‚æ•°æ„é€ å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createWithParams</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
  ctor<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>args<span class="token operator">:</span> ConstructorParameters<span class="token operator">&lt;</span><span class="token keyword">typeof</span> ctor<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ctor</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> <span class="token keyword">public</span> y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token function">createWithParams</span><span class="token punctuation">(</span>Point<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Point &#123; x: 1, y: 2 &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¥å£ä¸ç±»çš„ç»„åˆæ¨¡å¼</strong></p>
<p>æ¨¡å¼1ï¼šå·¥å‚æ¥å£</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Factory<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">CarFactory</span> <span class="token keyword">implements</span> <span class="token class-name">Factory<span class="token operator">&lt;</span>Car<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">BikeFactory</span> <span class="token keyword">implements</span> <span class="token class-name">Factory<span class="token operator">&lt;</span>Bike<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Bike</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">assembleProduct</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>factory<span class="token operator">:</span> Factory<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> factory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å¼2ï¼šç­–ç•¥æ¨¡å¼</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">PaymentStrategy<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">processPayment</span><span class="token punctuation">(</span>amount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> context<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">CreditCardStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentStrategy<span class="token operator">&lt;</span>CreditCardInfo<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">processPayment</span><span class="token punctuation">(</span>amount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> card<span class="token operator">:</span> CreditCardInfo<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// ä¿¡ç”¨å¡æ”¯ä»˜é€»è¾‘</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">PayPalStrategy</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentStrategy<span class="token operator">&lt;</span>PayPalAccount<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">processPayment</span><span class="token punctuation">(</span>amount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> account<span class="token operator">:</span> PayPalAccount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// PayPalæ”¯ä»˜é€»è¾‘</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">processOrder</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
  amount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  strategy<span class="token operator">:</span> PaymentStrategy<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span>
  context<span class="token operator">:</span> <span class="token constant">T</span>
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> strategy<span class="token punctuation">.</span><span class="token function">processPayment</span><span class="token punctuation">(</span>amount<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹æ¨å¯¼ä¸é»˜è®¤å€¼</strong></p>
<p>ç±»å‹å‚æ•°é»˜è®¤å€¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¥å£é»˜è®¤ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">PaginatedResponse<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  totalPages<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç±»é»˜è®¤ç±»å‹</span>
<span class="token keyword">class</span> <span class="token class-name">Cache<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token function">set</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨é»˜è®¤ç±»å‹</span>
<span class="token keyword">const</span> stringCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cache&lt;string></span>
stringCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> anyCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
anyCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Bob"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šä¸‹æ–‡ç±»å‹æ¨å¯¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ¹æ®å®ç°è‡ªåŠ¨æ¨å¯¼ç±»å‹å‚æ•°</span>
<span class="token keyword">class</span> <span class="token class-name">StringContainer</span> <span class="token keyword">implements</span> <span class="token class-name">Container<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">add</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ˜¾å¼æŒ‡å®šç±»å‹å‚æ•°</span>
<span class="token keyword">class</span> <span class="token class-name">NumberContainer</span> <span class="token keyword">implements</span> <span class="token class-name">Container<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">add</span><span class="token punctuation">(</span>item<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§å·¥ç¨‹æ¡ˆä¾‹</strong></p>
<p>æ¡ˆä¾‹1ï¼šAPI å®¢æˆ·ç«¯å°è£…</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">ApiClient<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">fetchData</span><span class="token punctuation">(</span>endpoint<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token function">postData</span><span class="token punctuation">(</span>endpoint<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">JsonApiClient<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token keyword">implements</span> <span class="token class-name">ApiClient<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> baseUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  
  <span class="token keyword">async</span> <span class="token function">fetchData</span><span class="token punctuation">(</span>endpoint<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>endpoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">async</span> <span class="token function">postData</span><span class="token punctuation">(</span>endpoint<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">this</span><span class="token punctuation">.</span>baseUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>endpoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
      method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> userClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JsonApiClient<span class="token operator">&lt;</span>User<span class="token operator">></span></span><span class="token punctuation">(</span><span class="token string">"https://api.example.com/users"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> userClient<span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¡ˆä¾‹2ï¼šçŠ¶æ€ç®¡ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">State<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  current<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  history<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">update</span><span class="token punctuation">(</span>newState<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">HistoryState<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token keyword">implements</span> <span class="token class-name">State<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  history<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> current<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">update</span><span class="token punctuation">(</span>newState<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> newState<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">getHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> counterState <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HistoryState<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
counterState<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
counterState<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counterState<span class="token punctuation">.</span><span class="token function">getHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [0, 1, 2]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>é¿å…è¿‡åº¦æ³›å‹åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸æ¨èï¼šä¸å¿…è¦çš„æ³›å‹</span>
<span class="token keyword">class</span> <span class="token class-name">Printer<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ¨èï¼šç›´æ¥ä½¿ç”¨å…·ä½“ç±»å‹</span>
<span class="token keyword">class</span> <span class="token class-name">ConsolePrinter</span> <span class="token punctuation">&#123;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æä¾›æœ‰æ„ä¹‰çš„ç±»å‹å‚æ•°åï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨è</span>
<span class="token keyword">interface</span> <span class="token class-name">Repository<span class="token operator">&lt;</span>EntityType<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">save</span><span class="token punctuation">(</span>entity<span class="token operator">:</span> EntityType<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä¸æ¨è</span>
<span class="token keyword">interface</span> <span class="token class-name">Repository<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">save</span><span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é»˜è®¤ç±»å‹ç”¨äºé€šç”¨åœºæ™¯ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é€šç”¨ç¼“å­˜é»˜è®¤å­˜å‚¨å¯¹è±¡</span>
<span class="token keyword">class</span> <span class="token class-name">Cache<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> object<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> storage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨é»˜è®¤ç±»å‹</span>
<span class="token keyword">const</span> objectCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>çº¦æŸæ–‡æ¡£åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">/**
 * æ’åºæœåŠ¡
 * @template T - æ’åºå…ƒç´ çš„ç±»å‹
 * @template K - æ’åºä¾æ®çš„é”®åï¼ˆå¿…é¡»æ˜¯Tçš„é”®ï¼‰
 */</span>
<span class="token keyword">class</span> <span class="token class-name">Sorter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">sort</span><span class="token punctuation">(</span>items<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> items<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> 
      a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">></span> b<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>ç±»ä¸æ¥å£ååŒï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®šä¹‰æ³›å‹æ¥å£</span>
<span class="token keyword">interface</span> <span class="token class-name">Processor<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å®ç°å…·ä½“å¤„ç†å™¨</span>
<span class="token keyword">class</span> <span class="token class-name">NumberProcessor</span> <span class="token keyword">implements</span> <span class="token class-name">Processor<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">process</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>input <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åˆ›å»ºå¤„ç†å™¨å·¥å‚</span>
<span class="token keyword">const</span> processors <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">number</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">NumberProcessor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">processData</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>processors<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">(</span>processors<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token keyword">as</span> Processor<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜ï¼šæ³›å‹ç±»å®ä¾‹æ–¹æ³•ç±»å‹ä¸¢å¤±</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Wrapper<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç±»å‹ä¿¡æ¯ä¸¢å¤±</span>
<span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Wrapper</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> value <span class="token operator">=</span> wrapper<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// value ç±»å‹ä¸º number âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨æˆå‘˜å˜é‡ä¿å­˜ç±»å‹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">TypeSafeWrapper<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æ˜¾å¼ä¿å­˜ç±»å‹å¼•ç”¨</span>
  <span class="token keyword">public</span> <span class="token keyword">readonly</span> valueType<span class="token operator">!</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  
  <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> safeWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TypeSafeWrapper</span><span class="token punctuation">(</span><span class="token string">"text"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">ValueType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> safeWrapper<span class="token punctuation">.</span>valueType<span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜ï¼šæ³›å‹æ¥å£å®ç°å†²çª</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Adder<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// é”™è¯¯ï¼šå¿…é¡»ä¸ºæ‰€æœ‰ç±»å‹å‚æ•°æä¾›å®ç°</span>
<span class="token keyword">class</span> <span class="token class-name">NumberAdder</span> <span class="token keyword">implements</span> <span class="token class-name">Adder</span> <span class="token punctuation">&#123;</span>
  <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ­£ç¡®ï¼šæŒ‡å®šå…·ä½“ç±»å‹</span>
<span class="token keyword">class</span> <span class="token class-name">NumberAdder</span> <span class="token keyword">implements</span> <span class="token class-name">Adder<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æˆ–ä½¿ç”¨æ³›å‹ç±»</span>
<span class="token keyword">class</span> <span class="token class-name">GenericAdder<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Adder<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> zeroValue<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
  
  <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// å®é™…å®ç°éœ€ä¾èµ–å…·ä½“ç±»å‹</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span> <span class="token comment">// ç®€åŒ–ç¤ºä¾‹</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="1-4-æ¨¡å—ç³»ç»Ÿ"><a href="#1-4-æ¨¡å—ç³»ç»Ÿ" class="headerlink" title="1.4 æ¨¡å—ç³»ç»Ÿ"></a>1.4 æ¨¡å—ç³»ç»Ÿ</h2><h3 id="1-4-1-ES-Module-ä¸-CommonJS-äº’æ“ä½œ"><a href="#1-4-1-ES-Module-ä¸-CommonJS-äº’æ“ä½œ" class="headerlink" title="1.4.1 ES Module ä¸ CommonJS äº’æ“ä½œ"></a>1.4.1 ES Module ä¸ CommonJS äº’æ“ä½œ</h3><p><strong>åŸºæœ¬äº’æ“ä½œæ¨¡å¼</strong></p>
<table>
<thead>
<tr>
<th align="left">å¯¼å…¥æ–¹å‘</th>
<th align="left">è¯­æ³•ç¤ºä¾‹</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ES â†’ CommonJS</td>
<td align="left"><code>import fs from &#39;fs&#39;;</code><br><code>import &#123; readFile &#125; from &#39;fs&#39;;</code></td>
<td align="left">é»˜è®¤å¯¼å…¥æˆ–å…·åå¯¼å…¥</td>
</tr>
<tr>
<td align="left">CommonJS â†’ ES</td>
<td align="left"><code>const esModule = require(&#39;./es-module&#39;);</code></td>
<td align="left">é€šè¿‡requireåŠ è½½</td>
</tr>
<tr>
<td align="left">CommonJS â†’ ES (è§£æ„)</td>
<td align="left"><code>const &#123; namedExport &#125; = require(&#39;./es-module&#39;);</code></td>
<td align="left">è§£æ„ESæ¨¡å—çš„å…·åå¯¼å‡º</td>
</tr>
</tbody></table>
<p><strong>ESM å¯¼å…¥ CommonJS æ¨¡å—</strong></p>
<ol>
<li>é»˜è®¤å¯¼å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¯¼å…¥æ•´ä¸ªCommonJSæ¨¡å—</span>
<span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å…·åå¯¼å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¯¼å…¥ç‰¹å®šå±æ€§ï¼ˆéœ€æ¨¡å—æ”¯æŒï¼‰</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> readFile <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
<span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'file.txt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>åŠ¨æ€å¯¼å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¼‚æ­¥åŠ è½½CommonJSæ¨¡å—</span>
<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
util<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span>setTimeout<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹å£°æ˜è¦æ±‚ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç±»å‹å£°æ˜æ–‡ä»¶éœ€æ”¯æŒä¸¤ç§å¯¼å‡ºæ ¼å¼</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'cjs-module'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> _default<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token operator">=</span> _default<span class="token punctuation">;</span>  <span class="token comment">// CommonJSå¯¼å‡º</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> _default<span class="token punctuation">;</span> <span class="token comment">// ESé»˜è®¤å¯¼å‡º</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>CommonJS å¯¼å…¥ ESM æ¨¡å—</strong></p>
<ol>
<li>é»˜è®¤å¯¼å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// CommonJS ç¯å¢ƒ</span>
<span class="token keyword">const</span> esModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./es-module'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»è®¿é—®.default</span>
esModule<span class="token punctuation">.</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å…·åå¯¼å…¥ï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// è§£æ„å…·åå¯¼å‡º</span>
<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> namedExport <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./es-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li>å¼‚æ­¥åŠ è½½ï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// åœ¨æ”¯æŒtop-level awaitçš„ç¯å¢ƒ</span>
<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> esModule <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./es-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>äº’æ“ä½œä¸­çš„ç±»å‹å¤„ç†</strong></p>
<ol>
<li>CommonJS æ¨¡å—ç±»å‹å£°æ˜ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ‡å‡†å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'cjs-module'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> someValue<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  
  <span class="token keyword">export</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> 
    someFunction<span class="token punctuation">,</span>
    someValue
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">import</span> cjs <span class="token keyword">from</span> <span class="token string">'cjs-module'</span><span class="token punctuation">;</span>
cjs<span class="token punctuation">.</span><span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ES æ¨¡å—ç±»å‹å£°æ˜ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ESæ¨¡å—å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'es-module'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">namedExport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">defaultExport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// CommonJSä½¿ç”¨</span>
<span class="token keyword">const</span> esm <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'es-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
esm<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¿é—®é»˜è®¤å¯¼å‡º</span>
esm<span class="token punctuation">.</span><span class="token function">namedExport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¿é—®å…·åå¯¼å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å…¼å®¹ç±»å‹å£°æ˜ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŒæ—¶æ”¯æŒä¸¤ç§å¯¼å…¥æ–¹å¼</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'dual-module'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> defaultExport<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> defaultExport<span class="token punctuation">;</span> <span class="token comment">// ESé»˜è®¤å¯¼å‡º</span>
  <span class="token keyword">export</span> <span class="token operator">=</span> defaultExport<span class="token punctuation">;</span>       <span class="token comment">// CommonJSå¯¼å‡º</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>äº’æ“ä½œé™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é™·é˜±1ï¼šé»˜è®¤å¯¼å‡ºæ··æ·†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// CommonJSæ¨¡å—</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// å¯¼å‡ºå‡½æ•°</span>

<span class="token comment">// ESæ¨¡å—å¯¼å…¥</span>
<span class="token keyword">import</span> cjsFunc <span class="token keyword">from</span> <span class="token string">'cjs-module'</span><span class="token punctuation">;</span> <span class="token comment">// âœ… æ­£ç¡®</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span> <span class="token keyword">as</span> cjsFunc <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'cjs-module'</span><span class="token punctuation">;</span> <span class="token comment">// âœ… æ­£ç¡®</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> cjsModule <span class="token keyword">from</span> <span class="token string">'cjs-module'</span><span class="token punctuation">;</span> 
cjsModule<span class="token punctuation">.</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… æ­£ç¡®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™·é˜±2ï¼š__esModule æ ‡å¿—</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Babel/TSç¼–è¯‘çš„ESMæ¨¡å—ä¼šæ·»åŠ </span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">"__esModule"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> value<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// äº’æ“ä½œæ„ä¹‰ï¼šæ ‡è®°æ¨¡å—ä¸ºESMè½¬æ¢è€Œæ¥</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>__esModule<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æŒ‰ESMè§„èŒƒå¤„ç†</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™·é˜±3ï¼šåŠ¨æ€å¯¼å…¥å·®å¼‚</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ESæ¨¡å—</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token comment">// CommonJSå¯¼å…¥</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./es-module'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// âŒ å¯èƒ½æœªå®šä¹‰</span>
<span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./es-module'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// âœ… æ­£ç¡®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹æœ€ä½³å®è·µ</strong></p>
<ol>
<li>ç»Ÿä¸€æ¨¡å—æ ¼å¼ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"ESNext"</span><span class="token punctuation">,</span>       <span class="token comment">// è¾“å‡ºESM</span>
    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"Node"</span> <span class="token comment">// æ”¯æŒNodeè§£æè§„åˆ™</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶å¯¼å‡ºï¼ˆpackage.jsonï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./dist/esm/index.js"</span><span class="token punctuation">,</span>   <span class="token comment">// ESMå…¥å£</span>
    <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./dist/cjs/index.js"</span><span class="token punctuation">,</span>  <span class="token comment">// CommonJSå…¥å£</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./dist/cjs/index.js"</span>   <span class="token comment">// å›é€€</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>åŒæ ¼å¼å‘å¸ƒï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">my-package/
â”œâ”€â”€ dist/
â”‚   â”œâ”€â”€ esm/        // ESæ¨¡å—ç‰ˆæœ¬
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â””â”€â”€ cjs/        // CommonJSç‰ˆæœ¬
â”‚       â””â”€â”€ index.js
â”œâ”€â”€ package.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>äº’æ“ä½œå°è£…å±‚ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// cjs-compat.ts - CommonJSå°è£…å±‚</span>
<span class="token keyword">import</span> esModule <span class="token keyword">from</span> <span class="token string">'./es-module'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">=</span> esModule<span class="token punctuation">;</span> <span class="token comment">// è½¬æ¢ä¸ºCommonJSå¯¼å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>TypeScript ç¼–è¯‘é€‰é¡¹</strong></p>
<table>
<thead>
<tr>
<th align="left">é€‰é¡¹</th>
<th align="left">å€¼</th>
<th align="left">äº’æ“ä½œå½±å“</th>
</tr>
</thead>
<tbody><tr>
<td align="left">esModuleInterop</td>
<td align="left">true (æ¨è)</td>
<td align="left">ç”Ÿæˆå…¼å®¹ä»£ç ï¼Œå…è®¸é»˜è®¤å¯¼å…¥CommonJSæ¨¡å—</td>
</tr>
<tr>
<td align="left">allowSyntheticDefaultImports</td>
<td align="left">true</td>
<td align="left">å…è®¸ç±»å‹ç³»ç»Ÿä¸­çš„é»˜è®¤å¯¼å…¥</td>
</tr>
<tr>
<td align="left">module</td>
<td align="left">CommonJS&#x2F;Node16</td>
<td align="left">æ§åˆ¶è¾“å‡ºæ¨¡å—æ ¼å¼</td>
</tr>
<tr>
<td align="left">moduleResolution</td>
<td align="left">Node16 (æ¨è)</td>
<td align="left">æ”¯æŒpackage.jsonçš„exportså’Œimportså­—æ®µ</td>
</tr>
</tbody></table>
<p>esModuleInterop å·¥ä½œåŸç†ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// å¼€å¯å‰</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> fs<span class="token punctuation">;</span>

<span class="token comment">// å¼€å¯å</span>
<span class="token keyword">var</span> __importDefault <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__importDefault<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">mod</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>mod <span class="token operator">&amp;&amp;</span> mod<span class="token punctuation">.</span>__esModule<span class="token punctuation">)</span> <span class="token operator">?</span> mod <span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token string-property property">"default"</span><span class="token operator">:</span> mod <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fs_1 <span class="token operator">=</span> <span class="token function">__importDefault</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> fs_1<span class="token punctuation">.</span>default<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Node.js ç¯å¢ƒäº’æ“ä½œ</strong></p>
<ol>
<li>.mjs ä¸ .cjs æ‰©å±•åï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// ESæ¨¡å— (module.mjs)</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

<span class="token comment">// CommonJSå¯¼å…¥ (script.cjs)</span>
<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> hello <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module.mjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âŒ Nodeä¸å…è®¸</span>
<span class="token keyword">const</span> esm <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./module.mjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å¿…é¡»ä½¿ç”¨åŠ¨æ€å¯¼å…¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>package.json type å­—æ®µï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span> <span class="token comment">// æ‰€æœ‰.jsæ–‡ä»¶è§†ä¸ºESæ¨¡å—</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span> <span class="token comment">// é»˜è®¤å€¼</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ–‡ä»¶æ‰©å±•åè§„åˆ™ï¼š</li>
</ol>
<table>
<thead>
<tr>
<th align="left">æ–‡ä»¶æ‰©å±•å</th>
<th align="left">æ¨¡å—ç±»å‹</th>
<th align="left">å¯¼å…¥æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td align="left">.js</td>
<td align="left">ç”±typeå­—æ®µå†³å®š</td>
<td align="left">æ ¹æ®typeå­—æ®µå¤„ç†</td>
</tr>
<tr>
<td align="left">.mjs</td>
<td align="left">ESæ¨¡å—</td>
<td align="left">åªèƒ½importå¯¼å…¥</td>
</tr>
<tr>
<td align="left">.cjs</td>
<td align="left">CommonJS</td>
<td align="left">åªèƒ½requireå¯¼å…¥</td>
</tr>
</tbody></table>
<p><strong>æµè§ˆå™¨ç¯å¢ƒäº’æ“ä½œ</strong></p>
<ol>
<li>è„šæœ¬ç±»å‹å£°æ˜ï¼š</li>
</ol>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!-- åŠ è½½ESæ¨¡å— --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- åŠ è½½CommonJSæ¨¡å—ï¼ˆéœ€æ‰“åŒ…è½¬æ¢ï¼‰ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cjs-bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>åŠ¨æ€å¯¼å…¥å…¼å®¹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æµè§ˆå™¨ä¸­çš„åŠ¨æ€å¯¼å…¥</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// Nodeç¯å¢ƒ</span>
  <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./cjs-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æµè§ˆå™¨ç¯å¢ƒ</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./es-module.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>mod <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>äº’æ“ä½œç±»å‹å®‰å…¨ç­–ç•¥</strong></p>
<ol>
<li>æ¨¡å—æ‰©å……å£°æ˜ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ‰©å……CommonJSæ¨¡å—ç±»å‹</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'fs'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">customMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">customMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… ç±»å‹å®‰å…¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶ç±»å‹å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŒºåˆ†æ¨¡å—ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ModuleType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> __esModule<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span> <span class="token operator">?</span> 
  <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">U</span> <span class="token punctuation">&#125;</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">importCompat</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>module<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> ModuleType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// å®ç°äº’æ“ä½œè½¬æ¢</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è¿è¡Œæ—¶ç±»å‹å®ˆå«ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ£€æµ‹ESæ¨¡å—</span>
<span class="token keyword">function</span> <span class="token function">isESModule</span><span class="token punctuation">(</span>module<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">module</span> <span class="token keyword">is</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>__esModule <span class="token operator">||</span> 
    <span class="token punctuation">(</span><span class="token keyword">typeof</span> Symbol <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> 
     Symbol<span class="token punctuation">.</span>toStringTag <span class="token keyword">in</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-4-2-å‘½åç©ºé—´ä¸ç°ä»£æ¨¡å—å¯¹æ¯”"><a href="#1-4-2-å‘½åç©ºé—´ä¸ç°ä»£æ¨¡å—å¯¹æ¯”" class="headerlink" title="1.4.2 å‘½åç©ºé—´ä¸ç°ä»£æ¨¡å—å¯¹æ¯”"></a>1.4.2 å‘½åç©ºé—´ä¸ç°ä»£æ¨¡å—å¯¹æ¯”</h3><p><strong>å‘½åç©ºé—´ï¼ˆNamespacesï¼‰</strong></p>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šTypeScript æ—©æœŸæä¾›çš„é€»è¾‘åˆ†ç»„æœºåˆ¶ï¼Œç”¨äºç»„ç»‡å…¨å±€ä½œç”¨åŸŸä»£ç </p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®šä¹‰å‘½åç©ºé—´</span>
<span class="token keyword">namespace</span> MyUtils <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">export</span> <span class="token keyword">namespace</span> Math <span class="token punctuation">&#123;</span>
    <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">circleArea</span><span class="token punctuation">(</span>r<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> r <span class="token operator">*</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
MyUtils<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> area <span class="token operator">=</span> MyUtils<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–è¯‘ç»“æœï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// è½¬æ¢ä¸ºé—­åŒ…å½¢å¼</span>
<span class="token keyword">var</span> MyUtils<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">MyUtils</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  MyUtils<span class="token punctuation">.</span>log <span class="token operator">=</span> log<span class="token punctuation">;</span>
  
  <span class="token keyword">let</span> Math<span class="token punctuation">;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">Math</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> r <span class="token operator">*</span> r<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    Math<span class="token punctuation">.</span>circleArea <span class="token operator">=</span> circleArea<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Math <span class="token operator">=</span> MyUtils<span class="token punctuation">.</span>Math <span class="token operator">||</span> <span class="token punctuation">(</span>MyUtils<span class="token punctuation">.</span>Math <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MyUtils <span class="token operator">||</span> <span class="token punctuation">(</span>MyUtils <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç°ä»£æ¨¡å—ï¼ˆES Modulesï¼‰</strong></p>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šES6 æ ‡å‡†å¼•å…¥çš„æ–‡ä»¶çº§ä½œç”¨åŸŸéš”ç¦»æœºåˆ¶</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// math.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">circleArea</span><span class="token punctuation">(</span>r<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> r <span class="token operator">*</span> r<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// logger.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// app.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> log <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./logger'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> MathUtils <span class="token keyword">from</span> <span class="token string">'./math'</span><span class="token punctuation">;</span>

<span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Calculating area"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> area <span class="token operator">=</span> MathUtils<span class="token punctuation">.</span><span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ ¸å¿ƒå·®å¼‚å¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th align="left">ç‰¹æ€§</th>
<th align="left">å‘½åç©ºé—´</th>
<th align="left">ç°ä»£æ¨¡å—</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ä½œç”¨åŸŸ</td>
<td align="left">å…¨å±€&#x2F;æ–‡ä»¶å†…</td>
<td align="left">æ–‡ä»¶çº§ä½œç”¨åŸŸ</td>
</tr>
<tr>
<td align="left">ä¾èµ–ç®¡ç†</td>
<td align="left">æ‰‹åŠ¨æ’åº<code>&lt;script&gt;</code>æ ‡ç­¾</td>
<td align="left">è‡ªåŠ¨ä¾èµ–è§£æï¼ˆimport&#x2F;exportï¼‰</td>
</tr>
<tr>
<td align="left">ä»£ç ç»„ç»‡</td>
<td align="left">é€»è¾‘åˆ†ç»„</td>
<td align="left">ç‰©ç†æ–‡ä»¶åˆ†ç»„</td>
</tr>
<tr>
<td align="left">ä»£ç åˆ†å‰²</td>
<td align="left">ä¸æ”¯æŒ</td>
<td align="left">åŸç”Ÿæ”¯æŒï¼ˆåŠ¨æ€å¯¼å…¥ï¼‰</td>
</tr>
<tr>
<td align="left">æ‘‡æ ‘ä¼˜åŒ–</td>
<td align="left">ä¸æ”¯æŒ</td>
<td align="left">åŸç”Ÿæ”¯æŒï¼ˆTree Shakingï¼‰</td>
</tr>
<tr>
<td align="left">è¿è¡Œæ—¶æ€§èƒ½</td>
<td align="left">æ‰€æœ‰ä»£ç ç«‹å³åŠ è½½</td>
<td align="left">æŒ‰éœ€åŠ è½½</td>
</tr>
<tr>
<td align="left">ç±»å‹å£°æ˜</td>
<td align="left">é€šè¿‡&#x2F;&#x2F;&#x2F; <code>&lt;reference&gt;</code>æŒ‡ä»¤</td>
<td align="left">è‡ªåŠ¨è§£æ.d.tsæ–‡ä»¶</td>
</tr>
<tr>
<td align="left">å…¨å±€æ±¡æŸ“</td>
<td align="left">å¯èƒ½æ±¡æŸ“å…¨å±€å‘½åç©ºé—´</td>
<td align="left">æ— å…¨å±€æ±¡æŸ“</td>
</tr>
</tbody></table>
<p><strong>ä½¿ç”¨åœºæ™¯æŒ‡å—</strong></p>
<p>å‘½åç©ºé—´é€‚ç”¨åœºæ™¯ï¼š</p>
<ol>
<li>æµè§ˆå™¨ç¯å¢ƒä¸‹çš„æ—§é¡¹ç›®ç»´æŠ¤</li>
<li>éœ€è¦å…¨å±€å¯è®¿é—®çš„åº“ç±»å‹å£°æ˜ï¼ˆå¦‚window.myLibï¼‰</li>
<li>å°†å¤§å‹åº“æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ä½†ä»éœ€å…±äº«ä½œç”¨åŸŸ</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¤šæ–‡ä»¶å‘½åç©ºé—´</span>
<span class="token comment">// Validation.ts</span>
<span class="token keyword">namespace</span> Validation <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Validator</span> <span class="token punctuation">&#123;</span>
    <span class="token function">isValid</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// LettersOnlyValidator.ts</span>
<span class="token comment">/// &lt;reference path="Validation.ts" /></span>
<span class="token keyword">namespace</span> Validation <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LettersOnlyValidator</span> <span class="token keyword">implements</span> <span class="token class-name">Validator</span> <span class="token punctuation">&#123;</span>
    <span class="token function">isValid</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç°ä»£æ¨¡å—é€‚ç”¨åœºæ™¯ï¼š</p>
<ol>
<li>æ–°é¡¹ç›®å¼€å‘</li>
<li>éœ€è¦ä»£ç åˆ†å‰²çš„åº”ç”¨</li>
<li>ç»„ä»¶åŒ–æ¶æ„ï¼ˆReact&#x2F;Vueï¼‰</li>
<li>Node.js æœåŠ¡ç«¯åº”ç”¨</li>
<li>éœ€è¦ Tree Shaking ä¼˜åŒ–çš„åº“</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç°ä»£æ¨¡å—åŒ–ç»„ä»¶</span>
<span class="token comment">// Button.tsx</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> text <span class="token punctuation">&#125;</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button<span class="token operator">></span><span class="token punctuation">&#123;</span>text<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// App.tsx</span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Button text<span class="token operator">=</span><span class="token string">"Click"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ··åˆä½¿ç”¨æ¨¡å¼</strong></p>
<p>åœºæ™¯ï¼šæ¨¡å—æ‰©å±•å‘½åç©ºé—´</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// shapes.ts - å‘½åç©ºé—´å®šä¹‰</span>
<span class="token keyword">namespace</span> Shapes <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// extensions.ts - æ¨¡å—æ‰©å±•å‘½åç©ºé—´</span>
<span class="token keyword">import</span> <span class="token string">'./shapes'</span><span class="token punctuation">;</span> <span class="token comment">// ç¡®ä¿å‘½åç©ºé—´å­˜åœ¨</span>

<span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">namespace</span> Shapes <span class="token punctuation">&#123;</span>
    <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Triangle</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span> <span class="token comment">// æ‰©å±•å‘½åç©ºé—´</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> triangle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shapes</span><span class="token punctuation">.</span><span class="token function">Triangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯ï¼šå‘½åç©ºé—´å°è£…æ¨¡å—ç±»å‹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸ºç¬¬ä¸‰æ–¹æ¨¡å—å£°æ˜å…¨å±€ç±»å‹</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">namespace</span> <span class="token constant">JSX</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">interface</span> <span class="token class-name">IntrinsicElements</span> <span class="token punctuation">&#123;</span>
      customElement<span class="token operator">:</span> React<span class="token punctuation">.</span>DetailedHTMLProps<span class="token operator">&lt;</span>
        React<span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span>HTMLElement<span class="token operator">></span><span class="token punctuation">,</span>
        HTMLElement
      <span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹è¿ç§»ç­–ç•¥</strong></p>
<p>æ­¥éª¤1ï¼šå‘½åç©ºé—´è½¬æ¨¡å—</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå‘½åç©ºé—´ä»£ç </span>
<span class="token keyword">namespace</span> Utilities <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// è½¬æ¢ä¸ºæ¨¡å—</span>
<span class="token comment">// utilities.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¥éª¤2ï¼šå¤„ç†å…¨å±€ä¾èµ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå…¨å±€ä¾èµ–</span>
<span class="token keyword">namespace</span> App <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">&#123;</span> debug<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// è½¬æ¢ä¸ºå•ä¾‹æ¨¡å—</span>
<span class="token comment">// config.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">&#123;</span> debug<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨å¤„æ”¹ä¸ºå¯¼å…¥</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> config <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./config'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¥éª¤3ï¼šå¤„ç†å¤šæ–‡ä»¶å‘½åç©ºé—´</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå¤šæ–‡ä»¶å‘½åç©ºé—´</span>
<span class="token comment">/// &lt;reference path="validation.ts" /></span>
<span class="token keyword">namespace</span> Validation <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">EmailValidator</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// è½¬æ¢ä¸ºæ¨¡å—</span>
<span class="token comment">// EmailValidator.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> Validator <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./validation'</span><span class="token punctuation">;</span> <span class="token comment">// è½¬æ¢ä¸ºæ¨¡å—</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">EmailValidator</span> <span class="token keyword">implements</span> <span class="token class-name">Validator</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>æ–°é¡¹ç›®å¼ºåˆ¶ä½¿ç”¨æ¨¡å—ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"ESNext"</span><span class="token punctuation">,</span>
    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"NodeNext"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ—§é¡¹ç›®æ¸è¿›è¿ç§»ï¼š<ul>
<li>æ–°æ–‡ä»¶ä½¿ç”¨æ¨¡å—è¯­æ³•</li>
<li>æ—§æ–‡ä»¶ä¿æŒå‘½åç©ºé—´</li>
<li>ä½¿ç”¨export as namespaceæä¾›å…¨å±€è®¿é—®</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// legacy.d.ts</span>
<span class="token keyword">export</span> <span class="token operator">=</span> MyLib<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">as</span> <span class="token keyword">namespace</span> myLib<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é¿å…å…¨å±€æ‰©å±•æ±¡æŸ“ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸æ¨èï¼šæ±¡æŸ“å…¨å±€å‘½åç©ºé—´</span>
<span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">&#123;</span>
    myGlobalVar<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ¨èï¼šæ¨¡å—å°è£…</span>
<span class="token comment">// my-module.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  window<span class="token punctuation">.</span>myGlobalVar <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>ç±»å‹å£°æ˜ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç°ä»£æ¨¡å—ç±»å‹å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'modern-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å‘½åç©ºé—´ç±»å‹å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> LegacyLib <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜ï¼šå…¨å±€ç±»å‹å†²çª</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// file1.ts</span>
<span class="token keyword">namespace</span> MyApp <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token string">"1.0"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// file2.ts</span>
<span class="token keyword">namespace</span> MyApp <span class="token punctuation">&#123;</span> <span class="token comment">// âŒ å¯èƒ½ä¸å…¶ä»–æ–‡ä»¶åˆå¹¶</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è½¬æ¢ä¸ºæ¨¡å—åŒ–</span>
<span class="token comment">// version.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token string">"1.0"</span><span class="token punctuation">;</span>

<span class="token comment">// logger.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜ï¼šç¬¬ä¸‰æ–¹åº“å…¨å±€æ‰©å±•</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ‰©å±•jQuery</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> JQuery <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Static</span> <span class="token punctuation">&#123;</span>
    <span class="token function">newPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç°ä»£æ–¹æ¡ˆï¼šæ¨¡å—å¢å¼º</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'jquery'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">JQueryStatic</span> <span class="token punctuation">&#123;</span>
    <span class="token function">newPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜ï¼šå¾ªç¯ä¾èµ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å‘½åç©ºé—´ä¸­çš„å¾ªç¯å¼•ç”¨</span>
<span class="token keyword">namespace</span> <span class="token constant">A</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// âŒ Bå°šæœªå®šä¹‰</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token constant">B</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¨¡å—åŒ–è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// a.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> value <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./b'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> value<span class="token punctuation">;</span>

<span class="token comment">// b.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> b <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./a'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> value <span class="token operator">=</span> b <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// âŒ å¾ªç¯ä¾èµ–</span>

<span class="token comment">// é‡æ„ï¼šæå–å…¬å…±é€»è¾‘</span>
<span class="token comment">// constants.ts</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">BASE_VALUE</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">// a.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">BASE_VALUE</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./constants'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token constant">BASE_VALUE</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment">// b.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">BASE_VALUE</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'./constants'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token constant">BASE_VALUE</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="1-4-3-æ¨¡å—è§£æç­–ç•¥ä¸è·¯å¾„æ˜ å°„"><a href="#1-4-3-æ¨¡å—è§£æç­–ç•¥ä¸è·¯å¾„æ˜ å°„" class="headerlink" title="1.4.3 æ¨¡å—è§£æç­–ç•¥ä¸è·¯å¾„æ˜ å°„"></a>1.4.3 æ¨¡å—è§£æç­–ç•¥ä¸è·¯å¾„æ˜ å°„</h3><p><strong>æ¨¡å—è§£æç­–ç•¥</strong></p>
<p>TypeScript æ”¯æŒä¸¤ç§æ¨¡å—è§£æç­–ç•¥ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç­–ç•¥</th>
<th align="left">è§¦å‘æ¡ä»¶</th>
<th align="left">è§£æé€»è¾‘</th>
<th align="left">é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Classic</td>
<td align="left">â€œmoduleResolutionâ€: â€œClassicâ€</td>
<td align="left">1. ç›¸å¯¹è·¯å¾„ï¼š.&#x2F;module â†’ .&#x2F;module.ts<br>2. éç›¸å¯¹è·¯å¾„ï¼šmodule â†’ .&#x2F;module.ts â†’ ..&#x2F;module.ts</td>
<td align="left">TS 1.6 å‰æ—§é¡¹ç›®</td>
</tr>
<tr>
<td align="left">Node</td>
<td align="left">â€œmoduleResolutionâ€: â€œNodeâ€<br>(é»˜è®¤å€¼)</td>
<td align="left">éµå¾ª Node.js è§£æè§„åˆ™ï¼š<br>1. æ£€æŸ¥æ–‡ä»¶<br>2. æ£€æŸ¥ç›®å½•<br>3. æ£€æŸ¥ package.json<br>4. æ£€æŸ¥ @types	ç°ä»£</td>
<td align="left">Node.js&#x2F;Web é¡¹ç›®</td>
</tr>
</tbody></table>
<p>Node ç­–ç•¥è§£ææµç¨‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> helper <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'my-utils'</span><span class="token punctuation">;</span>
<span class="token comment">// è§£ææ­¥éª¤ï¼š</span>
<span class="token comment">// 1. æ£€æŸ¥æ–‡ä»¶: node_modules/my-utils.ts</span>
<span class="token comment">// 2. æ£€æŸ¥æ–‡ä»¶: node_modules/my-utils.tsx</span>
<span class="token comment">// 3. æ£€æŸ¥æ–‡ä»¶: node_modules/my-utils.d.ts</span>
<span class="token comment">// 4. æ£€æŸ¥ç›®å½•: node_modules/my-utils/package.json (main/types å­—æ®µ)</span>
<span class="token comment">// 5. æ£€æŸ¥ç›®å½•: node_modules/my-utils/index.ts</span>
<span class="token comment">// 6. æ£€æŸ¥ä¸Šçº§ node_modules: ../node_modules/my-utils</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è·¯å¾„æ˜ å°„ï¼ˆPath Mappingï¼‰</strong></p>
<p>æ ¸å¿ƒç›®çš„ï¼šç®€åŒ–æ¨¡å—å¯¼å…¥è·¯å¾„ï¼Œé¿å…ç›¸å¯¹è·¯å¾„åµŒå¥—</p>
<p>é…ç½®æ–¹å¼ (tsconfig.json)ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"./src"</span><span class="token punctuation">,</span>
    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"@components/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"components/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"@utils"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"utils/index"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"shared/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"../shared/*"</span><span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ˜ å°„è§„åˆ™è§£æï¼š</p>
<table>
<thead>
<tr>
<th align="left">æ˜ å°„é…ç½®</th>
<th align="left">å¯¼å…¥è¯­å¥</th>
<th align="left">è§£æè·¯å¾„</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>&quot;@components/*&quot;</code><br><code>[&quot;components/*&quot;]</code></td>
<td align="left"><code>import Button from &#39;@components/Button&#39;</code></td>
<td align="left"><code>./src/components/Button.ts</code></td>
</tr>
<tr>
<td align="left"><code>&quot;@utils&quot;</code><br><code>[&quot;utils/index&quot;]</code></td>
<td align="left"><code>import &#123; log &#125; from &#39;@utils&#39;</code></td>
<td align="left"><code>./src/utils/index.ts</code></td>
</tr>
<tr>
<td align="left"><code>&quot;shared/*&quot;</code><br><code>[&quot;../shared/*&quot;]</code></td>
<td align="left"><code>import config from &#39;shared/config&#39;</code></td>
<td align="left"><code>../shared/config.ts</code></td>
</tr>
</tbody></table>
<p><strong>è·¯å¾„æ˜ å°„ç±»å‹å£°æ˜</strong></p>
<p>åœºæ™¯ï¼šä¸ºè·¯å¾„æ˜ å°„æä¾›ç±»å‹æ”¯æŒ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// src/global.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'@components/*'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ComponentType <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> component<span class="token operator">:</span> ComponentType<span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> component<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'@utils'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹æœ€ä½³å®è·µ</strong></p>
<ol>
<li>åŸºç¡€è·¯å¾„é…ç½®ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"src"</span><span class="token punctuation">,</span> <span class="token comment">// æ‰€æœ‰éç»å¯¹è·¯å¾„ç›¸å¯¹srcè§£æ</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
import utils from 'utils'; <span class="token comment">// è§£æä¸º src/utils.ts</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¤šè·¯å¾„æ˜ å°„æ¨¡å¼ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// å¤šè·¯å¾„å›é€€</span>
    <span class="token property">"@services/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"services/v2/*"</span><span class="token punctuation">,</span> <span class="token comment">// ä¼˜å…ˆå°è¯•v2</span>
      <span class="token string">"services/v1/*"</span>  <span class="token comment">// å›é€€åˆ°v1</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é€šé…ç¬¦æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"@assets/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"assets/*"</span><span class="token punctuation">,</span> <span class="token string">"assets/images/*"</span><span class="token punctuation">]</span> <span class="token comment">// å¤šç›®å½•æ˜ å°„</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>ç»å¯¹è·¯å¾„æ˜ å°„ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"src/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src/*"</span><span class="token punctuation">]</span> <span class="token comment">// å…è®¸ import from 'src/components'</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è·¯å¾„æ˜ å°„ä¸æ‰“åŒ…å™¨é›†æˆ</strong></p>
<p>Webpack é…ç½®ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">'@components'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/components'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string-property property">'@utils'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/utils'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Vite é…ç½®ï¼š</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// vite.config.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineConfig <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vite'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">alias</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token string-property property">'@'</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜1ï¼šè·¯å¾„æ˜ å°„åœ¨è¿è¡Œæ—¶å¤±æ•ˆ</p>
<p>åŸå› ï¼šTypeScript åªå¤„ç†ç¼–è¯‘æ—¶è·¯å¾„ï¼Œè¿è¡Œæ—¶éœ€æ‰“åŒ…å™¨æ”¯æŒ</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®‰è£…è·¯å¾„è½¬æ¢å·¥å…·</span>
<span class="token function">npm</span> <span class="token function">install</span> tsconfig-paths --save-dev

<span class="token comment"># è¿è¡Œæ—¶åŠ è½½</span>
<span class="token function">node</span> <span class="token parameter variable">-r</span> tsconfig-paths/register app.ts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜2ï¼šå¾ªç¯ä¾èµ–è­¦å‘Š</p>
<p>åœºæ™¯ï¼š</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">src/
  components/
    Button.ts  // import &#123; theme &#125; from '@utils'
  utils/
    index.ts   // import &#123; Button &#125; from '@components'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>é‡æ„æå–å…¬å…±æ¨¡å—</li>
<li>ä½¿ç”¨ä¾èµ–æ³¨å…¥</li>
<li>åŠ¨æ€å¯¼å…¥æ‰“ç ´å¾ªç¯</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// utils/index.ts</span>
<span class="token keyword">let</span> Button<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Button<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Button <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@components/Button'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> Button<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜3ï¼šå£°æ˜æ–‡ä»¶ç¼ºå¤±</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä¸ºè·¯å¾„æ˜ å°„åˆ›å»ºå£°æ˜æ–‡ä»¶</span>
<span class="token comment">// src/path-mappings.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'@components/*'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> component<span class="token operator">:</span> React<span class="token punctuation">.</span>ComponentType<span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> component<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'@utils'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§è·¯å¾„æ˜ å°„æŠ€æœ¯</strong></p>
<ol>
<li>æ¡ä»¶è·¯å¾„æ˜ å°„ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"config"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"config/production"</span><span class="token punctuation">,</span> <span class="token comment">// ç”Ÿäº§ç¯å¢ƒ</span>
      <span class="token string">"config/development"</span> <span class="token comment">// å¼€å‘ç¯å¢ƒ</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¤šé¡¹ç›®å…±äº«æ˜ å°„ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// åŸºåº§é¡¹ç›® tsconfig.base.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"@shared/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"../shared/*"</span><span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å­é¡¹ç›® tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"../tsconfig.base.json"</span><span class="token punctuation">,</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"src"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è·¯å¾„æ˜ å°„é‡å®šå‘ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"old-module"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"new-module"</span><span class="token punctuation">]</span> <span class="token comment">// é‡å®šå‘æ—§è·¯å¾„</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è·¯å¾„æ˜ å°„è§„èŒƒæŒ‡å—</strong></p>
<ol>
<li>ç»Ÿä¸€å‰ç¼€çº¦å®šï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">@app/      // åº”ç”¨æ ¸å¿ƒä»£ç 
@lib/      // å…¬å…±åº“
@assets/   // é™æ€èµ„æº
@test/     // æµ‹è¯•å·¥å…·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç¦æ­¢æ·±å±‚ç›¸å¯¹è·¯å¾„ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¦ç”¨</span>
<span class="token keyword">import</span> util <span class="token keyword">from</span> <span class="token string">'../../../../utils'</span><span class="token punctuation">;</span>

<span class="token comment">// å¯ç”¨</span>
<span class="token keyword">import</span> util <span class="token keyword">from</span> <span class="token string">'@core/utils'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ˜ å°„è·¯å¾„é•¿åº¦é™åˆ¶ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// ä¼˜å…ˆä½¿ç”¨çŸ­è·¯å¾„</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"@c"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"components"</span><span class="token punctuation">]</span> <span class="token comment">// ä¸æ¨èï¼šè¿‡äºç®€çŸ­</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æ–‡æ¡£åŒ–æ˜ å°„è§„åˆ™ï¼š</li>
</ol>
<p>è·¯å¾„æ˜ å°„è§„èŒƒï¼š</p>
<table>
<thead>
<tr>
<th align="left">æ˜ å°„è·¯å¾„</th>
<th align="left">å®é™…è·¯å¾„</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">@components&#x2F;*</td>
<td align="left">src&#x2F;components&#x2F;*</td>
<td align="left">å…¨å±€ç»„ä»¶</td>
</tr>
<tr>
<td align="left">@utils</td>
<td align="left">src&#x2F;utils&#x2F;index.ts</td>
<td align="left">å·¥å…·å‡½æ•°å…¥å£</td>
</tr>
</tbody></table>
<h3 id="1-4-4-åŠ¨æ€å¯¼å…¥ä¸ä»£ç åˆ†å‰²ç±»å‹å®‰å…¨"><a href="#1-4-4-åŠ¨æ€å¯¼å…¥ä¸ä»£ç åˆ†å‰²ç±»å‹å®‰å…¨" class="headerlink" title="1.4.4 åŠ¨æ€å¯¼å…¥ä¸ä»£ç åˆ†å‰²ç±»å‹å®‰å…¨"></a>1.4.4 åŠ¨æ€å¯¼å…¥ä¸ä»£ç åˆ†å‰²ç±»å‹å®‰å…¨</h3><p><strong>åŠ¨æ€å¯¼å…¥åŸºç¡€è¯­æ³•</strong></p>
<p>æ ¸å¿ƒè¯­æ³•ï¼šimport() å‡½æ•°è¿”å› Promiseï¼Œåœ¨æ¨¡å—åŠ è½½å®Œæˆåè§£æä¸ºæ¨¡å—å¯¹è±¡</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸºæœ¬ç”¨æ³•</span>
<span class="token keyword">const</span> modulePromise <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å¸¦è·¯å¾„å˜é‡</span>
<span class="token keyword">const</span> moduleName <span class="token operator">=</span> <span class="token string">'utils'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> utilsModule <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>moduleName<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹å®‰å…¨å¤„ç†ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">MathModule</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token constant">PI</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> mathModule <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> MathModule <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">;</span>

mathModule<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>mod <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>mod<span class="token punctuation">.</span>default<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç±»å‹å®‰å…¨è®¿é—®</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä»£ç åˆ†å‰²ç±»å‹å£°æ˜</strong></p>
<ol>
<li>æ¨¡å—å£°æ˜æ–‡ä»¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// math.module.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> mathModule<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">add</span><span class="token operator">:</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token constant">PI</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> mathModule<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>åŠ¨æ€æ¨¡å—ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨æ³›å‹å®šä¹‰è¿”å›ç±»å‹</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">dynamicImport</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token generic-function"><span class="token function">dynamicImport</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> MathModule <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token operator">:</span> math <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>React åŠ¨æ€ç»„ä»¶ç±»å‹å®‰å…¨</strong></p>
<ol>
<li>React.lazy åŸºç¡€ç”¨æ³•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> LazyComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./HeavyComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">&lt;</span>div<span class="token operator">></span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">&#125;</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>LazyComponent <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¸¦å±æ€§çš„ç»„ä»¶ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// HeavyComponent.tsx</span>
<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">&#123;</span>
  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> HeavyComponent<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span>Props<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> title<span class="token punctuation">,</span> count <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">&#123;</span>title<span class="token punctuation">&#125;</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>count<span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åŠ¨æ€å¯¼å…¥</span>
<span class="token keyword">const</span> LazyComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> 
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./HeavyComponent'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>mod <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">default</span><span class="token operator">:</span> mod<span class="token punctuation">.</span>HeavyComponent
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ï¼ˆä¿ç•™å±æ€§ç±»å‹æ£€æŸ¥ï¼‰</span>
<span class="token operator">&lt;</span>LazyComponent title<span class="token operator">=</span><span class="token string">"Items"</span> count<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">5</span><span class="token punctuation">&#125;</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Vue å¼‚æ­¥ç»„ä»¶ç±»å‹</strong></p>
<ol>
<li>defineAsyncComponentï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineAsyncComponent <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> AsyncComponent <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> 
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./AsyncComponent.vue'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token operator">&lt;</span>template<span class="token operator">></span>
  <span class="token operator">&lt;</span>AsyncComponent <span class="token operator">:</span>count<span class="token operator">=</span><span class="token string">"5"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹æ¨æ–­ç»„ä»¶å±æ€§ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å£°æ˜ç»„ä»¶ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">AsyncComponentProps</span> <span class="token punctuation">&#123;</span>
  count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> AsyncComponent <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  <span class="token function-variable function">loader</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./AsyncComponent.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  loadingComponent<span class="token operator">:</span> LoadingSpinner<span class="token punctuation">,</span>
  delay<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> DefineComponent<span class="token operator">&lt;</span>AsyncComponentProps<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä»£ç åˆ†å‰²æ¨¡å¼</strong></p>
<ol>
<li>è·¯ç”±çº§åˆ†å‰²ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// React Router v6</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createBrowserRouter</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span>
    path<span class="token operator">:</span> <span class="token string">'/dashboard'</span><span class="token punctuation">,</span>
    element<span class="token operator">:</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">&lt;</span>Spinner <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">&#125;</span><span class="token operator">></span>
        <span class="token punctuation">&#123;</span><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./Dashboard'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>
    path<span class="token operator">:</span> <span class="token string">'/reports'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">lazy</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./Reports'</span><span class="token punctuation">)</span> <span class="token comment">// è‡ªåŠ¨å¤„ç†Suspense</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>åŠŸèƒ½çº§åˆ†å‰²ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æŒ‰éœ€åŠ è½½å·¥å…·åº“</span>
<span class="token keyword">function</span> <span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./heavy-utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> sortBigData <span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token function">sortBigData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ¡ä»¶åˆ†å‰²ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ¹æ®è®¾å¤‡åŠ è½½ä¸åŒæ¨¡å—</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadEditor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isMobileDevice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./mobile-editor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./desktop-editor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹å®‰å…¨ç­–ç•¥</strong></p>
<ol>
<li>åŠ¨æ€å¯¼å…¥æ³›å‹å°è£…ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// safeImport.ts</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">safeImport</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>modulePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: "[request]" */</span> modulePath<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">ChartModule</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">renderChart</span><span class="token operator">:</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token generic-function"><span class="token function">safeImport</span><span class="token generic class-name"><span class="token operator">&lt;</span>ChartModule<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'./charting-lib'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>chart <span class="token operator">=></span> chart<span class="token punctuation">.</span><span class="token function">renderChart</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¨¡å—ç±»å‹éªŒè¯ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¿è¡Œæ—¶ç±»å‹éªŒè¯</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token keyword">is</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'typescript-is'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">loadModule</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">is</span><span class="token operator">&lt;</span>PluginInterface<span class="token operator">></span><span class="token punctuation">(</span>mod<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Invalid plugin interface'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">return</span> mod<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç±»å‹æ–­è¨€è¾…åŠ©ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ›å»ºç±»å‹æ–­è¨€å‡½æ•°</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">assertModule</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>module<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">asserts</span> <span class="token keyword">module</span> <span class="token keyword">is</span> <span class="token constant">T</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> module<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Module missing required export: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">String</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./validator'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token generic-function"><span class="token function">assertModule</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> validate<span class="token operator">:</span> <span class="token builtin">Function</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>mod<span class="token punctuation">,</span> <span class="token string">'validate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mod<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨è°ƒç”¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Webpack é­”æ³•æ³¨é‡Š</strong></p>
<ol>
<li>åŸºç¡€æ³¨é‡Šï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å‘½åä»£ç å—</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: "math" */</span> <span class="token string">'./math'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// é¢„è·å–</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">'./prefetch-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// é¢„åŠ è½½</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span> <span class="token string">'./critical-module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç»„åˆä½¿ç”¨ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç”Ÿäº§ç¯å¢ƒå¯ç”¨é¢„å–</span>
<span class="token keyword">const</span> isProd <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> comments <span class="token operator">=</span> isProd <span class="token operator">?</span> <span class="token string">'webpackPrefetch: true'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: "utils", $&#123;comments&#125; */</span> <span class="token string">'./utils'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>ä»£ç åˆ†å‰²ç­–ç•¥ï¼š</li>
</ol>
<table>
<thead>
<tr>
<th align="left">åˆ†å‰²ç²’åº¦</th>
<th align="left">é€‚åˆåœºæ™¯</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">è·¯ç”±çº§</td>
<td align="left">SPAåº”ç”¨</td>
<td align="left"><code>lazy(() =&gt; import(&#39;./page&#39;))</code></td>
</tr>
<tr>
<td align="left">ç»„ä»¶çº§</td>
<td align="left">å¤§å‹ç»„ä»¶&#x2F;ä¸‰æ–¹ç»„ä»¶</td>
<td align="left"><code>const Heavy = lazy(() =&gt; import(...))</code></td>
</tr>
<tr>
<td align="left">åº“çº§</td>
<td align="left">ç¬¬ä¸‰æ–¹å¤§ä½“ç§¯åº“</td>
<td align="left"><code>import(&#39;lodash/debounce&#39;)</code></td>
</tr>
<tr>
<td align="left">åŠŸèƒ½çº§</td>
<td align="left">éé¦–å±å…³é”®åŠŸèƒ½</td>
<td align="left">ç‚¹å‡»ååŠ è½½ç¼–è¾‘å™¨æ¨¡å—</td>
</tr>
</tbody></table>
<ol start="2">
<li>åŠ è½½çŠ¶æ€ç®¡ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è‡ªå®šä¹‰åŠ è½½çŠ¶æ€</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useLazyModule</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function-variable function">loader</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>module<span class="token punctuation">,</span> setModule<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>loading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>error<span class="token punctuation">,</span> setError<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>Error <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token function">loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>setModule<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>setError<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setLoading</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> module<span class="token punctuation">,</span> loading<span class="token punctuation">,</span> error <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> module<span class="token operator">:</span> math<span class="token punctuation">,</span> loading <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">useLazyModule</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> 
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>m <span class="token operator">=></span> m<span class="token punctuation">.</span>default<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é”™è¯¯è¾¹ç•Œå¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// React é”™è¯¯è¾¹ç•Œ</span>
<span class="token keyword">class</span> <span class="token class-name">LazyErrorBoundary</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component <span class="token punctuation">&#123;</span>
  state <span class="token operator">=</span> <span class="token punctuation">&#123;</span> hasError<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> hasError<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hasError<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>FallbackUI <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token operator">&lt;</span>LazyErrorBoundary<span class="token operator">></span>
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">&lt;</span>Spinner <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">&#125;</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>LazyComponent <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>LazyErrorBoundary<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</strong></p>
<ol>
<li>é¢„åŠ è½½å…³é”®æ¨¡å—ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é¦–å±æ¸²æŸ“åé¢„åŠ è½½</span>
<span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./next-page'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token builtin">console</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ‰¹é‡åŠ è½½ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŒæ—¶åŠ è½½å¤šä¸ªæ¨¡å—</span>
<span class="token keyword">const</span> <span class="token function-variable function">loadDashboardModules</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./chart'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./stats'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./recent-activity'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token function">loadDashboardModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>chart<span class="token punctuation">,</span> stats<span class="token punctuation">,</span> activity<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  chart<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  stats<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è¯·æ±‚åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨Webpacké­”æ³•æ³¨é‡Šåˆå¹¶è¯·æ±‚</span>
<span class="token keyword">const</span> <span class="token function-variable function">getEditor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackMode: "lazy-once" */</span> <span class="token string">'./editor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸åŒåœ°æ–¹è°ƒç”¨åªåŠ è½½ä¸€æ¬¡</span>
button1<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">getEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button2<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">getEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹å®‰å…¨é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é™·é˜±1ï¼šæ¨¡å—ç±»å‹æ¼‚ç§»</p>
<p>ç°è±¡ï¼šæ¨¡å—æ›´æ–°åç±»å‹ä¸åŒ¹é…</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç‰ˆæœ¬åŒ–ç±»å‹å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'./chart'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ChartV2</span> <span class="token punctuation">&#123;</span>
    <span class="token function">newMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">const</span> chart<span class="token operator">:</span> ChartV2<span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> chart<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™·é˜±2ï¼šåŠ¨æ€è·¯å¾„ç±»å‹ä¸¢å¤±</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è·¯å¾„æ˜ å°„ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ModulePaths</span> <span class="token operator">=</span> 
  <span class="token operator">|</span> <span class="token string">'./math'</span> 
  <span class="token operator">|</span> <span class="token string">'./chart'</span> 
  <span class="token operator">|</span> <span class="token string">'./utils'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">loadModule</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>path<span class="token operator">:</span> ModulePaths<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é™·é˜±3ï¼šCJS&#x2F;ESM äº’æ“ä½œé—®é¢˜</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç»Ÿä¸€å°è£…</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadCompatModule</span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> mod<span class="token punctuation">.</span>default <span class="token operator">||</span> mod<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="äºŒã€é«˜çº§ç±»å‹ç³»ç»Ÿ"><a href="#äºŒã€é«˜çº§ç±»å‹ç³»ç»Ÿ" class="headerlink" title="äºŒã€é«˜çº§ç±»å‹ç³»ç»Ÿ"></a>äºŒã€é«˜çº§ç±»å‹ç³»ç»Ÿ</h1><h2 id="2-1-å·¥å…·ç±»å‹åŸç†"><a href="#2-1-å·¥å…·ç±»å‹åŸç†" class="headerlink" title="2.1 å·¥å…·ç±»å‹åŸç†"></a>2.1 å·¥å…·ç±»å‹åŸç†</h2><h3 id="2-1-1-å†…ç½®å·¥å…·ç±»å‹æºç è§£æ"><a href="#2-1-1-å†…ç½®å·¥å…·ç±»å‹æºç è§£æ" class="headerlink" title="2.1.1 å†…ç½®å·¥å…·ç±»å‹æºç è§£æ"></a>2.1.1 å†…ç½®å·¥å…·ç±»å‹æºç è§£æ</h3><p>TypeScript å†…ç½®å·¥å…·ç±»å‹é€šè¿‡æ¡ä»¶ç±»å‹å’Œæ˜ å°„ç±»å‹å®ç°</p>
<p><strong>åŸºç¡€å·¥å…·ç±»å‹</strong></p>
<ol>
<li><code>Partial&lt;T&gt;</code>ï¼šå°†ç±»å‹ T çš„æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ˜ å°„ç±»å‹ + ? ä¿®é¥°ç¬¦</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name">PartialUser</span> <span class="token operator">=</span> Partial<span class="token operator">&lt;</span>User<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; name?: string; age?: number &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>Required&lt;T&gt;</code>ï¼šå°†ç±»å‹ T çš„æ‰€æœ‰å±æ€§å˜ä¸ºå¿…å¡«</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Required<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ˜ å°„ç±»å‹ + -? ç§»é™¤å¯é€‰ä¿®é¥°ç¬¦</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">RequiredUser</span> <span class="token operator">=</span> Required<span class="token operator">&lt;</span>PartialUser<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: string; age: number &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><code>Readonly&lt;T&gt;</code>ï¼šå°†ç±»å‹ T çš„æ‰€æœ‰å±æ€§å˜ä¸ºåªè¯»</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Readonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ˜ å°„ç±»å‹ + readonly ä¿®é¥°ç¬¦</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ReadonlyUser</span> <span class="token operator">=</span> Readonly<span class="token operator">&lt;</span>User<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; readonly name: string; readonly age: number &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>ç»“æ„æ“ä½œå·¥å…·ç±»å‹</strong></p>
<ol>
<li><code>Pick&lt;T, K extends keyof T&gt;</code>: ä»ç±»å‹ T ä¸­é€‰å–æŒ‡å®šå±æ€§ K</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ˜ å°„ç±»å‹ + é”®åçº¦æŸ</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NameOnly</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li><code>Omit&lt;T, K extends keyof any&gt;</code>: ä»ç±»å‹ T ä¸­æ’é™¤æŒ‡å®šå±æ€§ K</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token builtin">any</span><span class="token operator">></span></span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Exclude<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">>></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šç»„åˆ Pick å’Œ Exclude</li>
<li>æºç ä¾èµ–ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">WithoutAge</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><code>Record&lt;K extends keyof any, T&gt;</code>: åˆ›å»ºé”®ä¸º Kã€å€¼ä¸º T çš„ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Record<span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token builtin">any</span><span class="token punctuation">,</span> <span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šåŠ¨æ€é”®æ˜ å°„</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">UserMap</span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> User<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; [key: string]: User &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>ç±»å‹æ“ä½œå·¥å…·ç±»å‹</strong></p>
<ol>
<li><code>Exclude&lt;T, U&gt;</code>: ä» T ä¸­æ’é™¤å¯åˆ†é…ç»™ U çš„ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ¡ä»¶ç±»å‹ + never</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T0</span></span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "b" | "c"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li><code>Extract&lt;T, U&gt;</code>: ä» T ä¸­æå–å¯åˆ†é…ç»™ U çš„ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Extract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ¡ä»¶ç±»å‹åå‘æ“ä½œ</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T1</span></span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"f"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "a"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><code>NonNullable&lt;T&gt;</code>: ä» T ä¸­æ’é™¤ null å’Œ undefined</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">null</span></span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ¡ä»¶ç±»å‹è¿‡æ»¤</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T2</span></span> <span class="token operator">=</span> NonNullable<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>å‡½æ•°æ“ä½œå·¥å…·ç±»å‹</strong></p>
<ol>
<li><code>Parameters&lt;T extends (...args: any) =&gt; any&gt;</code>: è·å–å‡½æ•°å‚æ•°ç±»å‹å…ƒç»„</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Parameters<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šinfer æ¨å¯¼å‚æ•°ç±»å‹</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">FnParams</span> <span class="token operator">=</span> Parameters<span class="token operator">&lt;</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// [string, number]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="2">
<li><code>ReturnType&lt;T extends (...args: any) =&gt; any&gt;</code>: è·å–å‡½æ•°è¿”å›å€¼ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šinfer æ¨å¯¼è¿”å›ç±»å‹</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">FnReturn</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">boolean</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// boolean</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><code>ConstructorParameters&lt;T extends new (...args: any) =&gt; any&gt;</code>: è·å–æ„é€ å‡½æ•°å‚æ•°ç±»å‹å…ƒç»„</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ConstructorParameters<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">new</span></span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šinfer æ¨å¯¼æ„é€ å‡½æ•°å‚æ•°</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name">Params</span> <span class="token operator">=</span> ConstructorParameters<span class="token operator">&lt;</span><span class="token keyword">typeof</span> Person<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// [string, number]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§å·¥å…·ç±»å‹</strong></p>
<ol>
<li><code>ThisParameterType&lt;T&gt;</code>: æå–å‡½æ•°çš„ this å‚æ•°ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ThisParameterType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">U</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šinfer æ•è· this ç±»å‹</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Window<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name">ThisType</span> <span class="token operator">=</span> ThisParameterType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> fn<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// Window</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>OmitThisParameter&lt;T&gt;</code>: ç§»é™¤å‡½æ•°çš„ this å‚æ•°ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">OmitThisParameter<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token builtin">unknown</span> <span class="token keyword">extends</span> <span class="token class-name">ThisParameterType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šç»„åˆ ThisParameterType + å‚æ•°æ¨å¯¼</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">WithoutThis</span> <span class="token operator">=</span> OmitThisParameter<span class="token operator">&lt;</span><span class="token keyword">typeof</span> fn<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// () => void</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><code>Awaited&lt;T&gt;</code>: é€’å½’è§£åŒ… Promise ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Awaited<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">null</span></span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token comment">// ç‰¹æ®Šå¤„ç† null/undefined</span>
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span> <span class="token function">then</span><span class="token punctuation">(</span>onfulfilled<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">F</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">&#125;</span> <span class="token operator">?</span> <span class="token comment">// æ£€æŸ¥ thenable å¯¹è±¡</span>
        <span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">V</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">?</span> 
            Awaited<span class="token operator">&lt;</span><span class="token constant">V</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token comment">// é€’å½’è§£åŒ…</span>
        <span class="token builtin">never</span> <span class="token operator">:</span> 
    <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token comment">// é Promise ç±»å‹ç›´æ¥è¿”å›</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å®ç°åŸç†ï¼šæ¡ä»¶ç±»å‹é€’å½’ + thenable æ£€æµ‹</li>
<li>ç¤ºä¾‹ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T3</span></span> <span class="token operator">=</span> Awaited<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">>>></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>æºç è®¾è®¡æ¨¡å¼åˆ†æ</strong></p>
<ol>
<li>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹</li>
</ol>
<p>å½“æ³›å‹å‚æ•°ä¸ºè”åˆç±»å‹æ—¶ï¼Œæ¡ä»¶ç±»å‹ä¼šåˆ†å¸ƒå¼åº”ç”¨ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Exclude ä¸­çš„åˆ†å¸ƒå¼ç‰¹æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span> <span class="token operator">|</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// 'c'</span>

<span class="token comment">// ç­‰ä»·äºï¼š</span>
<span class="token punctuation">(</span><span class="token string">'a'</span> <span class="token keyword">extends</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token punctuation">(</span><span class="token string">'b'</span> <span class="token keyword">extends</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token string">'b'</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token punctuation">(</span><span class="token string">'c'</span> <span class="token keyword">extends</span> <span class="token string">'a'</span> <span class="token operator">|</span> <span class="token string">'b'</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token string">'c'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹é€’å½’æ¨¡å¼</li>
</ol>
<p>å¤„ç†åµŒå¥—ç»“æ„çš„å…³é”®æŠ€æœ¯ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å†…ç½®å·¥å…·ç±»å‹ä¸­çš„é€’å½’</span>
<span class="token keyword">type</span> <span class="token class-name">DeepReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> 
    <span class="token operator">?</span> DeepReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">></span> 
    <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç±»å‹æ¨æ–­ä¼˜å…ˆçº§</li>
</ol>
<p>infer å…³é”®å­—çš„å·¥ä½œæœºåˆ¶ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åå˜ä½ç½®ï¼ˆè¿”å›å€¼ï¼‰æ¨æ–­</span>
<span class="token keyword">type</span> <span class="token class-name">GetReturnType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>

<span class="token comment">// é€†å˜ä½ç½®ï¼ˆå‚æ•°ï¼‰æ¨æ–­</span>
<span class="token keyword">type</span> <span class="token class-name">GetFirstArg<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">A</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µè¦ç‚¹</strong></p>
<ol>
<li>é¿å…è¿‡åº¦åµŒå¥—ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å±é™©ï¼šæ·±å±‚åµŒå¥—å¯èƒ½å¯¼è‡´ç±»å‹å®ä¾‹åŒ–è¿‡æ·±é”™è¯¯</span>
<span class="token keyword">type</span> <span class="token class-name">DeepNested</span> <span class="token operator">=</span> Awaited<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">>>></span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// è§£å†³æ–¹æ¡ˆï¼šè®¾ç½®é€’å½’æ·±åº¦é™åˆ¶</span>
<span class="token keyword">type</span> <span class="token class-name">SafeAwaited<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Depth <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  Depth <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span>
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> SafeAwaited<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span>Depth<span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¼˜åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨å†…ç½®å·¥å…·ç±»å‹æ›¿ä»£è‡ªå®šä¹‰å¤æ‚ç±»å‹</span>
<span class="token comment">// ä¸æ¨èï¼š</span>
<span class="token keyword">type</span> <span class="token class-name">MyPartial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// æ¨èï¼šç›´æ¥ä½¿ç”¨ Partial</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç±»å‹å®‰å…¨æ£€æŸ¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¡®ä¿å·¥å…·ç±»å‹å®‰å…¨</span>
<span class="token keyword">type</span> <span class="token class-name">SafeExtract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token constant">U</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// é˜²æ­¢åˆ†å¸ƒå¼è¡Œä¸º</span>
<span class="token keyword">type</span> <span class="token class-name">DistributiveCheck<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">never</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æºç è°ƒè¯•æŠ€å·§ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨ç±»å‹æ‰“å°è°ƒè¯•</span>
<span class="token keyword">type</span> <span class="token class-name">_Debug<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">infer</span></span> <span class="token constant">U</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Reveal<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// æŸ¥çœ‹å®é™…ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">DebugView</span> <span class="token operator">=</span> Reveal<span class="token operator">&lt;</span>SomeComplexType<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å†…ç½®å·¥å…·ç±»å‹å…³ç³»å›¾</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">åŸºç¡€æ“ä½œ
â”œâ”€ Partial
â”œâ”€ Required
â”œâ”€ Readonly
â”‚
ç»“æ„æ“ä½œ
â”œâ”€ Pick
â”œâ”€ Omit â†’ ä¾èµ– Exclude
â”œâ”€ Record
â”‚
é›†åˆæ“ä½œ
â”œâ”€ Exclude
â”œâ”€ Extract
â”œâ”€ NonNullable
â”‚
å‡½æ•°æ“ä½œ
â”œâ”€ Parameters
â”œâ”€ ReturnType
â”œâ”€ ConstructorParameters
â”œâ”€ ThisParameterType
â””â”€ OmitThisParameter<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-1-2-ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ï¼ˆ-ï¼‰åŸç†"><a href="#2-1-2-ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ï¼ˆ-ï¼‰åŸç†" class="headerlink" title="2.1.2 ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ï¼ˆ+&#x2F;-ï¼‰åŸç†"></a>2.1.2 ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ï¼ˆ+&#x2F;-ï¼‰åŸç†</h3><p><strong>ä¿®é¥°ç¬¦åŸºç¡€æ¦‚å¿µ</strong></p>
<p>ç±»å‹æ˜ å°„ä¿®é¥°ç¬¦ç”¨äºæ§åˆ¶å±æ€§ä¿®é¥°ç¬¦ï¼ˆ? å’Œ readonlyï¼‰çš„æ·»åŠ æˆ–ç§»é™¤ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ä¿®é¥°ç¬¦</th>
<th align="left">ä½œç”¨</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">+</td>
<td align="left">æ·»åŠ ä¿®é¥°ç¬¦ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</td>
<td align="left"><code>&#123; +readonly [P in K]: T &#125;</code></td>
</tr>
<tr>
<td align="left">-</td>
<td align="left">ç§»é™¤ä¿®é¥°ç¬¦</td>
<td align="left"><code>&#123; -? [P in K]: T &#125;</code></td>
</tr>
</tbody></table>
<p><strong>æ ¸å¿ƒè¯­æ³•è§£æ</strong></p>
<ol>
<li>æ·»åŠ ä¿®é¥°ç¬¦ï¼ˆæ˜¾å¼+ï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ˜¾å¼æ·»åŠ åªè¯»å±æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">AddReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">+</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// æ˜¾å¼æ·»åŠ å¯é€‰å±æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">AddOptional<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç§»é™¤ä¿®é¥°ç¬¦ï¼ˆ-ï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç§»é™¤åªè¯»å±æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">RemoveReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ç§»é™¤å¯é€‰å±æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">RemoveOptional<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å®ç°åŸç†åˆ†æ</strong></p>
<ol>
<li>ä¿®é¥°ç¬¦çš„ç¼–è¯‘è½¬æ¢ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æºç ï¼š</span>
<span class="token keyword">type</span> <span class="token class-name">Mutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ç¼–è¯‘åç­‰ä»·äºï¼š</span>
<span class="token keyword">type</span> <span class="token class-name">Mutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹ç³»ç»Ÿå†…éƒ¨å¤„ç†ï¼š<ul>
<li><code>+</code> æ“ä½œï¼šæ·»åŠ å±æ€§æè¿°ç¬¦æ ‡å¿—</li>
<li><code>-</code> æ“ä½œï¼šæ¸…é™¤å±æ€§æè¿°ç¬¦æ ‡å¿—</li>
<li>æ˜ å°„è¿‡ç¨‹æœ¬è´¨æ˜¯åˆ›å»ºæ–°å±æ€§æè¿°ç¬¦</li>
</ul>
</li>
</ol>
<p><strong>å†…ç½®å·¥å…·ç±»å‹åº”ç”¨</strong></p>
<ol>
<li><code>Required&lt;T&gt;</code> å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Required<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>Readonly&lt;T&gt;</code> å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Readonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">+</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><code>Mutable&lt;T&gt;</code>ï¼ˆéå†…ç½®ä½†å¸¸ç”¨ï¼‰ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Mutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»„åˆä¿®é¥°ç¬¦æŠ€å·§</strong></p>
<ol>
<li>åŒæ—¶æ·»åŠ &#x2F;ç§»é™¤å¤šä¸ªä¿®é¥°ç¬¦ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ›å»ºå¯å˜ä¸”å¿…å¡«çš„ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">MutableRequired<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ç­‰ä»·äºï¼š</span>
<span class="token keyword">type</span> <span class="token class-name">MutableRequired<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> Mutable<span class="token operator">&lt;</span>Required<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶ä¿®é¥°ç¬¦ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä»…å¯¹å‡½æ•°å±æ€§æ·»åŠ åªè¯»</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyMethods<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span> <span class="token operator">?</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span> <span class="token keyword">as</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µæŒ‡å—</strong></p>
<ol>
<li>ä¸å¯å˜çŠ¶æ€ç®¡ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ›å»ºæ·±åº¦åªè¯»çŠ¶æ€</span>
<span class="token keyword">type</span> <span class="token class-name">ImmutableState<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">+</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> ImmutableState<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">AppState</span> <span class="token punctuation">&#123;</span>
  user<span class="token operator">:</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  settings<span class="token operator">:</span> <span class="token punctuation">&#123;</span> darkMode<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> state<span class="token operator">:</span> ImmutableState<span class="token operator">&lt;</span>AppState<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  user<span class="token operator">:</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Alice"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  settings<span class="token operator">:</span> <span class="token punctuation">&#123;</span> darkMode<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Bob"</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç¼–è¯‘é”™è¯¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>API å“åº”å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç§»é™¤APIå“åº”ä¸­çš„å¯é€‰å±æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">ConcreteResponse<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">ApiResponse</span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
  error<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span>res<span class="token operator">:</span> ConcreteResponse<span class="token operator">&lt;</span>ApiResponse<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// res.data å’Œ res.error ä¸€å®šå­˜åœ¨</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å®‰å…¨è¡¥ä¸ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ›å»ºéƒ¨åˆ†æ›´æ–°ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">SafePatch<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> Partial<span class="token operator">&lt;</span>Mutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// ä¿æŒIDåªè¯»</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">Product</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">const</span> update<span class="token operator">:</span> SafePatch<span class="token operator">&lt;</span>Product<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token string">"p1"</span><span class="token punctuation">,</span> <span class="token comment">// âœ… å…è®¸ï¼ˆä½†å®é™…ä¸èƒ½ä¿®æ”¹ï¼‰</span>
  name<span class="token operator">:</span> <span class="token string">"New Name"</span> <span class="token comment">// âœ…</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ€§èƒ½ä¼˜åŒ–æŠ€å·§</strong></p>
<ol>
<li>é¿å…æ·±åº¦é€’å½’ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é™åˆ¶é€’å½’æ·±åº¦</span>
<span class="token keyword">type</span> <span class="token class-name">DeepReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Depth <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  Depth <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">?</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> DeepReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>Depth<span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶çŸ­è·¯ä¼˜åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">OptimizedMutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">readonly</span></span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>OptimizedMutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">>></span> <span class="token operator">:</span>
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">?</span> <span class="token punctuation">&#123;</span> <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> OptimizedMutable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">&#125;</span> <span class="token operator">:</span>
  <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç¼–è¯‘åŸç†é€è§†</strong></p>
<ol>
<li>ä¿®é¥°ç¬¦çš„ AST è¡¨ç¤ºï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// TypeScript AST èŠ‚ç‚¹ç¤ºä¾‹</span>
<span class="token keyword">interface</span> <span class="token class-name">MappingModifier</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">+</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ ä¿®é¥°ç¬¦</span>
  <span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// ç§»é™¤ä¿®é¥°ç¬¦</span>
  <span class="token keyword">readonly</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token string">"+"</span> <span class="token operator">|</span> <span class="token string">"-"</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  optional<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">"+"</span> <span class="token operator">|</span> <span class="token string">"-"</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹å®ä¾‹åŒ–æµç¨‹ï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1. è§£ææ˜ å°„è¯­æ³•
2. è·å–æºç±»å‹å±æ€§æè¿°ç¬¦
3. åº”ç”¨ä¿®é¥°ç¬¦æ“ä½œï¼ˆ+/-ï¼‰
4. åˆ›å»ºæ–°å±æ€§æè¿°ç¬¦
5. ç»„åˆä¸ºæ–°å¯¹è±¡ç±»å‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜ï¼šä¿®é¥°ç¬¦å¯¹æ–¹æ³•æ— æ•ˆ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token comment">// æ–¹æ³•æœ¬è´¨æ˜¯åªè¯»çš„</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T</span></span> <span class="token operator">=</span> Mutable<span class="token operator">&lt;</span>Test<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// ä»ç„¶åªè¯»</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">MutableMethods<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Function</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜ï¼šä¿®é¥°ç¬¦ä¸äº¤å‰ç±»å‹å†²çª</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token keyword">readonly</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">B</span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token operator">=</span> <span class="token constant">A</span> <span class="token operator">&amp;</span> <span class="token constant">B</span><span class="token punctuation">;</span> <span class="token comment">// id å˜ä¸º stringï¼ˆåªè¯»è¢«è¦†ç›–ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">EnforceReadonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">SafeMerge<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token constant">B</span><span class="token operator">></span></span> <span class="token operator">=</span> EnforceReadonly<span class="token operator">&lt;</span><span class="token constant">A</span><span class="token operator">></span> <span class="token operator">&amp;</span> EnforceReadonly<span class="token operator">&lt;</span><span class="token constant">B</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜ï¼šæ•°ç»„å’Œå…ƒç»„å¤„ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å…ƒç»„å¯å˜åŒ–</span>
<span class="token keyword">type</span> <span class="token class-name">MutableTuple<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">readonly</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token operator">-</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> arr<span class="token operator">:</span> MutableTuple<span class="token operator">&lt;</span><span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¿®é¥°ç¬¦ä¸å†…ç½®å·¥å…·ç±»å‹å…³ç³»</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">æ˜ å°„ä¿®é¥°ç¬¦ä½“ç³»
â”œâ”€ æ·»åŠ æ“ä½œ (+)
â”‚  â”œâ”€ +readonly â†’ Readonly&lt;T>
â”‚  â””â”€ +? â†’ Partial&lt;T>
â”‚
â””â”€ ç§»é™¤æ“ä½œ (-)
   â”œâ”€ -readonly â†’ Mutable&lt;T>
   â””â”€ -? â†’ Required&lt;T><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-1-3-æ¡ä»¶ç±»å‹åˆ†å¸ƒå¼ç‰¹æ€§"><a href="#2-1-3-æ¡ä»¶ç±»å‹åˆ†å¸ƒå¼ç‰¹æ€§" class="headerlink" title="2.1.3 æ¡ä»¶ç±»å‹åˆ†å¸ƒå¼ç‰¹æ€§"></a>2.1.3 æ¡ä»¶ç±»å‹åˆ†å¸ƒå¼ç‰¹æ€§</h3><p><strong>åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹æ ¸å¿ƒæ¦‚å¿µ</strong></p>
<p>è§¦å‘æ¡ä»¶ï¼šå½“æ¡ä»¶ç±»å‹ä½œç”¨äºè£¸ç±»å‹å‚æ•°ï¼ˆnaked type parameterï¼‰çš„è”åˆç±»å‹æ—¶ï¼Œä¼šè§¦å‘åˆ†å¸ƒå¼è¡Œä¸º</p>
<p>åŸºæœ¬æ¨¡å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">X</span> <span class="token operator">:</span> <span class="token constant">Y</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>T æ˜¯è£¸ç±»å‹å‚æ•°ï¼ˆæœªåŒ…è£¹åœ¨æ•°ç»„ã€å…ƒç»„æˆ–å‡½æ•°ä¸­ï¼‰</li>
<li>T æ˜¯è”åˆç±»å‹ A | B | C</li>
<li>ç»“æœç­‰ä»·äº (A extends U ? X : Y) | (B extends U ? X : Y) | (C extends U ? X : Y)</li>
</ul>
<p><strong>åˆ†å¸ƒå¼è¡Œä¸ºè§£æ</strong></p>
<ol>
<li>åŸºç¡€ç¤ºä¾‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">StringOrNumber<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> <span class="token string">"string"</span> <span class="token operator">:</span> <span class="token string">"number"</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ†å¸ƒå¼è®¡ç®—</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> StringOrNumber<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">;</span> 
<span class="token comment">// ç­‰ä»·äºï¼š</span>
<span class="token comment">// ("a" extends string ? "string" : "number") |</span>
<span class="token comment">// (1 extends string ? "string" : "number")</span>
<span class="token comment">// â†’ "string" | "number"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>éåˆ†å¸ƒå¼å¯¹æ¯”ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŒ…è£¹ç±»å‹å‚æ•°ï¼ˆéè£¸ç±»å‹ï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">Wrapped<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token string">"string"</span> <span class="token operator">:</span> <span class="token string">"number"</span><span class="token punctuation">;</span>

<span class="token comment">// éåˆ†å¸ƒå¼è®¡ç®—</span>
<span class="token keyword">type</span> <span class="token class-name">Result2</span> <span class="token operator">=</span> Wrapped<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// ç­‰ä»·äºï¼š</span>
<span class="token comment">// ["a" | 1] extends [string] ? "string" : "number"</span>
<span class="token comment">// â†’ "number"ï¼ˆå› ä¸º ["a" | 1] ä¸ç»§æ‰¿ [string]ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>åˆ†å¸ƒå¼è§„åˆ™è¯¦è§£</strong></p>
<ol>
<li>ç©ºè”åˆç±»å‹å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Test<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Test<span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// neverï¼ˆç©ºè”åˆç±»å‹è¿”å›neverï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="2">
<li>è”åˆç±»å‹åŒ…å«neverï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Test<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Test<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token builtin">never</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// trueï¼ˆneverè¢«å¿½ç•¥ï¼‰</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li>è”åˆç±»å‹ä¼˜å…ˆçº§ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Test<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Test<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// string | number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>å†…ç½®å·¥å…·ç±»å‹åº”ç”¨</strong></p>
<ol>
<li><code>Exclude&lt;T, U&gt;</code>ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Exclude<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ†å¸ƒå¼è®¡ç®—</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Exclude<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// â†’ ("a" extends "a"|"b" ? never : "a") |</span>
<span class="token comment">//   ("b" extends "a"|"b" ? never : "b") |</span>
<span class="token comment">//   ("c" extends "a"|"b" ? never : "c")</span>
<span class="token comment">// â†’ never | never | "c" â†’ "c"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>Extract&lt;T, U&gt;</code>ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Extract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ†å¸ƒå¼è®¡ç®—</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Extract<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// â†’ ("a" extends string ? "a" : never) |</span>
<span class="token comment">//   ("b" extends string ? "b" : never) |</span>
<span class="token comment">//   (1 extends string ? 1 : never)</span>
<span class="token comment">// â†’ "a" | "b" | never â†’ "a" | "b"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><code>NonNullable&lt;T&gt;</code>ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NonNullable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">null</span></span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ†å¸ƒå¼è®¡ç®—</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> NonNullable<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// â†’ (string extends null|undefined ? never : string) |</span>
<span class="token comment">//   (null extends null|undefined ? never : null) |</span>
<span class="token comment">//   (undefined extends null|undefined ? never : undefined)</span>
<span class="token comment">// â†’ string | never | never â†’ string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¿å…åˆ†å¸ƒå¼è¡Œä¸º</strong></p>
<ol>
<li>åŒ…è£¹ç±»å‹å‚æ•°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ–¹æ³•1ï¼šå…ƒç»„åŒ…è£¹</span>
<span class="token keyword">type</span> <span class="token class-name">NoDistribute<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// æ–¹æ³•2ï¼šæ•°ç»„åŒ…è£¹</span>
<span class="token keyword">type</span> <span class="token class-name">NoDistribute2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// æ–¹æ³•3ï¼šå‡½æ•°åŒ…è£¹</span>
<span class="token keyword">type</span> <span class="token class-name">NoDistribute3<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç‰¹æ®Šç±»å‹çº¦æŸï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨neverçº¦æŸ</span>
<span class="token keyword">type</span> <span class="token class-name">IsNever<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">never</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨anyçº¦æŸ</span>
<span class="token keyword">type</span> <span class="token class-name">IsAny<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§åº”ç”¨åœºæ™¯</strong></p>
<ol>
<li>è”åˆç±»å‹è¿‡æ»¤ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è¿‡æ»¤å‡ºå‡½æ•°ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">FilterFunctions<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Functions</span> <span class="token operator">=</span> FilterFunctions<span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// () => void</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹å·®å¼‚æ£€æµ‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ£€æµ‹ç±»å‹å·®å¼‚</span>
<span class="token keyword">type</span> <span class="token class-name">Diff<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">MissingProps</span> <span class="token operator">=</span> Diff<span class="token operator">&lt;</span><span class="token string">"name"</span> <span class="token operator">|</span> <span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token keyword">keyof</span> User<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// Userä¸­ç¼ºå¤±çš„å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é€’å½’ç±»å‹æ“ä½œï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è”åˆç±»å‹è½¬å…ƒç»„ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">UnionToTuple<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">:</span> <span class="token builtin">never</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">U</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>åˆ†å¸ƒå¼ä¸æ˜ å°„ç±»å‹ç»“åˆ</strong></p>
<ol>
<li>åˆ†å¸ƒå¼é”®åé‡æ˜ å°„ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">AddPrefix<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span> <span class="token keyword">as</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">data_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">K</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> value<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name">PrefixedProps</span> <span class="token operator">=</span> AddPrefix<span class="token operator">&lt;</span>Props<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token comment">// &#123; data_id: string; data_value: number &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶é”®åè¿‡æ»¤ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä»…ä¿ç•™å­—ç¬¦ä¸²é”®</span>
<span class="token keyword">type</span> <span class="token class-name">StringKeys<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> <span class="token constant">K</span> <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Keys</span> <span class="token operator">=</span> StringKeys<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token string">"name"</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "name"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç¼–è¯‘åŸç†é€è§†</strong></p>
<ol>
<li>åˆ†å¸ƒå¼å¤„ç†æµç¨‹ï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1. è§£ææ¡ä»¶ç±»å‹ï¼šT extends U ? X : Y
2. æ£€æŸ¥Tæ˜¯å¦ä¸ºè£¸ç±»å‹å‚æ•°çš„è”åˆç±»å‹
3. è‹¥æ˜¯ï¼Œå¯¹è”åˆç±»å‹æ¯ä¸ªæˆå‘˜è¿›è¡Œç‹¬ç«‹è®¡ç®—
4. å°†è®¡ç®—ç»“æœç»„åˆä¸ºæ–°è”åˆç±»å‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹å®ä¾‹åŒ–ä¼˜åŒ–ï¼š<ul>
<li>TSç¼–è¯‘å™¨å¯¹åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹è¿›è¡Œç¼“å­˜ä¼˜åŒ–</li>
<li>ç›¸åŒç±»å‹å‚æ•°çš„è®¡ç®—ç»“æœä¼šè¢«å¤ç”¨</li>
<li>é¿å…é‡å¤è®¡ç®—æå‡æ€§èƒ½</li>
</ul>
</li>
</ol>
<p><strong>å·¥ç¨‹å®è·µæŒ‡å—</strong></p>
<ol>
<li>æ˜ç¡®è®¾è®¡æ„å›¾ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// éœ€è¦åˆ†å‘æ—¶</span>
<span class="token keyword">type</span> <span class="token class-name">Distributed<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸éœ€è¦åˆ†å‘æ—¶</span>
<span class="token keyword">type</span> <span class="token class-name">NonDistributed<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">any</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ–‡æ¡£æ³¨é‡Šè§„èŒƒï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">/**
 * æå–æ•°ç»„å…ƒç´ ç±»å‹ï¼ˆåˆ†å‘æ¨¡å¼ï¼‰
 * @template T - è”åˆç±»å‹æ•°ç»„
 * @example 
 * type Element = ElementType&lt;Array&lt;string> | Array&lt;number>>; // string | number
 */</span>
<span class="token keyword">type</span> <span class="token class-name">ElementType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ€§èƒ½ç›‘æ§ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¤æ‚ç±»å‹æ€§èƒ½æµ‹è¯•</span>
<span class="token keyword">type</span> <span class="token class-name">StressTest<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> 
  <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">prefix_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">T</span> <span class="token operator">&amp;</span> string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">_suffix</span><span class="token template-punctuation string">`</span></span> 
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// æµ‹é‡å®ä¾‹åŒ–æ—¶é—´</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token string">"type instantiation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> StressTest<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token string">"b"</span> <span class="token operator">|</span> <span class="token operator">...</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// 100+ é¡¹</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span><span class="token string">"type instantiation"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>é”™è¯¯å¤„ç†æ¨¡å¼ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®‰å…¨åˆ†å‘ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">SafeDistribute<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Fallback <span class="token operator">=</span> <span class="token builtin">never</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token builtin">never</span><span class="token punctuation">]</span> <span class="token operator">?</span> Fallback <span class="token operator">:</span>
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span> <span class="token operator">?</span> <span class="token comment">/* åˆ†å‘é€»è¾‘ */</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> SafeDistribute<span class="token operator">&lt;</span><span class="token builtin">never</span><span class="token punctuation">,</span> <span class="token string">"empty"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "empty"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>åˆ†å¸ƒå¼ç‰¹æ€§ä¸å†…ç½®å·¥å…·</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹åº”ç”¨ä½“ç³»
â”œâ”€ é›†åˆæ“ä½œ
â”‚  â”œâ”€ Excludeï¼ˆå·®é›†ï¼‰
â”‚  â”œâ”€ Extractï¼ˆäº¤é›†ï¼‰
â”‚  â””â”€ NonNullableï¼ˆè¿‡æ»¤ï¼‰
â”‚
â”œâ”€ å‡½æ•°æ“ä½œ
â”‚  â”œâ”€ Parameters
â”‚  â””â”€ ReturnType
â”‚
â””â”€ é«˜çº§å·¥å…·
   â”œâ”€ UnionToIntersection
   â””â”€ UnionToTuple<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-1-4-infer-å…³é”®å­—ä¸ç±»å‹æå–"><a href="#2-1-4-infer-å…³é”®å­—ä¸ç±»å‹æå–" class="headerlink" title="2.1.4 infer å…³é”®å­—ä¸ç±»å‹æå–"></a>2.1.4 infer å…³é”®å­—ä¸ç±»å‹æå–</h3><p><strong>infer åŸºç¡€æ¦‚å¿µ</strong></p>
<p>æ ¸å¿ƒåŠŸèƒ½ï¼šåœ¨æ¡ä»¶ç±»å‹ä¸­å£°æ˜æ³›å‹ç±»å‹å˜é‡ï¼Œç”¨äºæ¨å¯¼å’Œæ•è·ç±»å‹ä¿¡æ¯</p>
<p>åŸºæœ¬è¯­æ³•ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">infer</span></span> <span class="token constant">U</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>infer U å£°æ˜ä¸€ä¸ªç±»å‹å˜é‡ U</li>
<li>U çš„ç±»å‹ç”± TypeScript æ ¹æ®ä¸Šä¸‹æ–‡æ¨å¯¼</li>
</ul>
<p>ä½ç½®çº¦æŸï¼š</p>
<ul>
<li>åªèƒ½åœ¨æ¡ä»¶ç±»å‹çš„ extends å­å¥ä¸­ä½¿ç”¨</li>
<li>åªèƒ½å‡ºç°åœ¨åå˜ä½ç½®ï¼ˆè¿”å›å€¼ã€å±æ€§å€¼ç­‰ï¼‰</li>
</ul>
<p><strong>åŸºç¡€æå–æ¨¡å¼</strong></p>
<ol>
<li>æå–å‡½æ•°è¿”å›ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">FnReturn</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æå–å‡½æ•°å‚æ•°ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">FirstParam<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>first<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Param</span> <span class="token operator">=</span> FirstParam<span class="token operator">&lt;</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æå–æ•°ç»„å…ƒç´ ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ArrayElement<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Element</span> <span class="token operator">=</span> ArrayElement<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§æå–æŠ€æœ¯</strong></p>
<ol>
<li>é€’å½’ç±»å‹è§£åŒ…ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è§£åŒ…åµŒå¥—Promise</span>
<span class="token keyword">type</span> <span class="token class-name">Awaited<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> Awaited<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Result</span> <span class="token operator">=</span> Awaited<span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">>>></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¤šä¸ª infer å˜é‡ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–å‡½æ•°å‚æ•°å…ƒç»„</span>
<span class="token keyword">type</span> <span class="token class-name">Params<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">FnParams</span> <span class="token operator">=</span> Params<span class="token operator">&lt;</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// [string, number]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é€†å˜ä½ç½®æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–å‡½æ•°thisç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ThisType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">U</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> Window<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">type</span> <span class="token class-name">Context</span> <span class="token operator">=</span> ThisType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> fn<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// Window</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¨¡å¼åŒ¹é…æŠ€æœ¯</strong></p>
<ol>
<li>å­—ç¬¦ä¸²æ¨¡æ¿æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–æ¨¡æ¿å­—ç¬¦ä¸²å˜é‡</span>
<span class="token keyword">type</span> <span class="token class-name">ExtractVariable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">user_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">?</span> Id <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">UserId</span> <span class="token operator">=</span> ExtractVariable<span class="token operator">&lt;</span><span class="token string">"user_123"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "123"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¯¹è±¡é”®å€¼æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–ç‰¹å®šé”®çš„å€¼ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ValueOfKey<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>key <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">V</span> <span class="token punctuation">&#125;</span> <span class="token operator">?</span> <span class="token constant">V</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">NameType</span> <span class="token operator">=</span> ValueOfKey<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> age<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ¡ä»¶åˆ†æ”¯æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–æ»¡è¶³æ¡ä»¶çš„å­ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ExtractByType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">U</span></span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Strings</span> <span class="token operator">=</span> ExtractByType<span class="token operator">&lt;</span><span class="token string">"a"</span> <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "a"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å†…ç½®å·¥å…·ç±»å‹è§£æ</strong></p>
<ol>
<li><code>Parameters&lt;T&gt;</code> å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Parameters<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="2">
<li><code>ReturnType&lt;T&gt;</code> å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ReturnType<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li><code>ConstructorParameters&lt;T&gt;</code> å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ConstructorParameters<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span></span> <span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">new</span></span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹åº”ç”¨æ¨¡å¼</strong></p>
<ol>
<li>ç»„ä»¶ Props æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–Reactç»„ä»¶Propsç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ComponentProps<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>ComponentType<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">P</span><span class="token operator">></span> <span class="token operator">?</span> <span class="token constant">P</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> MyComponent<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> ComponentProps<span class="token operator">&lt;</span><span class="token keyword">typeof</span> MyComponent<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; id: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>API å“åº”å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–APIå“åº”ä¸­çš„dataå­—æ®µ</span>
<span class="token keyword">type</span> <span class="token class-name">ApiResponse<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  status<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ResponseData<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ApiResponse<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">D</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token constant">D</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">UserData</span> <span class="token operator">=</span> ResponseData<span class="token operator">&lt;</span>ApiResponse<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">>></span><span class="token punctuation">;</span> <span class="token comment">// &#123; name: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è·¯ç”±å‚æ•°æå–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æå–åŠ¨æ€è·¯ç”±å‚æ•°</span>
<span class="token keyword">type</span> <span class="token class-name">RouteParams<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
    <span class="token operator">?</span> Param <span class="token operator">|</span> RouteParams<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> 
    <span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
      <span class="token operator">?</span> Param 
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Params</span> <span class="token operator">=</span> RouteParams<span class="token operator">&lt;</span><span class="token string">"/user/:id/profile/:section"</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// "id" | "section"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç¼–è¯‘åŸç†é€è§†</strong></p>
<ol>
<li>infer å®ç°æœºåˆ¶ï¼š<ul>
<li>ç±»å‹ç³»ç»Ÿå®ç°æ¨¡å¼åŒ¹é…</li>
<li>åœ¨ç±»å‹å…³ç³»æ±‚è§£æ—¶ç»‘å®šç±»å‹å˜é‡</li>
<li>åŸºäºçº¦æŸçš„ç±»å‹å˜é‡å®ä¾‹åŒ–</li>
</ul>
</li>
<li>ç±»å‹æ¨å¯¼è¿‡ç¨‹ï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">1. åŒ¹é…æ¡ä»¶ç±»å‹ç»“æ„
2. æå–å€™é€‰ç±»å‹
3. ç»‘å®š infer å˜é‡
4. éªŒè¯ç±»å‹çº¦æŸ
5. å®ä¾‹åŒ–ç»“æœç±»å‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æœ€ä½³å®è·µæŒ‡å—</strong></p>
<ol>
<li>ç±»å‹å˜é‡å‘½åè§„èŒƒï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨èï¼šæè¿°æ€§å‘½å</span>
<span class="token keyword">type</span> <span class="token class-name">ExtractReturn<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> ReturnType <span class="token operator">?</span> ReturnType <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// é¿å…ï¼šå•å­—æ¯å‘½å</span>
<span class="token keyword">type</span> <span class="token class-name">Bad<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>a<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>é”™è¯¯å¤„ç†æ¨¡å¼ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®‰å…¨æå–æ¨¡å¼</span>
<span class="token keyword">type</span> <span class="token class-name">SafeExtract<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Fallback <span class="token operator">=</span> <span class="token builtin">never</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">V</span> <span class="token punctuation">&#125;</span> <span class="token operator">?</span> <span class="token constant">V</span> <span class="token operator">:</span> Fallback<span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">type</span> <span class="token class-name">Value</span> <span class="token operator">=</span> SafeExtract<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// never</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å¤æ‚ç±»å‹åˆ†è§£ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ†è§£å¤æ‚æå–é€»è¾‘</span>
<span class="token keyword">type</span> <span class="token class-name">Step1<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token comment">/* ... */</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Step2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> Step1<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">infer</span></span> <span class="token constant">U</span> <span class="token operator">?</span> <span class="token comment">/* ... */</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Final<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> Step2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">infer</span></span> <span class="token constant">V</span> <span class="token operator">?</span> <span class="token comment">/* ... */</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>ç±»å‹æµ‹è¯•ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨ç±»å‹æ–­è¨€éªŒè¯</span>
<span class="token keyword">type</span> <span class="token class-name">Assert<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Expected<span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">Expected</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Test1</span> <span class="token operator">=</span> Assert<span class="token operator">&lt;</span>ReturnType<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">type</span> <span class="token class-name">Test2</span> <span class="token operator">=</span> Assert<span class="token operator">&lt;</span>FirstParam<span class="token operator">&lt;</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>infer ç±»å‹å…³ç³»å›¾</strong></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">infer åº”ç”¨ä½“ç³»
â”œâ”€ åŸºç¡€æå–
â”‚  â”œâ”€ å‡½æ•°è¿”å›å€¼ â†’ ReturnType
â”‚  â”œâ”€ å‡½æ•°å‚æ•° â†’ Parameters
â”‚  â””â”€ æ•°ç»„å…ƒç´  â†’ ArrayElement
â”‚
â”œâ”€ æ¨¡å¼åŒ¹é…
â”‚  â”œâ”€ å­—ç¬¦ä¸²æ¨¡æ¿ â†’ ExtractVariable
â”‚  â”œâ”€ å¯¹è±¡ç»“æ„ â†’ ValueOfKey
â”‚  â””â”€ æ¡ä»¶åˆ†æ”¯ â†’ ExtractByType
â”‚
â””â”€ é«˜çº§ä½“æ“
   â”œâ”€ å…ƒç»„è½¬æ¢ â†’ MapTuple
   â”œâ”€ æŸ¯é‡ŒåŒ– â†’ Curry
   â””â”€ é€’å½’å±•å¼€ â†’ Expand<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-2-ç±»å‹ä½“æ“å®æˆ˜"><a href="#2-2-ç±»å‹ä½“æ“å®æˆ˜" class="headerlink" title="2.2 ç±»å‹ä½“æ“å®æˆ˜"></a>2.2 ç±»å‹ä½“æ“å®æˆ˜</h2><h3 id="2-2-1-å‡½æ•°æŸ¯é‡ŒåŒ–ç±»å‹å®šä¹‰"><a href="#2-2-1-å‡½æ•°æŸ¯é‡ŒåŒ–ç±»å‹å®šä¹‰" class="headerlink" title="2.2.1 å‡½æ•°æŸ¯é‡ŒåŒ–ç±»å‹å®šä¹‰"></a>2.2.1 å‡½æ•°æŸ¯é‡ŒåŒ–ç±»å‹å®šä¹‰</h3><p><strong>æŸ¯é‡ŒåŒ–æ ¸å¿ƒæ¦‚å¿µ</strong></p>
<ul>
<li>æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰ï¼šå°†å¤šå‚æ•°å‡½æ•°è½¬åŒ–ä¸ºä¸€ç³»åˆ—å•å‚æ•°å‡½æ•°çš„è¿‡ç¨‹</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å‡½æ•°</span>
<span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span>

<span class="token comment">// æŸ¯é‡ŒåŒ–å</span>
<span class="token keyword">const</span> <span class="token function-variable function">curriedAdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>c<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ç±»å‹æŒ‘æˆ˜ï¼š<ul>
<li>åŠ¨æ€æ¨å¯¼å‰©ä½™å‚æ•°ç±»å‹</li>
<li>å¤„ç†å‚æ•°æ•°é‡ä¸ç¡®å®šçš„æƒ…å†µ</li>
<li>ä¿æŒè¿”å›å‡½æ•°çš„é“¾å¼è°ƒç”¨ç±»å‹å®‰å…¨</li>
</ul>
</li>
</ul>
<p><strong>åŸºç¡€æŸ¯é‡ŒåŒ–ç±»å‹å®ç°</strong></p>
<p>åœºæ™¯1ï¼šå›ºå®šå‚æ•°é•¿åº¦çš„æŸ¯é‡ŒåŒ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Curry1<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> <span class="token operator">?</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Curry2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">B</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> 
  <span class="token operator">?</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>b<span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span> 
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Curry3<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">B</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token keyword">infer</span> <span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span> 
  <span class="token operator">?</span> <span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>b<span class="token operator">:</span> <span class="token constant">B</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>c<span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span> 
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">curry</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span> <span class="token operator">?</span> Curry3<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> curriedAdd <span class="token operator">=</span> <span class="token function">curry</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç±»å‹: (a: number) => (b: number) => (c: number) => number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šåŠ¨æ€å‚æ•°é•¿åº¦çš„æŸ¯é‡ŒåŒ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Curry<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> Args<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> Return
  <span class="token operator">?</span> Args <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> First<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Rest<span class="token punctuation">]</span>
    <span class="token operator">?</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span> First<span class="token punctuation">)</span> <span class="token operator">=></span> Curry<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> Rest<span class="token punctuation">)</span> <span class="token operator">=></span> Return<span class="token operator">></span>
    <span class="token operator">:</span> Return <span class="token comment">// ç»ˆæ­¢æ¡ä»¶ï¼šæ— å‰©ä½™å‚æ•°</span>
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">const</span> dynamicCurry <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token constant">F</span><span class="token punctuation">)</span><span class="token operator">:</span> Curry<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// å®ç°ç•¥...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> curried <span class="token operator">=</span> <span class="token function">dynamicCurry</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç±»å‹: (arg: string) => (arg: number) => (arg: boolean) => void</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§æŸ¯é‡ŒåŒ–ç±»å‹æŠ€å·§</strong></p>
<p>æŠ€å·§1ï¼šæ”¯æŒéƒ¨åˆ†åº”ç”¨ï¼ˆPartial Applicationï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">PartialCurry<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> Args<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span>
  <span class="token operator">?</span> <span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name">Partial<span class="token operator">&lt;</span>Args<span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> 
      Args <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token operator">...</span>SameLength<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Rest<span class="token punctuation">]</span> 
        <span class="token operator">?</span> Rest <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
          <span class="token operator">?</span> <span class="token constant">R</span> 
          <span class="token operator">:</span> PartialCurry<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> Rest<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span><span class="token operator">></span>
        <span class="token operator">:</span> <span class="token builtin">never</span>
  <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">const</span> partialAdd <span class="token operator">=</span> <span class="token function">dynamicCurry</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> add10 <span class="token operator">=</span> <span class="token function">partialAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç±»å‹: (b: number) => (c: number) => number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠ€å·§2ï¼šå ä½ç¬¦æ”¯æŒï¼ˆPlaceholderï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> _ <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'placeholder'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">Placeholder</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> _<span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">CurryWithPlaceholder<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token punctuation">,</span> Original <span class="token operator">=</span> <span class="token constant">F</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> Args<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span>
    <span class="token operator">?</span> <span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name">CurryArgs<span class="token operator">&lt;</span>Args<span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> 
        IsComplete<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">,</span> Args<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token boolean">true</span></span> 
          <span class="token operator">?</span> <span class="token constant">R</span> 
          <span class="token operator">:</span> CurryWithPlaceholder<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> Remaining<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">,</span> Args<span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span><span class="token punctuation">,</span> Original<span class="token operator">></span>
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// å®Œæ•´å®ç°éœ€å®šä¹‰è¾…åŠ©ç±»å‹ï¼š</span>
<span class="token comment">// - CurryArgsï¼šå¤„ç†å ä½ç¬¦çš„å‚æ•°ç±»å‹</span>
<span class="token comment">// - Remainingï¼šè®¡ç®—å‰©ä½™å‚æ•°</span>
<span class="token comment">// - IsCompleteï¼šæ£€æŸ¥å‚æ•°æ˜¯å¦å®Œæ•´</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µä¸è¾¹ç•Œå¤„ç†</strong></p>
<p>è¾¹ç•Œæƒ…å†µå¤„ç†æ–¹æ¡ˆï¼š</p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç©ºå‚æ•°è°ƒç”¨</td>
<td align="left">è¿”å›åŸå§‹å‡½æ•°</td>
</tr>
<tr>
<td align="left">å‚æ•°æ•°é‡è¶…è¿‡åŸå‡½æ•°</td>
<td align="left">ç¼–è¯‘æ—¶æŠ¥é”™</td>
</tr>
<tr>
<td align="left">æ··åˆç±»å‹å‚æ•°</td>
<td align="left">ä½¿ç”¨æ³›å‹çº¦æŸä¿æŒç±»å‹å®‰å…¨</td>
</tr>
<tr>
<td align="left">å¯é€‰å‚æ•°å¤„ç†</td>
<td align="left">ä½¿ç”¨æ¡ä»¶ç±»å‹åˆ¤æ–­å‚æ•°æ˜¯å¦å¿…é¡»</td>
</tr>
</tbody></table>
<p>æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é¿å…æ·±å±‚é€’å½’ï¼ˆé™åˆ¶å‚æ•°æœ€å¤§æ•°é‡ï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">MaxParams</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token comment">// æ ¹æ®å®é™…éœ€æ±‚è®¾å®š</span>

<span class="token keyword">type</span> <span class="token class-name">SafeCurry<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token punctuation">,</span> Depth <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  Depth <span class="token keyword">extends</span> <span class="token class-name">MaxParams</span> 
    <span class="token operator">?</span> <span class="token constant">F</span> <span class="token comment">// è¾¾åˆ°æ·±åº¦é™åˆ¶æ—¶ç»ˆæ­¢</span>
    <span class="token operator">:</span> <span class="token constant">F</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token keyword">infer</span> Args<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">infer</span> <span class="token constant">R</span>
      <span class="token operator">?</span> Args <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> First<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token keyword">infer</span> Rest<span class="token punctuation">]</span>
        <span class="token operator">?</span> <span class="token punctuation">(</span>arg<span class="token operator">:</span> First<span class="token punctuation">)</span> <span class="token operator">=></span> SafeCurry<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> Rest<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span><span class="token punctuation">,</span> Add<span class="token operator">&lt;</span>Depth<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">>></span>
        <span class="token operator">:</span> <span class="token constant">R</span>
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¢è¯•çº§è€ƒç‚¹</strong></p>
<ul>
<li>ç±»å‹é€’å½’æ·±åº¦é™åˆ¶ï¼šTypeScript é»˜è®¤é€’å½’æ·±åº¦é™åˆ¶ï¼ˆçº¦50å±‚ï¼‰</li>
<li>æ¡ä»¶ç±»å‹åˆ†å‘æœºåˆ¶ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// è”åˆç±»å‹åœ¨æ¡ä»¶ç±»å‹ä¸­çš„åˆ†å‘è¡Œä¸º</span>
<span class="token keyword">type</span> <span class="token class-name"><span class="token constant">T</span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token punctuation">[</span><span class="token keyword">infer</span> <span class="token constant">A</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token constant">A</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token comment">// ç»“æœ: string | number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>å‚æ•°é€†å˜é—®é¢˜ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">curry</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">R</span><span class="token punctuation">)</span><span class="token operator">:</span> 
  <span class="token operator">&lt;</span><span class="token constant">A</span> <span class="token keyword">extends</span> <span class="token class-name">Partial<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">></span></span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">unknown</span><span class="token punctuation">;</span> <span class="token comment">// éœ€è¦å¤„ç†é€†å˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>å®é™…åº”ç”¨åœºæ™¯ï¼š<ul>
<li>Redux çš„ connect å‡½æ•°</li>
<li>React çš„é«˜é˜¶ç»„ä»¶</li>
<li>é…ç½®åŒ–è¡¨å•éªŒè¯é“¾</li>
</ul>
</li>
</ul>
<h3 id="2-2-2-Promise-é“¾å¼è°ƒç”¨ç±»å‹æ¨å¯¼"><a href="#2-2-2-Promise-é“¾å¼è°ƒç”¨ç±»å‹æ¨å¯¼" class="headerlink" title="2.2.2 Promise é“¾å¼è°ƒç”¨ç±»å‹æ¨å¯¼"></a>2.2.2 Promise é“¾å¼è°ƒç”¨ç±»å‹æ¨å¯¼</h3><p><strong>æ ¸å¿ƒç±»å‹æŒ‘æˆ˜</strong></p>
<table>
<thead>
<tr>
<th align="left">é—®é¢˜</th>
<th align="left">ç±»å‹è¡¨ç°</th>
<th align="left">è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td align="left">åˆå§‹å€¼ç±»å‹ä¸¢å¤±</td>
<td align="left"><code>Promise.resolve(42).then(v =&gt; v) â†’ v: unknown</code></td>
<td align="left">æ³›å‹æ•è·åˆå§‹ç±»å‹</td>
</tr>
<tr>
<td align="left">é“¾å¼è¿”å›å€¼ç±»å‹æ¨å¯¼</td>
<td align="left"><code>.then(x =&gt; x.toFixed())</code> â†’ æ¨å¯¼å¤±è´¥</td>
<td align="left">æ¡ä»¶ç±»å‹ + å‡½æ•°è¿”å›å€¼æ¨æ–­</td>
</tr>
<tr>
<td align="left">é”™è¯¯ç±»å‹ä¼ é€’ä¸­æ–­</td>
<td align="left"><code>.catch(e =&gt; e.message)</code> â†’ e: any</td>
<td align="left">æ³›å‹çº¦æŸé”™è¯¯ç±»å‹</td>
</tr>
<tr>
<td align="left">åŒæ­¥&#x2F;å¼‚æ­¥æ··åˆé“¾</td>
<td align="left"><code>Promise.resolve().then(() =&gt; 42)</code> â†’ ç±»å‹æ–­è£‚</td>
<td align="left">é€’å½’è§£åŒ… Promise åµŒå¥—</td>
</tr>
</tbody></table>
<p><strong>åŸºç¡€é“¾å¼è°ƒç”¨ç±»å‹å®ç°</strong></p>
<p>åœºæ™¯1ï¼šåŸºç¡€ Promise ç±»å‹å®šä¹‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
    onFulfilled<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">U</span> <span class="token operator">|</span> PromiseLike<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span><span class="token punctuation">;</span>
  
  <span class="token generic-function"><span class="token function">catch</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
    onRejected<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>reason<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">U</span> <span class="token operator">|</span> PromiseLike<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">|</span> <span class="token constant">U</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createPromise</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function-variable function">executor</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token function-variable function">resolve</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=></span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šé“¾å¼è¿”å›å€¼ç±»å‹æ¨å¯¼</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
    <span class="token function-variable function">onFulfilled</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">U</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span>UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">>></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æµ‹è¯•</span>
<span class="token keyword">const</span> chain <span class="token operator">=</span> <span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>v <span class="token operator">=></span> v<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// v: number â†’ string</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>s <span class="token operator">=></span> <span class="token function">parseInt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// s: string â†’ number</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§é“¾å¼ç±»å‹æŠ€å·§</strong></p>
<p>æŠ€å·§1ï¼šè‡ªåŠ¨è§£åŒ…åµŒå¥— Promise</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token operator">:</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">V</span><span class="token operator">></span> <span class="token operator">?</span> UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">V</span><span class="token operator">></span> <span class="token operator">:</span> 
  <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// å¤„ç†å¤šå±‚åµŒå¥—</span>
<span class="token keyword">const</span> nested <span class="token operator">=</span> <span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç±»å‹: MyPromise&lt;number> è€Œé MyPromise&lt;Promise&lt;Promise&lt;number>>></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠ€å·§2ï¼šé”™è¯¯ç±»å‹çº¦æŸ</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">E</span> <span class="token operator">=</span> Error<span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token generic-function"><span class="token function">catch</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
    <span class="token function-variable function">onRejected</span><span class="token operator">:</span> <span class="token punctuation">(</span>reason<span class="token operator">:</span> <span class="token constant">E</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">U</span>
  <span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">|</span> UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token constant">E</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token generic-function"><span class="token function">createPromise</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token punctuation">,</span> RangeError<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>e <span class="token operator">=></span> e<span class="token punctuation">.</span>message<span class="token punctuation">)</span>  <span class="token comment">// e: RangeError â†’ string</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠ€å·§3ï¼šé™æ€æ–¹æ³•ç±»å‹åŒ–</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">MyPromise</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">resolve</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span>UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">>></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token generic-function"><span class="token function">all</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>values<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token constant">T</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span>
    <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">></span>
  <span class="token punctuation">&#125;</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è¾¹ç•Œæƒ…å†µå¤„ç†</strong></p>
<p>åœºæ™¯1ï¼šç©º then å¤„ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// é€ä¼ å½“å‰ç±»å‹</span>
  <span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>onFulfilled<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> onRejected<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span>reason<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">U</span><span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">|</span> <span class="token constant">U</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ç¤ºä¾‹</span>
<span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment">// ç±»å‹ä»ä¸º MyPromise&lt;number></span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> e <span class="token operator">=></span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è·³è¿‡æˆåŠŸå›è°ƒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šæ··åˆåŒæ­¥&#x2F;å¼‚æ­¥è¿”å›å€¼</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">AsyncValue<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">|</span> PromiseLike<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">UnwrapAsync<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">PromiseLike<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token constant">U</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>
    <span class="token function-variable function">onFulfilled</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> AsyncValue<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span>UnwrapAsync<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">>></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å¤„ç†åŒæ­¥è¿”å›å€¼</span>
<span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>v <span class="token operator">=></span> v <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>      <span class="token comment">// åŒæ­¥è¿”å› number â†’ MyPromise&lt;number></span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>v <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¼‚æ­¥è¿”å› â†’ MyPromise&lt;string></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µä¸é¢è¯•è€ƒç‚¹</strong></p>
<p>Promise ç»„åˆæ¨¡å¼ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 1. race ç±»å‹å®ç°</span>
<span class="token keyword">static</span> <span class="token generic-function"><span class="token function">race</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>values<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> MyPromise<span class="token operator">&lt;</span>UnwrapPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">>></span><span class="token punctuation">;</span>

<span class="token comment">// 2. é¡ºåºæ‰§è¡Œé“¾</span>
<span class="token keyword">const</span> tasks<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
tasks<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>chain<span class="token punctuation">,</span> task<span class="token punctuation">)</span> <span class="token operator">=></span> 
  chain<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é¿å…æ·±å±‚é€’å½’ç±»å‹ (è®¾ç½®æœ€å¤§è§£åŒ…æ·±åº¦)</span>
<span class="token keyword">type</span> <span class="token class-name">UnwrapPromiseDeep<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> Depth <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  Depth <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token constant">T</span> <span class="token operator">:</span>
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> 
    <span class="token operator">?</span> UnwrapPromiseDeep<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token punctuation">,</span> Subtract<span class="token operator">&lt;</span>Depth<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">>></span> 
    <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç»ˆææŒ‘æˆ˜ï¼šå®ç° async&#x2F;await ç±»å‹æ¨å¯¼</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨¡æ‹Ÿ async å‡½æ•°è¿”å›ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">AsyncFunction<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> MyPromise<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">// æ¨¡æ‹Ÿ await ç±»å‹æ¨å¯¼</span>
<span class="token keyword">type</span> <span class="token class-name">Awaited<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">U</span><span class="token operator">></span></span> <span class="token operator">?</span> Awaited<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">runAsync</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">F</span> <span class="token keyword">extends</span> AsyncFunction<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span>fn<span class="token operator">:</span> <span class="token constant">F</span><span class="token punctuation">)</span><span class="token operator">:</span> 
  ReturnType<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">MyPromise<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">R</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token constant">R</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¢è¯•é—®é¢˜ç¤ºä¾‹ï¼š</p>
<p>Qï¼šä¸ºä»€ä¹ˆ <code>Promise&lt;Promise&lt;number&gt;&gt;</code> ä¼šè‡ªåŠ¨æ‰å¹³åŒ–ä¸º <code>Promise&lt;number&gt;</code>ï¼Ÿ</p>
<p>Aï¼šç”± then æ–¹æ³•çš„ç±»å‹å®šä¹‰å†³å®šï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token generic-function"><span class="token function">then</span><span class="token generic class-name"><span class="token operator">&lt;</span>TResult<span class="token operator">></span></span></span><span class="token punctuation">(</span>
    <span class="token function-variable function">onfulfilled</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> TResult <span class="token operator">|</span> PromiseLike<span class="token operator">&lt;</span>TResult<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>TResult<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å½“ T æœ¬èº«æ˜¯ <code>Promise&lt;U&gt;</code> æ—¶ï¼Œvalue: T å®é™…æ¥æ”¶ <code>Promise&lt;U&gt;</code>ï¼Œä½†è¿”å› <code>TResult | PromiseLike&lt;TResult&gt;</code> ä¼šè¢«å†æ¬¡åŒ…è£…ä¸º <code>Promise&lt;TResult&gt;</code>ï¼Œå½¢æˆé€’å½’è§£åŒ…æ•ˆæœã€‚</p>
<h3 id="2-2-3-Redux-reducer-ç±»å‹å®‰å…¨å®ç°"><a href="#2-2-3-Redux-reducer-ç±»å‹å®‰å…¨å®ç°" class="headerlink" title="2.2.3 Redux reducer ç±»å‹å®‰å…¨å®ç°"></a>2.2.3 Redux reducer ç±»å‹å®‰å…¨å®ç°</h3><p><strong>æ ¸å¿ƒç±»å‹æ¶æ„</strong></p>
<p>Redux ç±»å‹å››è¦ç´ ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 1. çŠ¶æ€ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">State</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  counter<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  todos<span class="token operator">:</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> completed<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">&#125;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 2. Action ç±»å‹ï¼ˆè”åˆç±»å‹ï¼‰</span>
<span class="token keyword">type</span> <span class="token class-name">Action</span> <span class="token operator">=</span> 
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'INCREMENT'</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'ADD_TODO'</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'TOGGLE_TODO'</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 3. Reducer å‡½æ•°ç­¾å</span>
<span class="token keyword">type</span> <span class="token class-name">Reducer<span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token constant">S</span><span class="token punctuation">,</span> action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">S</span><span class="token punctuation">;</span>

<span class="token comment">// 4. Dispatch ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">Dispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span>action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹å®‰å…¨ reducer å®ç°</strong></p>
<p>åŸºç¡€å®ç°ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> reducer<span class="token operator">:</span> Reducer<span class="token operator">&lt;</span>State<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">'INCREMENT'</span><span class="token operator">:</span>
      <span class="token comment">// âœ… è‡ªåŠ¨æ¨æ–­ payload ä¸º number</span>
      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> counter<span class="token operator">:</span> state<span class="token punctuation">.</span>counter <span class="token operator">+</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">case</span> <span class="token string">'ADD_TODO'</span><span class="token operator">:</span>
      <span class="token comment">// âœ… è‡ªåŠ¨æ¨æ–­ payload ä¸º string</span>
      <span class="token keyword">const</span> newTodo <span class="token operator">=</span> <span class="token punctuation">&#123;</span> 
        id<span class="token operator">:</span> <span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        text<span class="token operator">:</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">,</span> 
        completed<span class="token operator">:</span> <span class="token boolean">false</span> 
      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> todos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>todos<span class="token punctuation">,</span> newTodo<span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">case</span> <span class="token string">'TOGGLE_TODO'</span><span class="token operator">:</span>
      <span class="token comment">// âœ… è‡ªåŠ¨æ¨æ–­ payload ä¸º string</span>
      <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        todos<span class="token operator">:</span> state<span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>todo <span class="token operator">=></span> 
          todo<span class="token punctuation">.</span>id <span class="token operator">===</span> action<span class="token punctuation">.</span>payload 
            <span class="token operator">?</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span>todo<span class="token punctuation">,</span> completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed <span class="token punctuation">&#125;</span> 
            <span class="token operator">:</span> todo
        <span class="token punctuation">)</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token comment">// âŒ æ•è·æœªå¤„ç† action</span>
      <span class="token keyword">const</span> _exhaustiveCheck<span class="token operator">:</span> <span class="token builtin">never</span> <span class="token operator">=</span> action<span class="token punctuation">;</span>
      <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§æ¨¡å¼ï¼šç±»å‹ç”Ÿæˆå™¨</strong></p>
<p>è‡ªåŠ¨åˆ›å»ºç±»å‹å®‰å…¨ actionï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Action åˆ›å»ºå‡½æ•°å·¥å‚</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createAction</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token constant">P</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>type<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>payload<span class="token operator">:</span> <span class="token constant">P</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">const</span> increment <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'INCREMENT'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>amount<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=></span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> addTodo <span class="token operator">=</span> <span class="token function">createAction</span><span class="token punctuation">(</span><span class="token string">'ADD_TODO'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è‡ªåŠ¨ç”Ÿæˆ Action ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">Actions</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> increment<span class="token operator">></span> <span class="token operator">|</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> addTodo<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹å®‰å…¨ reducer ç”Ÿæˆå™¨ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ActionMap</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token constant">INCREMENT</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token constant">ADD_TODO</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token constant">TOGGLE_TODO</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createReducer</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">S</span><span class="token punctuation">,</span> <span class="token constant">A</span> <span class="token keyword">extends</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span></span><span class="token punctuation">(</span>
  initialState<span class="token operator">:</span> <span class="token constant">S</span><span class="token punctuation">,</span>
  handlers<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token constant">S</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">S</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token constant">S</span> <span class="token operator">=</span> initialState<span class="token punctuation">,</span> action<span class="token operator">:</span> <span class="token punctuation">&#123;</span> 
    <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token constant">A</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span> 
  <span class="token punctuation">&#125;</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">A</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>handlers<span class="token punctuation">[</span>action<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> handlers<span class="token punctuation">[</span>action<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createReducer</span><span class="token generic class-name"><span class="token operator">&lt;</span>State<span class="token punctuation">,</span> ActionMap<span class="token operator">></span></span></span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">INCREMENT</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> payload<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> counter<span class="token operator">:</span> state<span class="token punctuation">.</span>counter <span class="token operator">+</span> payload <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">ADD_TODO</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> text<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> todos<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>todos<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text <span class="token punctuation">&#125;</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Redux Toolkit é›†æˆ</strong></p>
<p>ç°ä»£ Redux ç±»å‹å®‰å…¨å®è·µï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSlice<span class="token punctuation">,</span> PayloadAction <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'@reduxjs/toolkit'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> todosSlice <span class="token operator">=</span> <span class="token function">createSlice</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">'todos'</span><span class="token punctuation">,</span>
  initialState<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> Todo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  reducers<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    addTodo<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token function-variable function">reducer</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token operator">:</span> PayloadAction<span class="token operator">&lt;</span>Todo<span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
        state<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">prepare</span><span class="token operator">:</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
        payload<span class="token operator">:</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token function">nanoid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> text<span class="token punctuation">,</span> completed<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">toggleTodo</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token operator">:</span> PayloadAction<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">const</span> todo <span class="token operator">=</span> state<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>t <span class="token operator">=></span> t<span class="token punctuation">.</span>id <span class="token operator">===</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> todo<span class="token punctuation">.</span>completed <span class="token operator">=</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è‡ªåŠ¨ç”Ÿæˆ Action ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">TodosAction</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> todosSlice<span class="token punctuation">.</span>actions<span class="token punctuation">.</span>addTodo<span class="token operator">></span> 
  <span class="token operator">|</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> todosSlice<span class="token punctuation">.</span>actions<span class="token punctuation">.</span>toggleTodo<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¤æ‚åœºæ™¯å¤„ç†</strong></p>
<p>å¼‚æ­¥ Action ç±»å‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ThunkAction <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">AppThunk<span class="token operator">&lt;</span>ReturnType <span class="token operator">=</span> <span class="token keyword">void</span><span class="token operator">></span></span> <span class="token operator">=</span> ThunkAction<span class="token operator">&lt;</span>
  ReturnType<span class="token punctuation">,</span>
  State<span class="token punctuation">,</span>
  <span class="token builtin">unknown</span><span class="token punctuation">,</span>
  Action
<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchTodos <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AppThunk <span class="token operator">=></span> <span class="token keyword">async</span> dispatch <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'FETCH_TODOS_REQUEST'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> todos <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">getTodos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'FETCH_TODOS_SUCCESS'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> todos <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'FETCH_TODOS_FAILURE'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> error<span class="token punctuation">.</span>message <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Reducer ç»„åˆç±»å‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">CombinedState</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  todos<span class="token operator">:</span> TodoState<span class="token punctuation">;</span>
  user<span class="token operator">:</span> UserState<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// ç±»å‹å®‰å…¨çš„ combineReducers</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">combineTypedReducers</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">M</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>reducers<span class="token operator">:</span> <span class="token constant">M</span><span class="token punctuation">)</span><span class="token operator">:</span> Reducer<span class="token operator">&lt;</span><span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">M</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">M</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">Reducer<span class="token operator">&lt;</span><span class="token keyword">infer</span> <span class="token constant">S</span><span class="token operator">></span></span> <span class="token operator">?</span> <span class="token constant">S</span> <span class="token operator">:</span> <span class="token builtin">never</span>
<span class="token punctuation">&#125;</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span> <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> reducers<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      newState<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> reducers<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">(</span>state<span class="token operator">?.</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> newState<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è¾¹ç•Œå¤„ç†ä¸ä¼˜åŒ–</strong></p>
<table>
<thead>
<tr>
<th align="left">è¾¹ç•Œæƒ…å†µ</th>
<th align="left">è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç©º action å¤„ç†</td>
<td align="left">ä½¿ç”¨ never ç±»å‹è¿›è¡Œç©·å°½æ£€æŸ¥</td>
</tr>
<tr>
<td align="left">åµŒå¥—çŠ¶æ€æ›´æ–°</td>
<td align="left">ä½¿ç”¨ Immer åº“è¿›è¡Œå¯å˜å†™æ³•</td>
</tr>
<tr>
<td align="left">å†å²çŠ¶æ€ç±»å‹</td>
<td align="left">æ·»åŠ  undoable reducer ç±»å‹æ‰©å±•</td>
</tr>
<tr>
<td align="left">åŠ¨æ€ reducer æ³¨å†Œ</td>
<td align="left">ç±»å‹å®‰å…¨çš„ injectReducer æ¨¡å¼</td>
</tr>
</tbody></table>
<p>æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// 1. é¿å…æ·±å±‚åµŒå¥—çŠ¶æ€</span>
<span class="token keyword">type</span> <span class="token class-name">State</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// âŒ é¿å…</span>
  deep<span class="token operator">:</span> <span class="token punctuation">&#123;</span> a<span class="token operator">:</span> <span class="token punctuation">&#123;</span> b<span class="token operator">:</span> <span class="token punctuation">&#123;</span> c<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token comment">// âœ… æ¨è</span>
  flat<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> FlatItem<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// 2. ä½¿ç”¨ Reselect è®°å¿†åŒ–é€‰æ‹©å™¨</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> createSelector <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'reselect'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">selectTodos</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> State<span class="token punctuation">)</span> <span class="token operator">=></span> state<span class="token punctuation">.</span>todos<span class="token punctuation">;</span>
<span class="token keyword">const</span> selectCompletedTodos <span class="token operator">=</span> <span class="token function">createSelector</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>selectTodos<span class="token punctuation">]</span><span class="token punctuation">,</span>
  todos <span class="token operator">=></span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>t <span class="token operator">=></span> t<span class="token punctuation">.</span>completed<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¢è¯•çº§è€ƒç‚¹</strong></p>
<ol>
<li>ç±»å‹æ”¶çª„åŸç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åˆ©ç”¨å¯è¾¨è¯†è”åˆï¼ˆdiscriminated unionï¼‰</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'INCREMENT'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æ­¤å¤„ action è‡ªåŠ¨æ”¶çª„ä¸º &#123; type: 'INCREMENT'; payload: number &#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹å®‰å…¨ä¸æ€§èƒ½å¹³è¡¡ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// âŒ è¿‡åº¦æ³›åŒ–</span>
<span class="token keyword">type</span> <span class="token class-name">Action<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">// âœ… ç²¾ç¡®æ§åˆ¶</span>
<span class="token keyword">type</span> <span class="token class-name">StrictAction</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'A'</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span> <span class="token operator">|</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'B'</span><span class="token punctuation">;</span> payload<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>Redux ä¸­é—´ä»¶ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">MiddlewareAPI<span class="token operator">&lt;</span><span class="token constant">D</span> <span class="token keyword">extends</span> Dispatch<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  dispatch<span class="token operator">:</span> <span class="token constant">D</span><span class="token punctuation">;</span>
  <span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">S</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">type</span> <span class="token class-name">Middleware</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">S</span><span class="token operator">></span><span class="token punctuation">(</span>api<span class="token operator">:</span> MiddlewareAPI<span class="token operator">&lt;</span>Dispatch<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=></span> 
  <span class="token punctuation">(</span>next<span class="token operator">:</span> Dispatch<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>action<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">any</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>æ—¶é—´æ—…è¡Œè°ƒè¯•ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">TimeTravelState</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  past<span class="token operator">:</span> State<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  present<span class="token operator">:</span> State<span class="token punctuation">;</span>
  future<span class="token operator">:</span> State<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>ç»ˆææŒ‘æˆ˜ï¼šå®ç°ç±»å‹å®‰å…¨çš„ Redux-Observable</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Epic</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  action$<span class="token operator">:</span> Observable<span class="token operator">&lt;</span>Action<span class="token operator">></span><span class="token punctuation">,</span>
  state$<span class="token operator">:</span> StateObservable<span class="token operator">&lt;</span>State<span class="token operator">></span>
<span class="token punctuation">)</span> <span class="token operator">=></span> Observable<span class="token operator">&lt;</span>Action<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchEpic<span class="token operator">:</span> <span class="token function-variable function">Epic</span> <span class="token operator">=</span> <span class="token punctuation">(</span>action$<span class="token punctuation">,</span> state$<span class="token punctuation">)</span> <span class="token operator">=></span> 
  action$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
    <span class="token function">ofType</span><span class="token punctuation">(</span><span class="token string">'FETCH_REQUEST'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">switchMap</span><span class="token punctuation">(</span>action <span class="token operator">=></span> 
      <span class="token function">from</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
        <span class="token function">map</span><span class="token punctuation">(</span>response <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'FETCH_SUCCESS'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> response <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">catchError</span><span class="token punctuation">(</span>error <span class="token operator">=></span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> type<span class="token operator">:</span> <span class="token string">'FETCH_ERROR'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> error <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-2-4-è·¯ç”±å‚æ•°è‡ªåŠ¨ç±»å‹æ¨å¯¼"><a href="#2-2-4-è·¯ç”±å‚æ•°è‡ªåŠ¨ç±»å‹æ¨å¯¼" class="headerlink" title="2.2.4 è·¯ç”±å‚æ•°è‡ªåŠ¨ç±»å‹æ¨å¯¼"></a>2.2.4 è·¯ç”±å‚æ•°è‡ªåŠ¨ç±»å‹æ¨å¯¼</h3><p><strong>æ ¸å¿ƒæŒ‘æˆ˜</strong></p>
<ol>
<li>è·¯å¾„è§£æï¼šå°†å­—ç¬¦ä¸²è·¯å¾„ï¼ˆå¦‚ &#x2F;user&#x2F;:id&#x2F;posts&#x2F;:postIdï¼‰è½¬æ¢ä¸ºç±»å‹ç»“æ„</li>
<li>å‚æ•°æå–ï¼šè¯†åˆ«åŠ¨æ€æ®µï¼ˆ:paramï¼‰å’Œå¯é€‰æ®µï¼ˆ?ï¼‰</li>
<li>ç±»å‹è½¬æ¢ï¼šå°†å‚æ•°åæ˜ å°„ä¸ºå¯¹è±¡é”®ï¼ˆ{ id: string; postId: string }ï¼‰</li>
<li>åµŒå¥—è·¯ç”±ï¼šæ”¯æŒå¤šå±‚è·¯ç”±å‚æ•°åˆå¹¶</li>
</ol>
<p><strong>åŸºç¡€è·¯å¾„å‚æ•°æ¨å¯¼</strong></p>
<p>åœºæ™¯1ï¼šæå–å•ä¸€è·¯å¾„å‚æ•°</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> 
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> Param <span class="token operator">|</span> ExtractParam<span class="token operator">&lt;</span>Rest<span class="token operator">></span>
    <span class="token operator">:</span> Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">?</span> Param
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Test1</span> <span class="token operator">=</span> ExtractParam<span class="token operator">&lt;</span><span class="token string">'/user/:id'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// "id"</span>
<span class="token keyword">type</span> <span class="token class-name">Test2</span> <span class="token operator">=</span> ExtractParam<span class="token operator">&lt;</span><span class="token string">'/post/:postId/comment/:commentId'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// "postId" | "commentId"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šè½¬æ¢ä¸ºå‚æ•°å¯¹è±¡ç±»å‹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">PathParams<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Params1</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/user/:id'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// &#123; id: string &#125;</span>
<span class="token keyword">type</span> <span class="token class-name">Params2</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/category/:categoryId/product/:productId'</span><span class="token operator">></span><span class="token punctuation">;</span> 
<span class="token comment">// &#123; categoryId: string; productId: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§è·¯ç”±ç‰¹æ€§å®ç°</strong></p>
<p>ç‰¹æ€§1ï¼šå¯é€‰å‚æ•°ï¼ˆ?ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ExtractOptionalParam<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span>
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">?/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> Param <span class="token operator">|</span> ExtractOptionalParam<span class="token operator">&lt;</span>Rest<span class="token operator">></span>
    <span class="token operator">:</span> Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">?</span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">?</span> Param
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PathParams<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractOptionalParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Params3</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/search/:query?'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// &#123; query?: string &#125;</span>
<span class="token keyword">type</span> <span class="token class-name">Params4</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/user/:id/profile/:tab?'</span><span class="token operator">></span><span class="token punctuation">;</span> 
<span class="token comment">// &#123; id: string; tab?: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç‰¹æ€§2ï¼šé€šé…ç¬¦åŒ¹é…ï¼ˆ*ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ExtractWildcard<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span>
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">*</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> <span class="token string">'wildcard'</span> <span class="token operator">|</span> ExtractWildcard<span class="token operator">&lt;</span>Rest<span class="token operator">></span>
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">PathParams<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractOptionalParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractWildcard<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Params5</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/files/*'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// &#123; wildcard: string[] &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç‰¹æ€§3ï¼šæ­£åˆ™çº¦æŸå‚æ•°</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ExtractConstrainedParam<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span>
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Regex<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">)/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> <span class="token punctuation">&#123;</span> param<span class="token operator">:</span> Param<span class="token punctuation">;</span> regex<span class="token operator">:</span> Regex <span class="token punctuation">&#125;</span> <span class="token operator">|</span> ExtractConstrainedParam<span class="token operator">&lt;</span>Rest<span class="token operator">></span>
    <span class="token operator">:</span> Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Regex<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">?</span> <span class="token punctuation">&#123;</span> param<span class="token operator">:</span> Param<span class="token punctuation">;</span> regex<span class="token operator">:</span> Regex <span class="token punctuation">&#125;</span>
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">MapRegexToType<span class="token operator">&lt;</span><span class="token constant">R</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token string">'\\d+'</span> <span class="token operator">?</span> <span class="token builtin">number</span> <span class="token operator">:</span>
  <span class="token constant">R</span> <span class="token keyword">extends</span> <span class="token string">'\\w+'</span> <span class="token operator">?</span> <span class="token builtin">string</span> <span class="token operator">:</span>
  <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// é»˜è®¤å›é€€</span>

<span class="token keyword">type</span> <span class="token class-name">PathParams<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractOptionalParam<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> ExtractWildcard<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> ExtractConstrainedParam<span class="token operator">&lt;</span>Path<span class="token operator">></span> <span class="token keyword">as</span> <span class="token constant">P</span><span class="token punctuation">[</span><span class="token string">'param'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">:</span> 
    MapRegexToType<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">[</span><span class="token string">'regex'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">Params6</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/user/:id(\\d+)'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// &#123; id: number &#125;</span>
<span class="token keyword">type</span> <span class="token class-name">Params7</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token string">'/post/:slug(\\w+)'</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// &#123; slug: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>React Router é›†æˆå®è·µ</strong></p>
<p>ç±»å‹å®‰å…¨è·¯ç”±ç»„ä»¶ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> useParams <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»ºç±»å‹å®‰å…¨ç‰ˆæœ¬</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useTypedParams</span><span class="token generic class-name"><span class="token operator">&lt;</span>Path <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">type</span> <span class="token class-name">Params</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">useParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> Partial<span class="token operator">&lt;</span>Params<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// å¯èƒ½æœªåŒ¹é…æ‰€æœ‰å‚æ•°</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="token keyword">const</span> <span class="token function-variable function">UserProfile</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useTypedParams</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token string">'/user/:id/:tab?'</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token comment">// params: &#123; id?: string; tab?: string &#125;</span>
  
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>User <span class="token constant">ID</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>params<span class="token punctuation">.</span>id <span class="token operator">||</span> <span class="token string">'Unknown'</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç±»å‹å®‰å…¨è·¯ç”±é…ç½®ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">RouteConfig<span class="token operator">&lt;</span>Path <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  path<span class="token operator">:</span> Path<span class="token punctuation">;</span>
  element<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode<span class="token punctuation">;</span>
  children<span class="token operator">?</span><span class="token operator">:</span> RouteConfig<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">createRoute</span><span class="token generic class-name"><span class="token operator">&lt;</span>Path <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>config<span class="token operator">:</span> RouteConfig<span class="token operator">&lt;</span>Path<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token function">createRoute</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  path<span class="token operator">:</span> <span class="token string">'/user/:id'</span><span class="token punctuation">,</span>
  element<span class="token operator">:</span> <span class="token operator">&lt;</span>UserPage <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span> 
      path<span class="token operator">:</span> <span class="token string">'posts/:postId'</span><span class="token punctuation">,</span>  <span class="token comment">// å®Œæ•´è·¯å¾„: /user/:id/posts/:postId</span>
      element<span class="token operator">:</span> <span class="token operator">&lt;</span>PostPage <span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è‡ªåŠ¨æ¨å¯¼å‚æ•°ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">UserPageParams</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token keyword">typeof</span> routes<span class="token punctuation">.</span>path<span class="token operator">></span><span class="token punctuation">;</span>          <span class="token comment">// &#123; id: string &#125;</span>
<span class="token keyword">type</span> <span class="token class-name">PostPageParams</span> <span class="token operator">=</span> PathParams<span class="token operator">&lt;</span><span class="token keyword">typeof</span> routes<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>path<span class="token operator">></span><span class="token punctuation">;</span> 
<span class="token comment">// &#123; id: string; postId: string &#125; (åŒ…å«çˆ¶çº§å‚æ•°)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è¾¹ç•Œå¤„ç†ä¸ä¼˜åŒ–</strong></p>
<p>é€’å½’æ·±åº¦æ§åˆ¶ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">ExtractParam<span class="token operator">&lt;</span>Path<span class="token punctuation">,</span> Depth <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  Depth <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span>
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> Param <span class="token operator">|</span> ExtractParam<span class="token operator">&lt;</span>Rest<span class="token punctuation">,</span> Subtract<span class="token operator">&lt;</span>Depth<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">>></span>
    <span class="token operator">:</span> Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token operator">?</span> Param
      <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è·¯å¾„å†²çªæ£€æµ‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">DetectConflict<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> 
  ExtractParam<span class="token operator">&lt;</span>Path<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token keyword">infer</span></span> <span class="token constant">P</span>
    <span class="token operator">?</span> <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">any</span></span>
      <span class="token operator">?</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">K</span> <span class="token punctuation">&#125;</span> <span class="token keyword">extends</span> <span class="token class-name">Record<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token punctuation">,</span> <span class="token constant">P</span><span class="token operator">></span></span>
        <span class="token operator">?</span> Path  <span class="token comment">// æ— å†²çª</span>
        <span class="token operator">:</span> <span class="token builtin">never</span> <span class="token comment">// å­˜åœ¨é‡å¤å‚æ•°</span>
      <span class="token operator">:</span> <span class="token builtin">never</span>
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="token keyword">type</span> <span class="token class-name">SafePath</span> <span class="token operator">=</span> DetectConflict<span class="token operator">&lt;</span><span class="token string">'/user/:id/posts/:id'</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">// never (æ£€æµ‹åˆ°é‡å¤id)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¢è¯•çº§è€ƒç‚¹</strong></p>
<ol>
<li>æ¨¡æ¿å­—é¢é‡ç±»å‹æ“ä½œï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">SplitPath<span class="token operator">&lt;</span><span class="token constant">P</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Part<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
  <span class="token operator">?</span> <span class="token punctuation">[</span>Part<span class="token punctuation">,</span> <span class="token operator">...</span>SplitPath<span class="token operator">&lt;</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token operator">></span><span class="token punctuation">]</span> 
  <span class="token operator">:</span> <span class="token constant">P</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Part<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
    <span class="token operator">?</span> <span class="token punctuation">[</span>Part<span class="token punctuation">]</span> 
    <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç±»å‹é€’å½’é™åˆ¶ï¼šTS 4.5+ æ”¯æŒå°¾é€’å½’ä¼˜åŒ–</li>
<li>React Router v6 ç±»å‹å®ç°ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®˜æ–¹ParamKeyç±»å‹å®šä¹‰</span>
<span class="token keyword">type</span> <span class="token class-name">ParamKey<span class="token operator">&lt;</span>TPath<span class="token operator">></span></span> <span class="token operator">=</span> TPath <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> _<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Rest<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token operator">?</span> Param <span class="token operator">|</span> ParamKey<span class="token operator">&lt;</span>Rest<span class="token operator">></span>
  <span class="token operator">:</span> TPath <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> _<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token operator">?</span> Param
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>Vue Router å¯¹æ¯”ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// Vue Routerçš„RouteRecordRawç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">RouteRecordRaw</span> <span class="token punctuation">&#123;</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  component<span class="token operator">:</span> Component<span class="token punctuation">;</span>
  children<span class="token operator">?</span><span class="token operator">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>ç»ˆææŒ‘æˆ˜ï¼šå®ç°Next.jsæ–‡ä»¶è·¯ç”±ç±»å‹</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">NextPageParams<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> 
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">pages/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Route<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">.tsx</span><span class="token template-punctuation string">`</span></span> 
    <span class="token operator">?</span> PathParams<span class="token operator">&lt;</span>Route<span class="token operator">></span>
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>

<span class="token comment">// æ–‡ä»¶è·¯å¾„: pages/user/[id]/[tab].tsx</span>
<span class="token keyword">type</span> <span class="token class-name">Params</span> <span class="token operator">=</span> NextPageParams<span class="token operator">&lt;</span><span class="token string">'pages/user/[id]/[tab].tsx'</span><span class="token operator">></span><span class="token punctuation">;</span> 
<span class="token comment">// &#123; id: string; tab: string &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-3-æ¨¡æ¿å­—é¢é‡ç±»å‹"><a href="#2-3-æ¨¡æ¿å­—é¢é‡ç±»å‹" class="headerlink" title="2.3 æ¨¡æ¿å­—é¢é‡ç±»å‹"></a>2.3 æ¨¡æ¿å­—é¢é‡ç±»å‹</h2><h3 id="2-3-1-å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹æ“ä½œ"><a href="#2-3-1-å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹æ“ä½œ" class="headerlink" title="2.3.1 å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹æ“ä½œ"></a>2.3.1 å­—ç¬¦ä¸²æ¨¡æ¿ç±»å‹æ“ä½œ</h3><h3 id="2-3-2-Uppercase-Lowercase-ç±»å‹è½¬æ¢"><a href="#2-3-2-Uppercase-Lowercase-ç±»å‹è½¬æ¢" class="headerlink" title="2.3.2 Uppercase&#x2F;Lowercase ç±»å‹è½¬æ¢"></a>2.3.2 Uppercase&#x2F;Lowercase ç±»å‹è½¬æ¢</h3><h3 id="2-3-3-è·¯ç”±è·¯å¾„æ¨¡å¼åŒ¹é…"><a href="#2-3-3-è·¯ç”±è·¯å¾„æ¨¡å¼åŒ¹é…" class="headerlink" title="2.3.3 è·¯ç”±è·¯å¾„æ¨¡å¼åŒ¹é…"></a>2.3.3 è·¯ç”±è·¯å¾„æ¨¡å¼åŒ¹é…</h3><h3 id="2-3-4-å›½é™…åŒ–é”®åè‡ªåŠ¨è¡¥å…¨"><a href="#2-3-4-å›½é™…åŒ–é”®åè‡ªåŠ¨è¡¥å…¨" class="headerlink" title="2.3.4 å›½é™…åŒ–é”®åè‡ªåŠ¨è¡¥å…¨"></a>2.3.4 å›½é™…åŒ–é”®åè‡ªåŠ¨è¡¥å…¨</h3><h2 id="2-4-ç±»å‹ç¼–ç¨‹ä¼˜åŒ–"><a href="#2-4-ç±»å‹ç¼–ç¨‹ä¼˜åŒ–" class="headerlink" title="2.4 ç±»å‹ç¼–ç¨‹ä¼˜åŒ–"></a>2.4 ç±»å‹ç¼–ç¨‹ä¼˜åŒ–</h2><h3 id="2-4-1-ç±»å‹é€’å½’ä¸å°¾é€’å½’ä¼˜åŒ–"><a href="#2-4-1-ç±»å‹é€’å½’ä¸å°¾é€’å½’ä¼˜åŒ–" class="headerlink" title="2.4.1 ç±»å‹é€’å½’ä¸å°¾é€’å½’ä¼˜åŒ–"></a>2.4.1 ç±»å‹é€’å½’ä¸å°¾é€’å½’ä¼˜åŒ–</h3><h3 id="2-4-2-ç±»å‹å®ä¾‹åŒ–æ·±åº¦æ§åˆ¶"><a href="#2-4-2-ç±»å‹å®ä¾‹åŒ–æ·±åº¦æ§åˆ¶" class="headerlink" title="2.4.2 ç±»å‹å®ä¾‹åŒ–æ·±åº¦æ§åˆ¶"></a>2.4.2 ç±»å‹å®ä¾‹åŒ–æ·±åº¦æ§åˆ¶</h3><h3 id="2-4-3-æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§"><a href="#2-4-3-æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§" class="headerlink" title="2.4.3 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§"></a>2.4.3 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§</h3><h3 id="2-4-4-ç±»å‹æ€§èƒ½åˆ†æå·¥å…·"><a href="#2-4-4-ç±»å‹æ€§èƒ½åˆ†æå·¥å…·" class="headerlink" title="2.4.4 ç±»å‹æ€§èƒ½åˆ†æå·¥å…·"></a>2.4.4 ç±»å‹æ€§èƒ½åˆ†æå·¥å…·</h3><h1 id="ä¸‰ã€å·¥ç¨‹åŒ–å®è·µ"><a href="#ä¸‰ã€å·¥ç¨‹åŒ–å®è·µ" class="headerlink" title="ä¸‰ã€å·¥ç¨‹åŒ–å®è·µ"></a>ä¸‰ã€å·¥ç¨‹åŒ–å®è·µ</h1><h2 id="3-1-TSConfig-æ·±åº¦é…ç½®"><a href="#3-1-TSConfig-æ·±åº¦é…ç½®" class="headerlink" title="3.1 TSConfig æ·±åº¦é…ç½®"></a>3.1 TSConfig æ·±åº¦é…ç½®</h2><h3 id="3-1-1-ä¸¥æ ¼æ¨¡å¼å…¨å®¶æ¡¶é…ç½®"><a href="#3-1-1-ä¸¥æ ¼æ¨¡å¼å…¨å®¶æ¡¶é…ç½®" class="headerlink" title="3.1.1 ä¸¥æ ¼æ¨¡å¼å…¨å®¶æ¡¶é…ç½®"></a>3.1.1 ä¸¥æ ¼æ¨¡å¼å…¨å®¶æ¡¶é…ç½®</h3><p><strong>ä¸¥æ ¼æ¨¡å¼æ ¸å¿ƒé…ç½®</strong></p>
<p>å¯ç”¨æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤é…ç½®ç­‰ä»·äºåŒæ—¶å¯ç”¨ä»¥ä¸‹æ‰€æœ‰å­é€‰é¡¹ï¼ˆTypeScript 2.3+ï¼‰ã€‚</p>
<p><strong>ä¸¥æ ¼æ¨¡å¼å­é€‰é¡¹è¯¦è§£</strong></p>
<table>
<thead>
<tr>
<th align="left">é€‰é¡¹</th>
<th align="left">é»˜è®¤å€¼</th>
<th align="left">ä½œç”¨</th>
<th align="left">æ¨èå€¼</th>
</tr>
</thead>
<tbody><tr>
<td align="left">strict</td>
<td align="left">false</td>
<td align="left">æ‰€æœ‰ä¸¥æ ¼æ£€æŸ¥çš„æ€»å¼€å…³</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">noImplicitAny</td>
<td align="left">false</td>
<td align="left">ç¦æ­¢éšå¼ any ç±»å‹</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">noImplicitThis</td>
<td align="left">false</td>
<td align="left">ç¦æ­¢éšå¼ any ç±»å‹çš„ this</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">strictNullChecks</td>
<td align="left">false</td>
<td align="left">ä¸¥æ ¼çš„ null&#x2F;undefined æ£€æŸ¥</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">strictFunctionTypes</td>
<td align="left">false</td>
<td align="left">ä¸¥æ ¼çš„å‡½æ•°ç±»å‹æ£€æŸ¥ï¼ˆé€†å˜å‚æ•°ï¼‰</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">strictBindCallApply</td>
<td align="left">false</td>
<td align="left">ä¸¥æ ¼çš„ bind&#x2F;call&#x2F;apply æ–¹æ³•æ£€æŸ¥</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">strictPropertyInitialization</td>
<td align="left">false</td>
<td align="left">ä¸¥æ ¼çš„ç±»å±æ€§åˆå§‹åŒ–æ£€æŸ¥ï¼ˆéœ€é…åˆ strictNullChecksï¼‰</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">alwaysStrict</td>
<td align="left">false</td>
<td align="left">ä»¥ä¸¥æ ¼æ¨¡å¼è§£æä»£ç ï¼Œå¹¶åœ¨æ¯ä¸ªæ–‡ä»¶é¡¶éƒ¨æ·»åŠ  â€œuse strictâ€</td>
<td align="left">true</td>
</tr>
<tr>
<td align="left">useUnknownInCatchVariables</td>
<td align="left">false</td>
<td align="left">catch å­å¥å˜é‡é»˜è®¤ä¸º unknown ç±»å‹ï¼ˆTS 4.4+ï¼‰</td>
<td align="left">true</td>
</tr>
</tbody></table>
<p><strong>é…ç½®è¯¦è§£ä¸å·¥ç¨‹å®è·µ</strong></p>
<ol>
<li>noImplicitAny</li>
</ol>
<p>é—®é¢˜ä»£ç ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ğŸš« å‚æ•°éšå¼ any</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// âœ… æ˜¾å¼å£°æ˜ç±»å‹</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>strictNullChecks</li>
</ol>
<p>é—®é¢˜ä»£ç ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« å¯èƒ½ä¸º null</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// âœ… å®‰å…¨æ£€æŸ¥</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"Hello"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>strictPropertyInitialization</li>
</ol>
<p>é—®é¢˜ä»£ç ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« æœªåˆå§‹åŒ–</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// âœ… æ˜ç¡®èµ‹å€¼æ–­è¨€</span>
  <span class="token comment">// æˆ–</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">public</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>useUnknownInCatchVariables</li>
</ol>
<p>é—®é¢˜ä»£ç ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span> 
<span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// any ç±»å‹</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« å¯èƒ½ä¸å­˜åœ¨</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token comment">/* ... */</span> <span class="token punctuation">&#125;</span> 
<span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// âœ… TS 4.4+</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token keyword">instanceof</span> <span class="token class-name">Error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å››ã€ä¸¥æ ¼æ¨¡å¼é…ç½®ç­–ç•¥</p>
<ol>
<li>æ¸è¿›å¯ç”¨ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noImplicitAny"</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// ä¸´æ—¶å…³é—­æœ€ä¸¥æ ¼çš„è§„åˆ™</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ–‡ä»¶çº§è¦†ç›–ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// @ts-nocheck  // ç¦ç”¨æ•´ä¸ªæ–‡ä»¶æ£€æŸ¥</span>
<span class="token comment">// @ts-ignore   // ç¦ç”¨ä¸‹ä¸€è¡Œæ£€æŸ¥</span>

<span class="token keyword">function</span> <span class="token function">legacyCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
  <span class="token comment">// @ts-expect-error // é¢„æœŸé”™è¯¯ï¼ˆTS 3.9+ï¼‰</span>
  <span class="token keyword">const</span> x<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token string">"string"</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç›®å½•å·®å¼‚åŒ–é…ç½®ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// æ ¹ç›®å½• tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"./tsconfig.base.json"</span><span class="token punctuation">,</span>
  <span class="token property">"references"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span> <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"./src"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token comment">// åº”ç”¨ä¸¥æ ¼æ¨¡å¼</span>
    <span class="token punctuation">&#123;</span> <span class="token property">"path"</span><span class="token operator">:</span> <span class="token string">"./legacy"</span> <span class="token punctuation">&#125;</span>      <span class="token comment">// éä¸¥æ ¼æ¨¡å¼</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// legacy/tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token string">"../tsconfig.base.json"</span><span class="token punctuation">,</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ€§èƒ½ä¸ä¸¥æ ¼æ¨¡å¼</strong></p>
<ol>
<li>ç¼–è¯‘é€Ÿåº¦å½±å“ï¼š</li>
</ol>
<table>
<thead>
<tr>
<th align="left">ä¸¥æ ¼é€‰é¡¹</th>
<th align="left">æ€§èƒ½å½±å“</th>
<th align="left">ç¼“è§£æªæ–½</th>
</tr>
</thead>
<tbody><tr>
<td align="left">strictNullChecks</td>
<td align="left">ä¸­</td>
<td align="left">é¡¹ç›®å¼•ç”¨éš”ç¦»ä¿®æ”¹èŒƒå›´</td>
</tr>
<tr>
<td align="left">noImplicitAny</td>
<td align="left">é«˜</td>
<td align="left">æ¸è¿›å¯ç”¨ + @ts-ignore ä¸´æ—¶æ–¹æ¡ˆ</td>
</tr>
<tr>
<td align="left">strictFunctionTypes</td>
<td align="left">ä½</td>
<td align="left">æ— éœ€ç‰¹åˆ«å¤„ç†</td>
</tr>
</tbody></table>
<ol start="2">
<li>å†…å­˜å ç”¨ä¼˜åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"incremental"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// å¢é‡ç¼–è¯‘</span>
    <span class="token property">"tsBuildInfoFile"</span><span class="token operator">:</span> <span class="token string">"./buildcache/.tsbuildinfo"</span> <span class="token comment">// ç¼“å­˜ä½ç½®</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¸¥æ ¼æ¨¡å¼é”™è¯¯å¤„ç†</strong></p>
<ol>
<li>å¸¸è§é”™è¯¯ç±»å‹ï¼š</li>
</ol>
<table>
<thead>
<tr>
<th align="left">é”™è¯¯ä»£ç </th>
<th align="left">å«ä¹‰</th>
<th align="left">è§£å†³æ–¹æ¡ˆ</th>
</tr>
</thead>
<tbody><tr>
<td align="left">TS7006</td>
<td align="left">å‚æ•°éšå¼ any</td>
<td align="left">æ·»åŠ ç±»å‹æ³¨è§£</td>
</tr>
<tr>
<td align="left">TS2532</td>
<td align="left">å¯¹è±¡å¯èƒ½ä¸º undefined</td>
<td align="left">æ·»åŠ ç©ºå€¼æ£€æŸ¥</td>
</tr>
<tr>
<td align="left">TS2564</td>
<td align="left">å±æ€§æœªåˆå§‹åŒ–</td>
<td align="left">æ„é€ å‡½æ•°åˆå§‹åŒ–æˆ–æ˜ç¡®èµ‹å€¼æ–­è¨€</td>
</tr>
<tr>
<td align="left">TS2345</td>
<td align="left">å‚æ•°ç±»å‹ä¸åŒ¹é…</td>
<td align="left">ä¿®æ­£å‚æ•°ç±»å‹æˆ–ä½¿ç”¨ç±»å‹æ–­è¨€</td>
</tr>
</tbody></table>
<ol start="2">
<li>é”™è¯¯è‡ªåŠ¨ä¿®å¤ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// .vscode/settings.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"typescript.tsserver.experimental.enableProjectDiagnostics"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"editor.codeActionsOnSave"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"source.fixAll.ts"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ä¼ä¸šçº§é…ç½®æ¨¡æ¿</strong></p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// tsconfig.strict.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noFallthroughCasesInSwitch"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noUnusedLocals"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noUnusedParameters"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noImplicitReturns"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"forceConsistentCasingInFileNames"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"skipLibCheck"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"incremental"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"composite"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-1-2-æ¨¡å—è§£æç­–ç•¥å®æˆ˜"><a href="#3-1-2-æ¨¡å—è§£æç­–ç•¥å®æˆ˜" class="headerlink" title="3.1.2 æ¨¡å—è§£æç­–ç•¥å®æˆ˜"></a>3.1.2 æ¨¡å—è§£æç­–ç•¥å®æˆ˜</h3><p><strong>æ¨¡å—è§£æç­–ç•¥æ¦‚è¿°</strong></p>
<p>TypeScript æ”¯æŒä¸¤ç§æ¨¡å—è§£æç­–ç•¥ï¼š</p>
<table>
<thead>
<tr>
<th align="left">ç­–ç•¥</th>
<th align="left">è§¦å‘æ¡ä»¶</th>
<th align="left">é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Classic</td>
<td align="left">â€œmoduleResolutionâ€: â€œClassicâ€</td>
<td align="left">TypeScript 1.6 å‰æ—§é¡¹ç›®</td>
</tr>
<tr>
<td align="left">Node</td>
<td align="left">â€œmoduleResolutionâ€: â€œNodeâ€</td>
<td align="left">ç°ä»£é¡¹ç›®ï¼ˆé»˜è®¤å€¼ï¼‰</td>
</tr>
<tr>
<td align="left">Node16&#x2F;NodeNext</td>
<td align="left">â€œmoduleResolutionâ€: â€œNode16â€</td>
<td align="left">Node.js 16+ å’Œ ESM é¡¹ç›®</td>
</tr>
</tbody></table>
<p><strong>Node è§£æç­–ç•¥è¯¦è§£</strong></p>
<p>è§£ææµç¨‹ï¼ˆimport { x } from â€˜moduleâ€™ï¼‰ï¼š</p>
<ol>
<li>æ£€æŸ¥å½“å‰ç›®å½•çš„ node_modules&#x2F;module.ts&#x2F;module.tsx&#x2F;module.d.ts</li>
<li>æ£€æŸ¥ node_modules&#x2F;module&#x2F;package.json çš„ types æˆ– main å­—æ®µ</li>
<li>æ£€æŸ¥ node_modules&#x2F;module&#x2F;index.ts&#x2F;index.d.ts</li>
<li>é€’å½’æ£€æŸ¥çˆ¶ç›®å½•çš„ node_modulesï¼ˆ..&#x2F;node_modules&#x2F;moduleï¼‰</li>
</ol>
<p>æ–‡ä»¶æ‰©å±•åè§£æé¡ºåºï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token punctuation">[</span>
  <span class="token string">".ts"</span><span class="token punctuation">,</span> <span class="token string">".tsx"</span><span class="token punctuation">,</span> <span class="token string">".d.ts"</span><span class="token punctuation">,</span>         <span class="token comment">// TypeScript æ–‡ä»¶</span>
  <span class="token string">".js"</span><span class="token punctuation">,</span> <span class="token string">".jsx"</span><span class="token punctuation">,</span> <span class="token string">".cjs"</span><span class="token punctuation">,</span> <span class="token string">".mjs"</span><span class="token punctuation">,</span>  <span class="token comment">// JavaScript æ–‡ä»¶</span>
  <span class="token string">".json"</span>                         <span class="token comment">// JSON æ–‡ä»¶</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Node16&#x2F;NodeNext ç­–ç•¥</strong></p>
<p>ESM ä¸“å±ç‰¹æ€§ï¼š</p>
<ol>
<li>æ”¯æŒ package.json çš„ exports å’Œ imports å­—æ®µ</li>
<li>ä¸¥æ ¼åŒºåˆ† .js (CommonJS) å’Œ .mjs (ESM) æ–‡ä»¶</li>
<li>æ”¯æŒ type: â€œmoduleâ€ å£°æ˜</li>
</ol>
<p>exports å­—æ®µä¼˜å…ˆçº§ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"."</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./dist/esm/index.js"</span><span class="token punctuation">,</span>   <span class="token comment">// ESM å…¥å£</span>
      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./dist/cjs/index.js"</span><span class="token punctuation">,</span>  <span class="token comment">// CommonJS å…¥å£</span>
      <span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"./types/index.d.ts"</span>      <span class="token comment">// ç±»å‹å£°æ˜</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"./feature"</span><span class="token operator">:</span> <span class="token string">"./dist/feature.js"</span>     <span class="token comment">// å­è·¯å¾„å¯¼å‡º</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å®æˆ˜é…ç½®ç¤ºä¾‹</strong></p>
<p>åŸºç¡€é…ç½®ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"ESNext"</span><span class="token punctuation">,</span>
    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"Node16"</span><span class="token punctuation">,</span>
    <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"./src"</span><span class="token punctuation">,</span>
    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"@components/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"components/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"@utils"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"utils/index"</span><span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¤šç¯å¢ƒé…ç½®ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"Node16"</span><span class="token punctuation">,</span>
    <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"config"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">"config/prod"</span><span class="token punctuation">,</span> <span class="token comment">// ç”Ÿäº§ç¯å¢ƒ</span>
        <span class="token string">"config/dev"</span>   <span class="token comment">// å¼€å‘ç¯å¢ƒ</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è·¯å¾„æ˜ å°„å®æˆ˜</strong></p>
<ol>
<li>åˆ«åé…ç½®ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"baseUrl"</span><span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"@app/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"shared/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"../shared/*"</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å¤šè·¯å¾„å›é€€ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"legacy-utils"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"src/utils/v2"</span><span class="token punctuation">,</span> <span class="token comment">// ä¼˜å…ˆä½¿ç”¨ v2</span>
      <span class="token string">"src/utils/v1"</span>  <span class="token comment">// å›é€€åˆ° v1</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>é€šé…ç¬¦æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"@assets/*"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"assets/*"</span><span class="token punctuation">,</span>
      <span class="token string">"public/images/*"</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜1ï¼šè·¯å¾„æ˜ å°„è¿è¡Œæ—¶å¤±æ•ˆ</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®‰è£…è¿è¡Œæ—¶è§£æå™¨</span>
<span class="token function">npm</span> <span class="token function">install</span> tsconfig-paths --save-dev

<span class="token comment"># Node.js å¯åŠ¨å‘½ä»¤</span>
<span class="token function">node</span> <span class="token parameter variable">-r</span> tsconfig-paths/register app.ts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜2ï¼šå¾ªç¯ä¾èµ–è§£æå¤±è´¥</p>
<p>é‡æ„æ–¹æ¡ˆï¼š</p>
<pre><code class="mermaid">graph LR
    A[ModuleA] --&gt;|import| B[ModuleB]
    B --&gt;|import| C[ModuleC]
    C --&gt;|import| A[ModuleA]
    
    subgraph é‡æ„å
    D[Common] --&gt; E[ModuleA]
    D[Common] --&gt; F[ModuleB]
    D[Common] --&gt; G[ModuleC]
    end</code></pre>

<p>é—®é¢˜3ï¼šåŠ¨æ€å¯¼å…¥ç±»å‹ä¸¢å¤±</p>
<p>ç±»å‹å®‰å…¨æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŠ¨æ€å¯¼å…¥ç±»å‹å°è£…</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">safeImport</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">module</span> <span class="token keyword">as</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">interface</span> <span class="token class-name">ChartModule</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> chart <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token generic-function"><span class="token function">safeImport</span><span class="token generic class-name"><span class="token operator">&lt;</span>ChartModule<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">"./chart"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
chart<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ„å»ºå·¥å…·é›†æˆ</strong></p>
<ol>
<li>Webpack é…ç½®ï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> TsconfigPathsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'tsconfig-paths-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TsconfigPathsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.tsx'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>Vite é…ç½®ï¼š</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// vite.config.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> defineConfig <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'vite'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> tsconfigPaths <span class="token keyword">from</span> <span class="token string">'vite-tsconfig-paths'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">tsconfigPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-1-3-å£°æ˜æ–‡ä»¶ç”Ÿæˆé…ç½®"><a href="#3-1-3-å£°æ˜æ–‡ä»¶ç”Ÿæˆé…ç½®" class="headerlink" title="3.1.3 å£°æ˜æ–‡ä»¶ç”Ÿæˆé…ç½®"></a>3.1.3 å£°æ˜æ–‡ä»¶ç”Ÿæˆé…ç½®</h3><h3 id="3-1-4-ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥"><a href="#3-1-4-ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥" class="headerlink" title="3.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥"></a>3.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥</h3><h2 id="3-2-å£°æ˜æ–‡ä»¶-d-ts"><a href="#3-2-å£°æ˜æ–‡ä»¶-d-ts" class="headerlink" title="3.2 å£°æ˜æ–‡ä»¶(.d.ts)"></a>3.2 å£°æ˜æ–‡ä»¶(.d.ts)</h2><h3 id="3-2-1-ç¬¬ä¸‰æ–¹åº“ç±»å‹æ‰©å±•æŠ€å·§"><a href="#3-2-1-ç¬¬ä¸‰æ–¹åº“ç±»å‹æ‰©å±•æŠ€å·§" class="headerlink" title="3.2.1 ç¬¬ä¸‰æ–¹åº“ç±»å‹æ‰©å±•æŠ€å·§"></a>3.2.1 ç¬¬ä¸‰æ–¹åº“ç±»å‹æ‰©å±•æŠ€å·§</h3><p><strong>å£°æ˜æ–‡ä»¶æ‰©å±•åŸºç¡€</strong></p>
<p>æ ¸å¿ƒæ–¹æ³•ï¼šä½¿ç”¨ declare module è¯­æ³•æ‰©å±•ç¬¬ä¸‰æ–¹åº“ç±»å‹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// global.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'ç¬¬ä¸‰æ–¹åº“å'</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// æ‰©å±•å†…å®¹</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§æ‰©å±•åœºæ™¯</strong></p>
<ol>
<li>æ·»åŠ ç¼ºå¤±ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'untyped-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">calculate</span><span class="token punctuation">(</span>a<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ‰©å±•ç°æœ‰æ¥å£ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">HTMLAttributes<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// æ·»åŠ è‡ªå®šä¹‰å±æ€§</span>
    customAttr<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token operator">&lt;</span>div customAttr<span class="token operator">=</span><span class="token string">"value"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// âœ… ç±»å‹å®‰å…¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>è¦†ç›–é”™è¯¯ç±»å‹ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'flawed-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// ä¿®æ­£é”™è¯¯è¿”å›ç±»å‹</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Data<span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// åŸå£°æ˜ä¸º any</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¨¡å—åˆå¹¶ç­–ç•¥</strong></p>
<ol>
<li>æ¥å£åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å£°æ˜</span>
<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  timeout<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'configurable-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    retries<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ å¯é€‰å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å‡½æ•°é‡è½½æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å‡½æ•°</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token comment">// æ‰©å±•é‡è½½</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'logger-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>data<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ å¯¹è±¡æ”¯æŒ</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å‘½åç©ºé—´åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å‘½åç©ºé—´</span>
<span class="token keyword">declare</span> <span class="token keyword">namespace</span> Analytics <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">track</span><span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•å‘½åç©ºé—´</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'analytics-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">namespace</span> Analytics <span class="token punctuation">&#123;</span>
    <span class="token keyword">function</span> <span class="token function">identify</span><span class="token punctuation">(</span>userId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ æ–°æ–¹æ³•</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç±»å‹æ‰©å±•æœ€ä½³å®è·µ</strong></p>
<ol>
<li>æ¨¡å—åŒ–æ‰©å±•æ–‡ä»¶ï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">src/
  types/
    extensions/
      react.d.ts      # Reactæ‰©å±•
      lodash.d.ts     # Lodashæ‰©å±•
      global.d.ts     # å…¨å±€æ‰©å±•
  tsconfig.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ¡ä»¶æ‰©å±•æ¨¡å¼ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ¹æ®ç¯å¢ƒå˜é‡æ‰©å±•</span>
<span class="token keyword">type</span> <span class="token class-name">Env</span> <span class="token operator">=</span> <span class="token string">'development'</span> <span class="token operator">|</span> <span class="token string">'production'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'configurable-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    debug<span class="token operator">?</span><span class="token operator">:</span> Env <span class="token keyword">extends</span> <span class="token string">'development'</span> <span class="token operator">?</span> <span class="token builtin">boolean</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç±»å‹å®‰å…¨å¢å¼ºï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ·»åŠ ä¸¥æ ¼ç±»å‹çº¦æŸ</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'flexible-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">parse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token comment">// æ³›å‹ç‰ˆæœ¬</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é«˜çº§æ‰©å±•æŠ€å·§</strong></p>
<ol>
<li>æ¨¡æ¿å­—é¢é‡ç±»å‹æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'router-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">type</span> <span class="token class-name">DynamicRoute<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">string</span><span class="token operator">></span></span> <span class="token operator">=</span> 
    <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Param<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>string<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">?</span> Param <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
  
  <span class="token keyword">interface</span> <span class="token class-name">Router</span> <span class="token punctuation">&#123;</span>
    <span class="token function">get</span><span class="token punctuation">(</span>route<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    params<span class="token operator">:</span> Record<span class="token operator">&lt;</span>DynamicRoute<span class="token operator">&lt;</span><span class="token keyword">keyof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>routes<span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>æ³›å‹çº¦æŸå¢å¼ºï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'storage-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Storage<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">any</span><span class="token operator">>></span></span> <span class="token punctuation">&#123;</span>
    <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token generic-function"><span class="token function">set</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>ç±»å‹è°“è¯æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'validator-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Validators</span> <span class="token punctuation">&#123;</span>
    <span class="token function-variable function">isEmail</span><span class="token operator">:</span> <span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token operator">=></span> input <span class="token keyword">is</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</strong></p>
<p>é—®é¢˜1ï¼šæ¨¡å—æ‰©å±•å†²çª</p>
<p>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹åº“</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'ui-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">ButtonProps</span> <span class="token punctuation">&#123;</span>
    variant<span class="token operator">:</span> <span class="token string">'primary'</span> <span class="token operator">|</span> <span class="token string">'secondary'</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•ï¼ˆé¿å…ç›´æ¥ä¿®æ”¹ï¼‰</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'ui-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">ButtonProps</span> <span class="token punctuation">&#123;</span>
    __extendedVariant<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'tertiary'</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨ç‰¹æ®Šå‰ç¼€</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜2ï¼šå…¨å±€æ±¡æŸ“</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå°è£…æ‰©å±•</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®‰å…¨æ‰©å±•æ–¹æ¡ˆ</span>
<span class="token keyword">type</span> <span class="token class-name">ExtendedLib</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'base-lib'</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token function-variable function">newMethod</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> lib <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'base-lib'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> ExtendedLib<span class="token punctuation">;</span>
lib<span class="token punctuation">.</span><span class="token function">newMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®‰å…¨è®¿é—®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é—®é¢˜3ï¼šç±»å‹è¦†ç›–ä¸¢å¤±</p>
<p>è§£å†³æ–¹æ¡ˆï¼šç‰ˆæœ¬åŒ–æ‰©å±•</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ ¹æ®åº“ç‰ˆæœ¬åŠ¨æ€æ‰©å±•</span>
<span class="token keyword">type</span> <span class="token class-name">LibVersion</span> <span class="token operator">=</span> <span class="token string">'1.x'</span> <span class="token operator">|</span> <span class="token string">'2.x'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">var</span> __libVersion<span class="token operator">:</span> LibVersion<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'versioned-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">[</span>__libVersion <span class="token keyword">extends</span> <span class="token string">'2.x'</span> <span class="token operator">?</span> <span class="token string">'newFeature'</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>React ç”Ÿæ€æ‰©å±•</strong></p>
<ol>
<li>ç»„ä»¶å±æ€§æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-table'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ColumnInstance<span class="token operator">&lt;</span><span class="token constant">D</span> <span class="token keyword">extends</span> object <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
    align<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'left'</span> <span class="token operator">|</span> <span class="token string">'center'</span> <span class="token operator">|</span> <span class="token string">'right'</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ å¯¹é½å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>Hooks è¿”å›å€¼æ‰©å±•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-query'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">QueryResult<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
    customMeta<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> timestamp<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ å…ƒæ•°æ®</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>Context ç±»å‹å¢å¼ºï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> ThemeContext <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'theme-provider'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'theme-provider'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Theme</span> <span class="token punctuation">&#123;</span>
    customColor<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// æ‰©å±•ä¸»é¢˜å¯¹è±¡</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ThemeContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
theme<span class="token punctuation">.</span>customColor<span class="token punctuation">;</span> <span class="token comment">// âœ… ç±»å‹å®‰å…¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ‰©å±•æµ‹è¯•ç­–ç•¥</strong></p>
<ol>
<li>ç±»å‹æµ‹è¯•ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// éªŒè¯æ‰©å±•æ˜¯å¦ç”Ÿæ•ˆ</span>
<span class="token keyword">type</span> <span class="token class-name">Test</span> <span class="token operator">=</span> Expect<span class="token operator">&lt;</span>
  <span class="token comment">// æ£€æŸ¥æ‰©å±•å±æ€§æ˜¯å¦å­˜åœ¨</span>
  <span class="token string">'customAttr'</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> React<span class="token punctuation">.</span>HTMLAttributes<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>è¿è¡Œæ—¶éªŒè¯ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ç¡®ä¿æ‰©å±•ä¸è¿è¡Œæ—¶å…¼å®¹</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'newMethod'</span> <span class="token keyword">in</span> lib<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  lib<span class="token punctuation">.</span><span class="token function">newMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Library extension not available'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹åŒ–å»ºè®®</strong></p>
<ol>
<li>æ‰©å±•æ–‡æ¡£åŒ–ï¼š</li>
</ol>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">##</span> UI åº“æ‰©å±•è¯´æ˜</span>

<span class="token title important"><span class="token punctuation">###</span> æ–°å¢å±æ€§</span>
<span class="token table"><span class="token table-header-row"><span class="token punctuation">|</span><span class="token table-header important"> å±æ€§å        </span><span class="token punctuation">|</span><span class="token table-header important"> ç±»å‹   </span><span class="token punctuation">|</span><span class="token table-header important"> è¯´æ˜               </span><span class="token punctuation">|</span>
</span><span class="token table-line"><span class="token punctuation">|</span><span class="token punctuation">---------------</span><span class="token punctuation">|</span><span class="token punctuation">--------</span><span class="token punctuation">|</span><span class="token punctuation">--------------------</span><span class="token punctuation">|</span>
</span><span class="token table-data-rows"><span class="token punctuation">|</span><span class="token table-data"> customAttr    </span><span class="token punctuation">|</span><span class="token table-data"> string </span><span class="token punctuation">|</span><span class="token table-data"> è‡ªå®šä¹‰HTMLå±æ€§     </span><span class="token punctuation">|</span>
<span class="token punctuation">|</span><span class="token table-data"> __extendedVariant </span><span class="token punctuation">|</span><span class="token table-data"> 'tertiary' </span><span class="token punctuation">|</span><span class="token table-data"> ç‰¹æ®ŠæŒ‰é’®ç±»å‹    </span><span class="token punctuation">|</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç‰ˆæœ¬ç®¡ç†ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token comment">// package.json</span>
<span class="token punctuation">&#123;</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"@types/custom-lib-extension"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"peerDependencies"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"target-lib"</span><span class="token operator">:</span> <span class="token string">"^2.0.0"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>æ‰©å±•å‘å¸ƒæµç¨‹ï¼š</li>
</ol>
<pre><code class="mermaid">graph LR
    A[åˆ›å»ºæ‰©å±•å£°æ˜] --&gt; B[æœ¬åœ°æµ‹è¯•éªŒè¯]
    B --&gt; C[å‘å¸ƒåˆ°å†…éƒ¨npm]
    C --&gt; D[é¡¹ç›®å®‰è£…ä½¿ç”¨]</code></pre>

<p><strong>æ‰©å±•å®‰å…¨æŒ‡å—</strong></p>
<ol>
<li>é¿å…å…¨å±€æ±¡æŸ“ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é”™è¯¯ï¼šå…¨å±€æ‰©å±•åŸºç¡€ç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
  <span class="token function">customMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ­£ç¡®ï¼šæ¨¡å—åŒ–æ‰©å±•</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'array-extension'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token function">safeCustomMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>é˜²å¾¡æ€§ç±»å‹æ£€æŸ¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å®‰å…¨æ‰©å±•å‡½æ•°</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'utils-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">parse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">string</span></span> <span class="token operator">?</span> Data <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å…¼å®¹æ€§å¤„ç†ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å¤„ç†ä¸åŒç‰ˆæœ¬çš„åº“</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'multi-version-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">CoreAPI</span> <span class="token punctuation">&#123;</span>
    <span class="token function">commonMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">V1API</span></span> <span class="token keyword">extends</span> <span class="token class-name">CoreAPI</span> <span class="token punctuation">&#123;</span>
    <span class="token function">v1Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">V2API</span></span> <span class="token keyword">extends</span> <span class="token class-name">CoreAPI</span> <span class="token punctuation">&#123;</span>
    <span class="token function">v2Method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">const</span> api<span class="token operator">:</span> <span class="token constant">V1API</span> <span class="token operator">|</span> <span class="token constant">V2API</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> api<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ‰©å±•å‚è€ƒè¡¨</strong></p>
<table>
<thead>
<tr>
<th align="left">æ‰©å±•ç±»å‹</th>
<th align="left">é€‚ç”¨åœºæ™¯</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æ¥å£å±æ€§æ‰©å±•</td>
<td align="left">æ·»åŠ æ–°å±æ€§&#x2F;æ–¹æ³•</td>
<td align="left"><code>interface &#123; newProp: type &#125;</code></td>
</tr>
<tr>
<td align="left">å‡½æ•°é‡è½½æ‰©å±•</td>
<td align="left">æ”¯æŒæ–°å‚æ•°ç±»å‹</td>
<td align="left"><code>function log(data: object)</code></td>
</tr>
<tr>
<td align="left">æ³›å‹çº¦æŸå¢å¼º</td>
<td align="left">å¢åŠ ç±»å‹å‚æ•°çº¦æŸ</td>
<td align="left"><code>Storage&lt;T extends object&gt;</code></td>
</tr>
<tr>
<td align="left">æ¡ä»¶ç±»å‹æ‰©å±•</td>
<td align="left">æ ¹æ®ç¯å¢ƒåŠ¨æ€æ‰©å±•</td>
<td align="left"><code>debug?: Env extends &#39;dev&#39;</code></td>
</tr>
<tr>
<td align="left">æ¨¡æ¿å­—é¢é‡æ‰©å±•</td>
<td align="left">è·¯ç”±å‚æ•°&#x2F;å›½é™…åŒ–é”®å</td>
<td align="left"><code>DynamicRoute&lt;path&gt;</code></td>
</tr>
<tr>
<td align="left">ç±»å‹è°“è¯æ‰©å±•</td>
<td align="left">è‡ªå®šä¹‰ç±»å‹å®ˆå«</td>
<td align="left"><code>isEmail(input): input is string</code></td>
</tr>
</tbody></table>
<h3 id="3-2-2-æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥"><a href="#3-2-2-æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥" class="headerlink" title="3.2.2 æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥"></a>3.2.2 æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥</h3><p><strong>å£°æ˜åˆå¹¶åŸºç¡€æ¦‚å¿µ</strong></p>
<p>æ ¸å¿ƒæœºåˆ¶ï¼šTypeScript å…è®¸å°†å¤šä¸ªåŒåçš„å£°æ˜åˆå¹¶ä¸ºå•ä¸€ç±»å‹å®šä¹‰</p>
<p>åˆå¹¶ç±»å‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">interface</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åˆå¹¶ç»“æœ</span>
<span class="token keyword">const</span> user<span class="token operator">:</span> User <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token string">"Alice"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">30</span>  <span class="token comment">// âœ… åˆå¹¶å±æ€§</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ¨¡å—å£°æ˜åˆå¹¶ç­–ç•¥</strong></p>
<ol>
<li>æ¥å£åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// module.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'my-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    timeout<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// user-extension.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'my-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    retries<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ æ–°å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// åˆå¹¶ç»“æœ</span>
<span class="token keyword">const</span> config<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'my-lib'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Config <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  timeout<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
  retries<span class="token operator">:</span> <span class="token number">3</span>  <span class="token comment">// âœ…</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>å‡½æ•°åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'utils'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'utils'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">parse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span> <span class="token comment">// æ³›å‹ç‰ˆæœ¬</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token generic-function"><span class="token function">parse</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'&#123;"id":"123"&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… ç±»å‹å®‰å…¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å‘½åç©ºé—´åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹å‘½åç©ºé—´</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'analytics'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">namespace</span> Tracking <span class="token punctuation">&#123;</span>
    <span class="token keyword">function</span> <span class="token function">pageview</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•å‘½åç©ºé—´</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'analytics'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">namespace</span> Tracking <span class="token punctuation">&#123;</span>
    <span class="token keyword">function</span> <span class="token function">event</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> data<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
Tracking<span class="token punctuation">.</span><span class="token function">event</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> button<span class="token operator">:</span> <span class="token string">"submit"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>åˆå¹¶ä¼˜å…ˆçº§è§„åˆ™</strong></p>
<table>
<thead>
<tr>
<th align="left">å£°æ˜ç±»å‹</th>
<th align="left">åˆå¹¶ä¼˜å…ˆçº§</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æ¥å£å±æ€§</td>
<td align="left">é¡ºåºæ— å…³ï¼ŒåŒåå±æ€§å¿…é¡»å…¼å®¹</td>
<td align="left"><code>interface A &#123; x: number &#125;</code><br><code>interface A &#123; x: string &#125;</code> â†’ é”™è¯¯</td>
</tr>
<tr>
<td align="left">å‡½æ•°é‡è½½</td>
<td align="left">åå£°æ˜ä¼˜å…ˆ</td>
<td align="left">æœ€åå£°æ˜çš„ç­¾åæœ€å…ˆåŒ¹é…</td>
</tr>
<tr>
<td align="left">å‘½åç©ºé—´</td>
<td align="left">æŒ‰å£°æ˜é¡ºåºåˆå¹¶</td>
<td align="left">åå£°æ˜çš„æˆå‘˜è¦†ç›–å…ˆå‰çš„</td>
</tr>
<tr>
<td align="left">ç±»ä¸æ¥å£</td>
<td align="left">æ¥å£å£°æ˜ä¼˜å…ˆ</td>
<td align="left">ç±»å®ç°å¿…é¡»æ»¡è¶³æ‰€æœ‰æ¥å£å£°æ˜</td>
</tr>
</tbody></table>
<p><strong>æ¨¡å—åˆå¹¶æœ€ä½³å®è·µ</strong></p>
<ol>
<li>åˆ†å±‚å£°æ˜ç»“æ„ï¼š</li>
</ol>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">types/
  â”œâ”€â”€ lib/
  â”‚   â”œâ”€â”€ base.d.ts      // åŸºç¡€å£°æ˜
  â”‚   â””â”€â”€ extensions/    // æ‰©å±•å£°æ˜
  â”‚       â”œâ”€â”€ v1.d.ts
  â”‚       â””â”€â”€ v2.d.ts
  â””â”€â”€ global.d.ts        // å…¨å±€åˆå¹¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>ç‰ˆæœ¬åŒ–åˆå¹¶ç­–ç•¥ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¡ä»¶åˆå¹¶</span>
<span class="token keyword">type</span> <span class="token class-name">LibVersion</span> <span class="token operator">=</span> <span class="token string">'v1'</span> <span class="token operator">|</span> <span class="token string">'v2'</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'versioned-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Api</span> <span class="token punctuation">&#123;</span>
    <span class="token function">commonMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'versioned-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Api</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">[</span>LibVersion <span class="token keyword">extends</span> <span class="token string">'v2'</span> <span class="token operator">?</span> <span class="token string">'newMethod'</span> <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li>å®‰å…¨è¦†ç›–æ¨¡å¼ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'sensitive-lib'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name">__OriginalConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// ä¿ç•™åŸå§‹å®šä¹‰</span>
    originalProp<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token keyword">extends</span> <span class="token class-name">__OriginalConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// å®‰å…¨æ‰©å±•</span>
    customProp<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>React ç»„ä»¶åˆå¹¶æ¡ˆä¾‹</strong></p>
<ol>
<li>ç»„ä»¶å±æ€§åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹ç»„ä»¶å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-ui'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ButtonProps</span> <span class="token punctuation">&#123;</span>
    variant<span class="token operator">:</span> <span class="token string">'primary'</span> <span class="token operator">|</span> <span class="token string">'secondary'</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span>props<span class="token operator">:</span> ButtonProps<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•å±æ€§</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-ui'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ButtonProps</span> <span class="token punctuation">&#123;</span>
    size<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'sm'</span> <span class="token operator">|</span> <span class="token string">'md'</span> <span class="token operator">|</span> <span class="token string">'lg'</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ æ–°å±æ€§</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token operator">&lt;</span>Button variant<span class="token operator">=</span><span class="token string">"primary"</span> size<span class="token operator">=</span><span class="token string">"md"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// âœ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>Hooks è¿”å›å€¼åˆå¹¶ï¼š</li>
</ol>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// åŸå§‹Hook</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-hooks'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">useData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> loading<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> data<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ‰©å±•è¿”å›å€¼</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'react-hooks'</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">useData</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> loading<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> data<span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span> error<span class="token operator">?</span><span class="token operator">:</span> Error <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>åˆå¹¶å†²çªè§£å†³æ–¹æ¡ˆ</strong></p>
<p>å†²çªç±»å‹ 1ï¼šå±æ€§ç±»å‹ä¸å…¼å®¹</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// å£°æ˜1</span>
<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  logLevel<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// å£°æ˜2</span>
<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  logLevel<span class="token operator">:</span> <span class="token string">'debug'</span> <span class="token operator">|</span> <span class="token string">'info'</span><span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç±»å‹å†²çª</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ–¹æ³•1ï¼šä½¿ç”¨è”åˆç±»å‹</span>
<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  logLevel<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token string">'debug'</span> <span class="token operator">|</span> <span class="token string">'info'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æ–¹æ³•2ï¼šç‰ˆæœ¬åŒ–å£°æ˜</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> __configVersion<span class="token operator">:</span> <span class="token string">'v1'</span> <span class="token operator">|</span> <span class="token string">'v2'</span><span class="token punctuation">;</span>
<span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
  logLevel<span class="token operator">:</span> __configVersion <span class="token keyword">extends</span> <span class="token string">'v2'</span> <span class="token operator">?</span> <span class="token string">'debug'</span> <span class="token operator">|</span> <span class="token string">'info'</span> <span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å†²çªç±»å‹ 2ï¼šå‡½æ•°é‡è½½æ­§ä¹‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> object<span class="token punctuation">;</span> <span class="token comment">// ğŸš« ç›¸åŒå‚æ•°ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ˜ç¡®é‡è½½é¡ºåº</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span>input<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> object<span class="token punctuation">;</span> <span class="token comment">// âœ… ä¸åŒå‚æ•°ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>å£°æ˜åˆå¹¶å‚è€ƒè¡¨</strong></p>
<table>
<thead>
<tr>
<th align="left">åˆå¹¶åœºæ™¯</th>
<th align="left">æ¨èç­–ç•¥</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">æ¥å£å±æ€§æ‰©å±•</td>
<td align="left">ç›´æ¥æ·»åŠ æ–°å±æ€§</td>
<td align="left"><code>interface &#123; newProp: type &#125;</code></td>
</tr>
<tr>
<td align="left">å‡½æ•°é‡è½½æ‰©å±•</td>
<td align="left">æ·»åŠ ä¸åŒå‚æ•°ç±»å‹çš„é‡è½½</td>
<td align="left"><code>function parse(data: object)</code></td>
</tr>
<tr>
<td align="left">æ³›å‹çº¦æŸå¢å¼º</td>
<td align="left">ä½¿ç”¨æ¡ä»¶ç±»å‹ç»§æ‰¿</td>
<td align="left"><code>Store&lt;T extends object&gt;</code></td>
</tr>
<tr>
<td align="left">è·¨æ¨¡å—ç±»å‹åˆå¹¶</td>
<td align="left">ä½¿ç”¨ç±»å‹æŸ¥è¯¢å’Œç»„åˆ</td>
<td align="left"><code>type Full = LibA.Type &amp; LibB.Type</code></td>
</tr>
<tr>
<td align="left">ç‰ˆæœ¬å·®å¼‚åŒ–åˆå¹¶</td>
<td align="left">æ¡ä»¶ç±»å‹ + ç¯å¢ƒå˜é‡</td>
<td align="left"><code>__version extends &#39;v2&#39; ? ...</code></td>
</tr>
<tr>
<td align="left">ç¬¬ä¸‰æ–¹åº“è¡¥ä¸</td>
<td align="left">æ¨¡å—å£°æ˜åˆå¹¶ + é˜²å¾¡æ€§æ£€æŸ¥</td>
<td align="left"><code>declare module &#39;lib&#39; &#123; ... &#125;</code></td>
</tr>
</tbody></table>
<h3 id="3-2-3-å…¨å±€å˜é‡ç±»å‹å®šä¹‰"><a href="#3-2-3-å…¨å±€å˜é‡ç±»å‹å®šä¹‰" class="headerlink" title="3.2.3 å…¨å±€å˜é‡ç±»å‹å®šä¹‰"></a>3.2.3 å…¨å±€å˜é‡ç±»å‹å®šä¹‰</h3><p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong></p>
<p>å…¨å±€å˜é‡ï¼šåœ¨æ¨¡å—ç³»ç»Ÿå¤–å¯ç›´æ¥è®¿é—®çš„å˜é‡ï¼ˆå¦‚ window å¯¹è±¡å±æ€§ã€CDN å¼•å…¥çš„åº“ï¼‰</p>
<p>å®šä¹‰ç›®æ ‡ï¼š</p>
<ul>
<li>ä¸ºéæ¨¡å—åŒ–è„šæœ¬æä¾›ç±»å‹æ”¯æŒ</li>
<li>æ‰©å±•å…¨å±€å‘½åç©ºé—´ï¼ˆå¦‚ windowã€globalï¼‰</li>
<li>é¿å… Cannot find name â€˜xxxâ€™ ç±»å‹é”™è¯¯</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong></p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// â­ åœºæ™¯1ï¼šå£°æ˜å…¨å±€å˜é‡ (å£°æ˜æ–‡ä»¶.d.ts)</span>
<span class="token keyword">declare</span> <span class="token keyword">const</span> <span class="token constant">VERSION</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>  <span class="token comment">// ç¼–è¯‘æ—¶æ³¨å…¥çš„ç‰ˆæœ¬å·</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">trackEvent</span><span class="token punctuation">(</span>eventName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>  <span class="token comment">// å…¨å±€åŸ‹ç‚¹å‡½æ•°</span>

<span class="token comment">// â­ åœºæ™¯2ï¼šæ‰©å±•å…¨å±€å¯¹è±¡ (å¦‚ Window æ¥å£)</span>
<span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">&#123;</span>
  _env<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token constant">API_HOST</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token constant">DEBUG_MODE</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token function-variable function">ga</span><span class="token operator">:</span> <span class="token punctuation">(</span>command<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>  <span class="token comment">// Google Analytics</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// â­ åœºæ™¯3ï¼šæ¨¡å—åŒ–ç¯å¢ƒä¸­çš„å…¨å±€å£°æ˜ (ä½¿ç”¨ declare global)</span>
<span class="token keyword">export</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">// ç¡®ä¿æ–‡ä»¶æ˜¯æ¨¡å—ç¯å¢ƒ</span>

<span class="token keyword">declare</span> global <span class="token punctuation">&#123;</span>
  <span class="token keyword">interface</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token function">findLast</span><span class="token punctuation">(</span><span class="token function-variable function">predicate</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>  <span class="token comment">// æ‰©å±•åŸç”ŸArray</span>
  <span class="token punctuation">&#125;</span>
  
  <span class="token keyword">namespace</span> NodeJS <span class="token punctuation">&#123;</span>
    <span class="token keyword">interface</span> <span class="token class-name">ProcessEnv</span> <span class="token punctuation">&#123;</span>
      <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token string">'development'</span> <span class="token operator">|</span> <span class="token string">'production'</span><span class="token punctuation">;</span>
      <span class="token constant">SSR_ENABLED</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹å®è·µä¸é™·é˜±</strong></p>
<table>
<thead>
<tr>
<th align="left">åœºæ™¯</th>
<th align="left">è§£å†³æ–¹æ¡ˆ</th>
<th align="left">æ³¨æ„äº‹é¡¹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CDN å¼•å…¥çš„åº“</td>
<td align="left"><code>declare const jQuery: any;</code></td>
<td align="left">ä¼˜å…ˆå®‰è£… @types åŒ…</td>
</tr>
<tr>
<td align="left">æ³¨å…¥çš„è¿è¡Œæ—¶å˜é‡</td>
<td align="left"><code>declare const __INITIAL_STATE__: AppState;</code></td>
<td align="left">éœ€ä¸æ„å»ºè„šæœ¬é…åˆæ³¨å…¥</td>
</tr>
<tr>
<td align="left">æ‰©å±•æµè§ˆå™¨åŸç”Ÿå¯¹è±¡</td>
<td align="left">é€šè¿‡ interface åˆå¹¶å£°æ˜</td>
<td align="left">é¿å…è¦†ç›–æ ‡å‡†ç±»å‹å®šä¹‰</td>
</tr>
<tr>
<td align="left">å¤šç¯å¢ƒå…¨å±€å˜é‡</td>
<td align="left">ä½¿ç”¨ .d.ts + æ¡ä»¶ç±»å‹</td>
<td align="left">åŒºåˆ† process.env å’Œ import.meta.env</td>
</tr>
</tbody></table>
<p>å…¸å‹é”™è¯¯æ¡ˆä¾‹ï¼š</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// âŒ é”™è¯¯ï¼šç›´æ¥è¦†ç›–Windowç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">Window</span> <span class="token operator">=</span> CustomWindow<span class="token punctuation">;</span>  

<span class="token comment">// âœ… æ­£ç¡®ï¼šé€šè¿‡æ¥å£åˆå¹¶</span>
<span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">&#123;</span>
  customProp<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¢è¯•çº§è€ƒç‚¹</strong></p>
<ul>
<li>ç±»å‹åˆå¹¶æœºåˆ¶ï¼šæ¥å£å£°æ˜åˆå¹¶ vs å‘½åç©ºé—´åˆå¹¶</li>
<li>æ¨¡å—åŒ–å½±å“ï¼š<ul>
<li>å…¨å±€å£°æ˜å¿…é¡»æ”¾åœ¨ .d.ts æ–‡ä»¶æˆ–ä½¿ç”¨ declare global</li>
<li>åŒ…å« import&#x2F;export çš„æ–‡ä»¶ä¼šè¢«è§†ä¸ºæ¨¡å—</li>
</ul>
</li>
<li>ç±»å‹å¯è§æ€§è§„åˆ™ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// types.d.ts</span>
<span class="token keyword">declare</span> <span class="token keyword">interface</span> <span class="token class-name">GlobalType</span> <span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span>  <span class="token comment">// å…¨å±€å¯è§</span>

<span class="token comment">// utils.ts</span>
<span class="token keyword">export</span> <span class="token keyword">declare</span> <span class="token keyword">interface</span> <span class="token class-name">LocalType</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>  <span class="token comment">// ä»…æ¨¡å—å†…å¯è§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ä¸ window as any çš„å–èˆï¼šä¼˜å…ˆå£°æ˜å…·ä½“ç±»å‹ä¿è¯å®‰å…¨</li>
</ul>
<h3 id="3-2-4-å¤æ‚ç±»å‹å£°æ˜æœ€ä½³å®è·µ"><a href="#3-2-4-å¤æ‚ç±»å‹å£°æ˜æœ€ä½³å®è·µ" class="headerlink" title="3.2.4 å¤æ‚ç±»å‹å£°æ˜æœ€ä½³å®è·µ"></a>3.2.4 å¤æ‚ç±»å‹å£°æ˜æœ€ä½³å®è·µ</h3><p><strong>æ ¸å¿ƒè®¾è®¡åŸåˆ™</strong></p>
<table>
<thead>
<tr>
<th align="left">åŸåˆ™</th>
<th align="left">è¯´æ˜</th>
<th align="left">åæ¨¡å¼æ¡ˆä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">ç²¾ç¡®æ€§</td>
<td align="left">ç±»å‹åº”ä¸¥æ ¼åŒ¹é…è¿è¡Œæ—¶è¡Œä¸º</td>
<td align="left">ç”¨ any ä»£æ›¿å…·ä½“ç»“æ„</td>
</tr>
<tr>
<td align="left">å¯è¯»æ€§</td>
<td align="left">é€šè¿‡ç±»å‹åˆ«ååˆ†å±‚æŠ½è±¡</td>
<td align="left">åµŒå¥—è¶…è¿‡ä¸‰å±‚çš„åŒ¿åç±»å‹</td>
</tr>
<tr>
<td align="left">å…¼å®¹æ€§</td>
<td align="left">è€ƒè™‘æ—§ç‰ˆ TypeScript çš„è§£æèƒ½åŠ›</td>
<td align="left">ä½¿ç”¨ TS 4.1+ ç‰¹æ€§ä½†æœªé™çº§</td>
</tr>
<tr>
<td align="left">å¯æ‰©å±•æ€§</td>
<td align="left">é¢„ç•™æ‰©å±•ç‚¹ï¼ˆå¦‚ç´¢å¼•ç­¾åï¼‰</td>
<td align="left">å®Œå…¨å°é—­çš„ç±»å‹å®šä¹‰</td>
</tr>
</tbody></table>
<p><strong>å¤æ‚ç±»å‹å£°æ˜æ¨¡å¼</strong></p>
<p>åœºæ™¯1ï¼šæ·±åº¦åµŒå¥—ç»“æ„ï¼ˆå¦‚ API å“åº”ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨æ¥å£åˆ†å±‚ + ç±»å‹åˆ«åç»„åˆ</span>
<span class="token keyword">interface</span> <span class="token class-name">UserProfile</span> <span class="token punctuation">&#123;</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  contacts<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    social<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¯é€‰åµŒå¥—</span>
      wechat<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
      alipay<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// æå–å…¬å…±ç»“æ„</span>
<span class="token keyword">type</span> <span class="token class-name">Pagination<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  current_page<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  data<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">fetchUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Pagination<span class="token operator">&lt;</span>UserProfile<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯2ï¼šåŠ¨æ€é”®åå¯¹è±¡ï¼ˆå¦‚å›½é™…åŒ–å­—å…¸ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¨¡æ¿å­—é¢é‡ç±»å‹ + ç´¢å¼•ç­¾å</span>
<span class="token keyword">type</span> <span class="token class-name">Locale</span> <span class="token operator">=</span> <span class="token string">'zh-CN'</span> <span class="token operator">|</span> <span class="token string">'en-US'</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">I18nKeys</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">button.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token string">'submit'</span> <span class="token operator">|</span> <span class="token string">'cancel'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">|</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">title.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token string">'home'</span> <span class="token operator">|</span> <span class="token string">'about'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">const</span> i18n<span class="token operator">:</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span>key <span class="token keyword">in</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Locale<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>I18nKeys<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚ "zh-CN/button.submit"</span>
<span class="token punctuation">&#125;</span> <span class="token operator">&amp;</span> <span class="token punctuation">&#123;</span>
  <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>Locale<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>I18nKeys<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vars<span class="token operator">?</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœºæ™¯3ï¼šå‡½æ•°é‡è½½ç±»å‹ï¼ˆå¦‚ SDK æ–¹æ³•ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// ä½¿ç”¨è”åˆç±»å‹ + æ¡ä»¶ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">SDKOptions</span> <span class="token operator">=</span> 
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> mode<span class="token operator">:</span> <span class="token string">'sync'</span><span class="token punctuation">;</span> timeout<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span>
  <span class="token operator">|</span> <span class="token punctuation">&#123;</span> mode<span class="token operator">:</span> <span class="token string">'async'</span><span class="token punctuation">;</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span>res<span class="token operator">:</span> Response<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">invokeAPI</span><span class="token punctuation">(</span>
  endpoint<span class="token operator">:</span> <span class="token string">'/user'</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> SDKOptions
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token operator">|</span> User<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è¿›é˜¶æŠ€å·§ä¸é™·é˜±è§„é¿</strong></p>
<p>æŠ€å·§1ï¼šç±»å‹é€’å½’æ·±åº¦æ§åˆ¶</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// âœ… å®‰å…¨é€’å½’ï¼šé™åˆ¶æ·±åº¦</span>
<span class="token keyword">type</span> <span class="token class-name">MaxDepth<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">D</span> <span class="token keyword">extends</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">></span></span> <span class="token operator">=</span> 
  <span class="token constant">D</span> <span class="token keyword">extends</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token builtin">never</span> <span class="token operator">:</span> 
  <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">?</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> MaxDepth<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Subtract<span class="token operator">&lt;</span><span class="token constant">D</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">>></span>
  <span class="token punctuation">&#125;</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// âŒ å±é™©ï¼šæ— é™é€’å½’</span>
<span class="token keyword">type</span> <span class="token class-name">InfiniteRecursion<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  value<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
  children<span class="token operator">:</span> InfiniteRecursion<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// å¯èƒ½å¼•å‘ç±»å‹å®ä¾‹åŒ–è¿‡æ·±é”™è¯¯</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æŠ€å·§2ï¼šé˜²å¾¡æ€§ç±»å‹è®¾è®¡</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// é˜²èŒƒä¸å®Œæ•´æ•°æ®</span>
<span class="token keyword">type</span> <span class="token class-name">SafeAccess<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">?</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token operator">?</span><span class="token operator">:</span> SafeAccess<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span> <span class="token comment">// ç§»é™¤å¯é€‰ä¿®é¥°ç¬¦</span>
<span class="token punctuation">&#125;</span> <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨ never é˜»æ–­éæ³•è·¯å¾„</span>
<span class="token keyword">type</span> <span class="token class-name">ValidateRoute<span class="token operator">&lt;</span>Path<span class="token operator">></span></span> <span class="token operator">=</span> 
  Path <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/user/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token keyword">infer</span> Id<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
    <span class="token operator">?</span> Id <span class="token keyword">extends</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>number<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span> 
      <span class="token operator">?</span> Path 
      <span class="token operator">:</span> <span class="token builtin">never</span> 
    <span class="token operator">:</span> <span class="token builtin">never</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å·¥ç¨‹åŒ–å®è·µ</strong></p>
<p>ç­–ç•¥1ï¼šç±»å‹æµ‹è¯•ï¼ˆä½¿ç”¨ tsd ç­‰å·¥å…·ï¼‰</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æµ‹è¯•ç±»å‹æ˜¯å¦ç¬¦åˆé¢„æœŸ</span>
<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> expectType <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">'tsd'</span><span class="token punctuation">;</span>

<span class="token generic-function"><span class="token function">expectType</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">&#123;</span> id<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token function">fetchUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç­–ç•¥2ï¼šå£°æ˜æ–‡ä»¶ç»„ç»‡è§„èŒƒ</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">types/
â”œâ”€â”€ global.d.ts         # å…¨å±€å£°æ˜
â”œâ”€â”€ libs/               # ç¬¬ä¸‰æ–¹åº“æ‰©å±•
â”‚   â””â”€â”€ vue-extend.d.ts
â”œâ”€â”€ modules/            # ä¸šåŠ¡æ¨¡å—
â”‚   â””â”€â”€ user-api.d.ts
â””â”€â”€ utils/              # å·¥å…·ç±»å‹
    â””â”€â”€ pagination.d.ts<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç­–ç•¥3ï¼šç‰ˆæœ¬å…¼å®¹å¤„ç†</p>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// æ¡ä»¶ç¼–è¯‘æ”¯æŒå¤šç‰ˆæœ¬</span>
<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"some-lib"</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Config</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// @ts-ignore-next-line å…¼å®¹æ—§ç‰ˆæœ¬ç±»å‹ç¼ºå¤±</span>
    newFeature<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> 
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>é¢è¯•çº§è€ƒç‚¹</strong></p>
<ul>
<li>ç±»å‹å®ä¾‹åŒ–æ·±åº¦é™åˆ¶ï¼šé»˜è®¤ 50 å±‚ï¼ˆé€šè¿‡ tsc â€“typeDepth è°ƒæ•´ï¼‰</li>
<li>å£°æ˜åˆå¹¶ä¼˜å…ˆçº§ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">&#123;</span> x<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span>
<span class="token keyword">interface</span> <span class="token class-name"><span class="token constant">A</span></span> <span class="token punctuation">&#123;</span> x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span>  <span class="token comment">// âŒ åç»­å£°æ˜å¿…é¡»å…¼å®¹å‰åºå£°æ˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>ç±»å‹æ€§èƒ½ä¼˜åŒ–ï¼š</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token comment">// âœ… é«˜æ•ˆï¼šä½¿ç”¨æ˜ å°„ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">ReadonlyDeep<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token keyword">readonly</span> <span class="token punctuation">[</span><span class="token constant">K</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">:</span> ReadonlyDeep<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">&#125;</span>

<span class="token comment">// âŒ ä½æ•ˆï¼šé€’å½’æ¡ä»¶ç±»å‹</span>
<span class="token keyword">type</span> <span class="token class-name">SlowType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">object</span> <span class="token operator">?</span> SlowType<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">:</span> <span class="token constant">T</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>d.ts ä¸ ts æ–‡ä»¶å·®å¼‚ï¼š.d.ts ä¸åŒ…å«å®ç°ï¼Œä»…ç±»å‹å£°æ˜</li>
<li>å®æˆ˜æ¡ˆä¾‹ï¼šä¸º WebSocket æ¶ˆæ¯åè®®å£°æ˜ç±»å‹å®‰å…¨è§£æå™¨</li>
</ul>
<pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">MessageProtocol</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  login<span class="token operator">:</span> <span class="token punctuation">&#123;</span> username<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> password<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  joinRoom<span class="token operator">:</span> <span class="token punctuation">&#123;</span> roomId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> timestamp<span class="token operator">:</span> Date <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token comment">// ä½¿ç”¨æ¨¡æ¿ç±»å‹è‡ªåŠ¨ç”Ÿæˆäº‹ä»¶åçº¦æŸ</span>
  <span class="token punctuation">[</span><span class="token constant">E</span> <span class="token keyword">in</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">sys/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token string">'alert'</span> <span class="token operator">|</span> <span class="token string">'error'</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> code<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">handleMessage</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token keyword">keyof</span> MessageProtocol<span class="token operator">></span></span></span><span class="token punctuation">(</span>
  type<span class="token operator">:</span> <span class="token constant">K</span><span class="token punctuation">,</span>
  <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>payload<span class="token operator">:</span> MessageProtocol<span class="token punctuation">[</span><span class="token constant">K</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="3-3-ä»£ç è´¨é‡ä¿éšœ"><a href="#3-3-ä»£ç è´¨é‡ä¿éšœ" class="headerlink" title="3.3 ä»£ç è´¨é‡ä¿éšœ"></a>3.3 ä»£ç è´¨é‡ä¿éšœ</h2><h3 id="3-3-1-ESLint-ç±»å‹è§„åˆ™é…ç½®"><a href="#3-3-1-ESLint-ç±»å‹è§„åˆ™é…ç½®" class="headerlink" title="3.3.1 ESLint ç±»å‹è§„åˆ™é…ç½®"></a>3.3.1 ESLint ç±»å‹è§„åˆ™é…ç½®</h3><h3 id="3-3-2-å•å…ƒæµ‹è¯•ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ"><a href="#3-3-2-å•å…ƒæµ‹è¯•ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ" class="headerlink" title="3.3.2 å•å…ƒæµ‹è¯•ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ"></a>3.3.2 å•å…ƒæµ‹è¯•ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ</h3><h3 id="3-3-3-è‡ªå®šä¹‰ç±»å‹è§„åˆ™å¼€å‘"><a href="#3-3-3-è‡ªå®šä¹‰ç±»å‹è§„åˆ™å¼€å‘" class="headerlink" title="3.3.3 è‡ªå®šä¹‰ç±»å‹è§„åˆ™å¼€å‘"></a>3.3.3 è‡ªå®šä¹‰ç±»å‹è§„åˆ™å¼€å‘</h3><h3 id="3-3-4-CI-CD-ä¸­çš„ç±»å‹æ£€æŸ¥"><a href="#3-3-4-CI-CD-ä¸­çš„ç±»å‹æ£€æŸ¥" class="headerlink" title="3.3.4 CI&#x2F;CD ä¸­çš„ç±»å‹æ£€æŸ¥"></a>3.3.4 CI&#x2F;CD ä¸­çš„ç±»å‹æ£€æŸ¥</h3><h2 id="3-4-æ„å»ºä¼˜åŒ–"><a href="#3-4-æ„å»ºä¼˜åŒ–" class="headerlink" title="3.4 æ„å»ºä¼˜åŒ–"></a>3.4 æ„å»ºä¼˜åŒ–</h2><h3 id="3-4-1-Webpack-æ„å»ºç¼“å­˜é…ç½®"><a href="#3-4-1-Webpack-æ„å»ºç¼“å­˜é…ç½®" class="headerlink" title="3.4.1 Webpack æ„å»ºç¼“å­˜é…ç½®"></a>3.4.1 Webpack æ„å»ºç¼“å­˜é…ç½®</h3><h3 id="3-4-2-Babel-ä¸-tsc-ç¼–è¯‘å¯¹æ¯”"><a href="#3-4-2-Babel-ä¸-tsc-ç¼–è¯‘å¯¹æ¯”" class="headerlink" title="3.4.2 Babel ä¸ tsc ç¼–è¯‘å¯¹æ¯”"></a>3.4.2 Babel ä¸ tsc ç¼–è¯‘å¯¹æ¯”</h3><h3 id="3-4-3-å¢é‡ç¼–è¯‘åŸç†ä¸å®è·µ"><a href="#3-4-3-å¢é‡ç¼–è¯‘åŸç†ä¸å®è·µ" class="headerlink" title="3.4.3 å¢é‡ç¼–è¯‘åŸç†ä¸å®è·µ"></a>3.4.3 å¢é‡ç¼–è¯‘åŸç†ä¸å®è·µ</h3><h3 id="3-4-4-Monorepo-ç±»å‹ç®¡ç†ç­–ç•¥"><a href="#3-4-4-Monorepo-ç±»å‹ç®¡ç†ç­–ç•¥" class="headerlink" title="3.4.4 Monorepo ç±»å‹ç®¡ç†ç­–ç•¥"></a>3.4.4 Monorepo ç±»å‹ç®¡ç†ç­–ç•¥</h3><h1 id="å››ã€æ¡†æ¶é›†æˆå®è·µ"><a href="#å››ã€æ¡†æ¶é›†æˆå®è·µ" class="headerlink" title="å››ã€æ¡†æ¶é›†æˆå®è·µ"></a>å››ã€æ¡†æ¶é›†æˆå®è·µ</h1><h2 id="4-1-React-ç”Ÿæ€é›†æˆ"><a href="#4-1-React-ç”Ÿæ€é›†æˆ" class="headerlink" title="4.1 React ç”Ÿæ€é›†æˆ"></a>4.1 React ç”Ÿæ€é›†æˆ</h2><h3 id="4-1-1-ç»„ä»¶-Props-é«˜çº§ç±»å‹è®¾è®¡"><a href="#4-1-1-ç»„ä»¶-Props-é«˜çº§ç±»å‹è®¾è®¡" class="headerlink" title="4.1.1 ç»„ä»¶ Props é«˜çº§ç±»å‹è®¾è®¡"></a>4.1.1 ç»„ä»¶ Props é«˜çº§ç±»å‹è®¾è®¡</h3><h3 id="4-1-2-Hooks-æ³›å‹ç±»å‹å®šä¹‰"><a href="#4-1-2-Hooks-æ³›å‹ç±»å‹å®šä¹‰" class="headerlink" title="4.1.2 Hooks æ³›å‹ç±»å‹å®šä¹‰"></a>4.1.2 Hooks æ³›å‹ç±»å‹å®šä¹‰</h3><h3 id="4-1-3-Redux-Toolkit-ç±»å‹å®‰å…¨"><a href="#4-1-3-Redux-Toolkit-ç±»å‹å®‰å…¨" class="headerlink" title="4.1.3 Redux Toolkit ç±»å‹å®‰å…¨"></a>4.1.3 Redux Toolkit ç±»å‹å®‰å…¨</h3><h3 id="4-1-4-React-Router-ç±»å‹å®ˆå«"><a href="#4-1-4-React-Router-ç±»å‹å®ˆå«" class="headerlink" title="4.1.4 React Router ç±»å‹å®ˆå«"></a>4.1.4 React Router ç±»å‹å®ˆå«</h3><h2 id="4-2-Vue-3-ç±»å‹ç³»ç»Ÿ"><a href="#4-2-Vue-3-ç±»å‹ç³»ç»Ÿ" class="headerlink" title="4.2 Vue 3 ç±»å‹ç³»ç»Ÿ"></a>4.2 Vue 3 ç±»å‹ç³»ç»Ÿ</h2><h3 id="4-2-1-Composition-API-ç±»å‹æ¨å¯¼"><a href="#4-2-1-Composition-API-ç±»å‹æ¨å¯¼" class="headerlink" title="4.2.1 Composition API ç±»å‹æ¨å¯¼"></a>4.2.1 Composition API ç±»å‹æ¨å¯¼</h3><h3 id="4-2-2-ç»„ä»¶æ³›å‹-Props-å®ç°"><a href="#4-2-2-ç»„ä»¶æ³›å‹-Props-å®ç°" class="headerlink" title="4.2.2 ç»„ä»¶æ³›å‹ Props å®ç°"></a>4.2.2 ç»„ä»¶æ³›å‹ Props å®ç°</h3><h3 id="4-2-3-Pinia-çŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨"><a href="#4-2-3-Pinia-çŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨" class="headerlink" title="4.2.3 Pinia çŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨"></a>4.2.3 Pinia çŠ¶æ€ç®¡ç†ç±»å‹å®‰å…¨</h3><h3 id="4-2-4-Volar-ç±»å‹å¢å¼ºå®è·µ"><a href="#4-2-4-Volar-ç±»å‹å¢å¼ºå®è·µ" class="headerlink" title="4.2.4 Volar ç±»å‹å¢å¼ºå®è·µ"></a>4.2.4 Volar ç±»å‹å¢å¼ºå®è·µ</h3><h2 id="4-3-Node-js-åç«¯å¼€å‘"><a href="#4-3-Node-js-åç«¯å¼€å‘" class="headerlink" title="4.3 Node.js åç«¯å¼€å‘"></a>4.3 Node.js åç«¯å¼€å‘</h2><h3 id="4-3-1-Express-Koa-ä¸­é—´ä»¶ç±»å‹"><a href="#4-3-1-Express-Koa-ä¸­é—´ä»¶ç±»å‹" class="headerlink" title="4.3.1 Express&#x2F;Koa ä¸­é—´ä»¶ç±»å‹"></a>4.3.1 Express&#x2F;Koa ä¸­é—´ä»¶ç±»å‹</h3><h3 id="4-3-2-ORM-æ¡†æ¶ç±»å‹å®‰å…¨æŸ¥è¯¢"><a href="#4-3-2-ORM-æ¡†æ¶ç±»å‹å®‰å…¨æŸ¥è¯¢" class="headerlink" title="4.3.2 ORM æ¡†æ¶ç±»å‹å®‰å…¨æŸ¥è¯¢"></a>4.3.2 ORM æ¡†æ¶ç±»å‹å®‰å…¨æŸ¥è¯¢</h3><h3 id="4-3-3-RPC-é€šä¿¡ç±»å‹å¥‘çº¦"><a href="#4-3-3-RPC-é€šä¿¡ç±»å‹å¥‘çº¦" class="headerlink" title="4.3.3 RPC é€šä¿¡ç±»å‹å¥‘çº¦"></a>4.3.3 RPC é€šä¿¡ç±»å‹å¥‘çº¦</h3><h3 id="4-3-4-åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ä¿éšœ"><a href="#4-3-4-åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ä¿éšœ" class="headerlink" title="4.3.4 åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ä¿éšœ"></a>4.3.4 åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ä¿éšœ</h3><h1 id="äº”ã€æ€§èƒ½ä¼˜åŒ–"><a href="#äº”ã€æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="äº”ã€æ€§èƒ½ä¼˜åŒ–"></a>äº”ã€æ€§èƒ½ä¼˜åŒ–</h1><h2 id="5-1-ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–"><a href="#5-1-ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="5.1 ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–"></a>5.1 ç¼–è¯‘æ€§èƒ½ä¼˜åŒ–</h2><h3 id="5-1-1-é¡¹ç›®å¼•ç”¨-Project-References"><a href="#5-1-1-é¡¹ç›®å¼•ç”¨-Project-References" class="headerlink" title="5.1.1 é¡¹ç›®å¼•ç”¨(Project References)"></a>5.1.1 é¡¹ç›®å¼•ç”¨(Project References)</h3><h3 id="5-1-2-å¢é‡ç¼–è¯‘åŸç†å‰–æ"><a href="#5-1-2-å¢é‡ç¼–è¯‘åŸç†å‰–æ" class="headerlink" title="5.1.2 å¢é‡ç¼–è¯‘åŸç†å‰–æ"></a>5.1.2 å¢é‡ç¼–è¯‘åŸç†å‰–æ</h3><h3 id="5-1-3-åˆ†å¸ƒå¼ç¼–è¯‘æ–¹æ¡ˆ"><a href="#5-1-3-åˆ†å¸ƒå¼ç¼–è¯‘æ–¹æ¡ˆ" class="headerlink" title="5.1.3 åˆ†å¸ƒå¼ç¼–è¯‘æ–¹æ¡ˆ"></a>5.1.3 åˆ†å¸ƒå¼ç¼–è¯‘æ–¹æ¡ˆ</h3><h3 id="5-1-4-ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥"><a href="#5-1-4-ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥" class="headerlink" title="5.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥"></a>5.1.4 ç¼–è¯‘å™¨ç¼“å­˜ç­–ç•¥</h3><h2 id="5-2-ç±»å‹æ€§èƒ½ä¼˜åŒ–"><a href="#5-2-ç±»å‹æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="5.2 ç±»å‹æ€§èƒ½ä¼˜åŒ–"></a>5.2 ç±»å‹æ€§èƒ½ä¼˜åŒ–</h2><h3 id="5-2-1-é¿å…è¿‡åº¦ç±»å‹å®ä¾‹åŒ–"><a href="#5-2-1-é¿å…è¿‡åº¦ç±»å‹å®ä¾‹åŒ–" class="headerlink" title="5.2.1 é¿å…è¿‡åº¦ç±»å‹å®ä¾‹åŒ–"></a>5.2.1 é¿å…è¿‡åº¦ç±»å‹å®ä¾‹åŒ–</h3><h3 id="5-2-2-æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§"><a href="#5-2-2-æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§" class="headerlink" title="5.2.2 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§"></a>5.2.2 æ¡ä»¶ç±»å‹çŸ­è·¯æŠ€å·§</h3><h3 id="5-2-3-ç±»å‹ç¼“å­˜ç­–ç•¥å®ç°"><a href="#5-2-3-ç±»å‹ç¼“å­˜ç­–ç•¥å®ç°" class="headerlink" title="5.2.3 ç±»å‹ç¼“å­˜ç­–ç•¥å®ç°"></a>5.2.3 ç±»å‹ç¼“å­˜ç­–ç•¥å®ç°</h3><h3 id="5-2-4-ç±»å‹å¤æ‚åº¦åˆ†æ"><a href="#5-2-4-ç±»å‹å¤æ‚åº¦åˆ†æ" class="headerlink" title="5.2.4 ç±»å‹å¤æ‚åº¦åˆ†æ"></a>5.2.4 ç±»å‹å¤æ‚åº¦åˆ†æ</h3><h2 id="5-3-äº§ç‰©ä¼˜åŒ–"><a href="#5-3-äº§ç‰©ä¼˜åŒ–" class="headerlink" title="5.3 äº§ç‰©ä¼˜åŒ–"></a>5.3 äº§ç‰©ä¼˜åŒ–</h2><h3 id="5-3-1-Tree-Shaking-åŸç†ä¸å®ç°"><a href="#5-3-1-Tree-Shaking-åŸç†ä¸å®ç°" class="headerlink" title="5.3.1 Tree Shaking åŸç†ä¸å®ç°"></a>5.3.1 Tree Shaking åŸç†ä¸å®ç°</h3><h3 id="5-3-2-ä»£ç åˆ†å‰²ç±»å‹ä¿éšœ"><a href="#5-3-2-ä»£ç åˆ†å‰²ç±»å‹ä¿éšœ" class="headerlink" title="5.3.2 ä»£ç åˆ†å‰²ç±»å‹ä¿éšœ"></a>5.3.2 ä»£ç åˆ†å‰²ç±»å‹ä¿éšœ</h3><h3 id="5-3-3-è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ"><a href="#5-3-3-è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ" class="headerlink" title="5.3.3 è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ"></a>5.3.3 è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥æ–¹æ¡ˆ</h3><h3 id="5-3-4-ç±»å‹æ“¦é™¤ä¸ä½“ç§¯æ§åˆ¶"><a href="#5-3-4-ç±»å‹æ“¦é™¤ä¸ä½“ç§¯æ§åˆ¶" class="headerlink" title="5.3.4 ç±»å‹æ“¦é™¤ä¸ä½“ç§¯æ§åˆ¶"></a>5.3.4 ç±»å‹æ“¦é™¤ä¸ä½“ç§¯æ§åˆ¶</h3><h1 id="å…­ã€ç»¼åˆèƒ½åŠ›"><a href="#å…­ã€ç»¼åˆèƒ½åŠ›" class="headerlink" title="å…­ã€ç»¼åˆèƒ½åŠ›"></a>å…­ã€ç»¼åˆèƒ½åŠ›</h1><h2 id="6-1-è®¾è®¡æ¨¡å¼ç±»å‹å®ç°"><a href="#6-1-è®¾è®¡æ¨¡å¼ç±»å‹å®ç°" class="headerlink" title="6.1 è®¾è®¡æ¨¡å¼ç±»å‹å®ç°"></a>6.1 è®¾è®¡æ¨¡å¼ç±»å‹å®ç°</h2><h3 id="6-1-1-è£…é¥°å™¨å…ƒç¼–ç¨‹ç±»å‹å®‰å…¨"><a href="#6-1-1-è£…é¥°å™¨å…ƒç¼–ç¨‹ç±»å‹å®‰å…¨" class="headerlink" title="6.1.1 è£…é¥°å™¨å…ƒç¼–ç¨‹ç±»å‹å®‰å…¨"></a>6.1.1 è£…é¥°å™¨å…ƒç¼–ç¨‹ç±»å‹å®‰å…¨</h3><h3 id="6-1-2-ä¾èµ–æ³¨å…¥ç±»å‹æ¨å¯¼"><a href="#6-1-2-ä¾èµ–æ³¨å…¥ç±»å‹æ¨å¯¼" class="headerlink" title="6.1.2 ä¾èµ–æ³¨å…¥ç±»å‹æ¨å¯¼"></a>6.1.2 ä¾èµ–æ³¨å…¥ç±»å‹æ¨å¯¼</h3><h3 id="6-1-3-ç­–ç•¥æ¨¡å¼ç±»å‹æ˜ å°„"><a href="#6-1-3-ç­–ç•¥æ¨¡å¼ç±»å‹æ˜ å°„" class="headerlink" title="6.1.3 ç­–ç•¥æ¨¡å¼ç±»å‹æ˜ å°„"></a>6.1.3 ç­–ç•¥æ¨¡å¼ç±»å‹æ˜ å°„</h3><h3 id="6-1-4-çŠ¶æ€æœºç±»å‹å®ç°"><a href="#6-1-4-çŠ¶æ€æœºç±»å‹å®ç°" class="headerlink" title="6.1.4 çŠ¶æ€æœºç±»å‹å®ç°"></a>6.1.4 çŠ¶æ€æœºç±»å‹å®ç°</h3><h2 id="6-2-è°ƒè¯•ä¸é‡æ„"><a href="#6-2-è°ƒè¯•ä¸é‡æ„" class="headerlink" title="6.2 è°ƒè¯•ä¸é‡æ„"></a>6.2 è°ƒè¯•ä¸é‡æ„</h2><h3 id="6-2-1-å¤æ‚ç±»å‹é”™è¯¯è¿½è¸ªæŠ€å·§"><a href="#6-2-1-å¤æ‚ç±»å‹é”™è¯¯è¿½è¸ªæŠ€å·§" class="headerlink" title="6.2.1 å¤æ‚ç±»å‹é”™è¯¯è¿½è¸ªæŠ€å·§"></a>6.2.1 å¤æ‚ç±»å‹é”™è¯¯è¿½è¸ªæŠ€å·§</h3><h3 id="6-2-2-å£°æ˜æ–‡ä»¶è°ƒè¯•æ–¹æ³•è®º"><a href="#6-2-2-å£°æ˜æ–‡ä»¶è°ƒè¯•æ–¹æ³•è®º" class="headerlink" title="6.2.2 å£°æ˜æ–‡ä»¶è°ƒè¯•æ–¹æ³•è®º"></a>6.2.2 å£°æ˜æ–‡ä»¶è°ƒè¯•æ–¹æ³•è®º</h3><h3 id="6-2-3-é—ç•™ç³»ç»Ÿæ¸è¿›å¼è¿ç§»"><a href="#6-2-3-é—ç•™ç³»ç»Ÿæ¸è¿›å¼è¿ç§»" class="headerlink" title="6.2.3 é—ç•™ç³»ç»Ÿæ¸è¿›å¼è¿ç§»"></a>6.2.3 é—ç•™ç³»ç»Ÿæ¸è¿›å¼è¿ç§»</h3><h3 id="6-2-4-ç±»å‹å®‰å…¨çš„é‡æ„ä¿éšœ"><a href="#6-2-4-ç±»å‹å®‰å…¨çš„é‡æ„ä¿éšœ" class="headerlink" title="6.2.4 ç±»å‹å®‰å…¨çš„é‡æ„ä¿éšœ"></a>6.2.4 ç±»å‹å®‰å…¨çš„é‡æ„ä¿éšœ</h3><h2 id="6-3-å‰æ²¿æ¶æ„"><a href="#6-3-å‰æ²¿æ¶æ„" class="headerlink" title="6.3 å‰æ²¿æ¶æ„"></a>6.3 å‰æ²¿æ¶æ„</h2><h3 id="6-3-1-å¾®å‰ç«¯ç±»å‹é€šä¿¡æ–¹æ¡ˆ"><a href="#6-3-1-å¾®å‰ç«¯ç±»å‹é€šä¿¡æ–¹æ¡ˆ" class="headerlink" title="6.3.1 å¾®å‰ç«¯ç±»å‹é€šä¿¡æ–¹æ¡ˆ"></a>6.3.1 å¾®å‰ç«¯ç±»å‹é€šä¿¡æ–¹æ¡ˆ</h3><h3 id="6-3-2-Serverless-å‡½æ•°ç±»å‹å®‰å…¨"><a href="#6-3-2-Serverless-å‡½æ•°ç±»å‹å®‰å…¨" class="headerlink" title="6.3.2 Serverless å‡½æ•°ç±»å‹å®‰å…¨"></a>6.3.2 Serverless å‡½æ•°ç±»å‹å®‰å…¨</h3><h3 id="6-3-3-WebAssembly-ç±»å‹é›†æˆ"><a href="#6-3-3-WebAssembly-ç±»å‹é›†æˆ" class="headerlink" title="6.3.3 WebAssembly ç±»å‹é›†æˆ"></a>6.3.3 WebAssembly ç±»å‹é›†æˆ</h3><h3 id="6-3-4-Web-Workers-ç±»å‹é€šä¿¡"><a href="#6-3-4-Web-Workers-ç±»å‹é€šä¿¡" class="headerlink" title="6.3.4 Web Workers ç±»å‹é€šä¿¡"></a>6.3.4 Web Workers ç±»å‹é€šä¿¡</h3><h2 id="6-4-é¢è¯•ä¸“é¡¹"><a href="#6-4-é¢è¯•ä¸“é¡¹" class="headerlink" title="6.4 é¢è¯•ä¸“é¡¹"></a>6.4 é¢è¯•ä¸“é¡¹</h2><h3 id="6-4-1-ç±»å‹ä½“æ“è§£é¢˜æ€è·¯"><a href="#6-4-1-ç±»å‹ä½“æ“è§£é¢˜æ€è·¯" class="headerlink" title="6.4.1 ç±»å‹ä½“æ“è§£é¢˜æ€è·¯"></a>6.4.1 ç±»å‹ä½“æ“è§£é¢˜æ€è·¯</h3><h3 id="6-4-2-ç¼–è¯‘åŸç†ç›¸å…³é—®é¢˜"><a href="#6-4-2-ç¼–è¯‘åŸç†ç›¸å…³é—®é¢˜" class="headerlink" title="6.4.2 ç¼–è¯‘åŸç†ç›¸å…³é—®é¢˜"></a>6.4.2 ç¼–è¯‘åŸç†ç›¸å…³é—®é¢˜</h3><h3 id="6-4-3-æ¡†æ¶é›†æˆè®¾è®¡é—®é¢˜"><a href="#6-4-3-æ¡†æ¶é›†æˆè®¾è®¡é—®é¢˜" class="headerlink" title="6.4.3 æ¡†æ¶é›†æˆè®¾è®¡é—®é¢˜"></a>6.4.3 æ¡†æ¶é›†æˆè®¾è®¡é—®é¢˜</h3><h3 id="6-4-4-æ€§èƒ½ä¼˜åŒ–æŒ‡æ ‡åˆ†æ"><a href="#6-4-4-æ€§èƒ½ä¼˜åŒ–æŒ‡æ ‡åˆ†æ" class="headerlink" title="6.4.4 æ€§èƒ½ä¼˜åŒ–æŒ‡æ ‡åˆ†æ"></a>6.4.4 æ€§èƒ½ä¼˜åŒ–æŒ‡æ ‡åˆ†æ</h3>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>è¯·æˆ‘ä¸€æ¯å’–å•¡å§ï¼</div>
  <button>
    èµèµ
  </button>
  <div class="post-reward">

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/TypeScript/" rel="tag"><i class="fa fa-tag"></i> TypeScript</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/07/05/NodeJS%20Study%20Notes/" rel="prev" title="ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šNode.js">
                  <i class="fa fa-angle-left"></i> ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šNode.js
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/07/12/Docker%20Study%20Notes/" rel="next" title="ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šDocker">
                  ä¸“é¢˜çŸ¥è¯†å­¦ä¹ ï¼šDocker <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ariel</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">210k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">12:45</span>
  </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/tianfei92" class="github-corner" title="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" aria-label="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
